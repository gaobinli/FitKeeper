import{_ as le,N as se}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BvwCvuJW.js";import{aI as j,aJ as ue,d as I,at as E,m as V,au as H,n as K,q as J,a as Q,r as v,av as re,c as X,o as G,w as t,f as e,aK as ie,z as Y,az as Z,aA as ee,v as te,ax as ne,x as oe,B as z,g as O,t as $,h as l,$ as h,aL as ce,L as ae,E as pe,ar as me,b as de,aC as M,aD as _e}from"./index-BAq2SbaD.js";import{u as fe,a as ve}from"./table-DmjEK7tG.js";import{W as he}from"./WangEditor-BCwDbreK.js";import{_ as ge,a as ye,b as be,c as we}from"./round-refresh-DNCv4Ss6.js";import{_ as ke}from"./DataTable-D6rjIJFQ.js";import"./wangEditor-CAqzKAJM.js";import"./RadioGroup-BGb2VClf.js";import"./Pagination-PYMt0YJG.js";function xe(s){return j({url:ue("/announcement",s),method:"get"})}function Ne(s){return j({url:"/announcement",method:"post",data:s})}function Se(s,w){return j({url:"/announcement/"+s,method:"patch",data:w})}function L(s){return j({url:"/announcement/"+s,method:"delete"})}const De=I({name:"AnnouncementOperateModal",__name:"announcement-operate-modal",props:E({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:E(["submitted"],["update:visible"]),setup(s,{emit:w}){V();const r=s,D=w,f=H(s,"visible"),{formRef:k,validate:p,restoreValidation:q}=K(),{defaultRequiredRule:g}=J(),R=Q(()=>({add:"新增",edit:"编辑"})[r.operateType]),o=v(m());function m(){return{id:null,title:null,type:null,content:null}}const y={id:g,title:g,type:g,content:g};function d(){o.value=m(),r.operateType==="edit"&&r.rowData&&Object.assign(o.value,r.rowData),o.value.url&&(x.value=[{id:"1",name:"我是react.png",status:"finished",url:o.value.url}],o.value.url)}function b(){f.value=!1}async function T(){var _;if(await p(),o.value.id){const{error:u,data:N}=await Se(o.value.id,o.value);if(u)return}else{const{error:u,data:N}=await Ne(o.value);if(u)return}(_=window.$message)==null||_.success(h("common.updateSuccess")),b(),D("submitted")}re(f,()=>{f.value&&(d(),q())});const x=v([]),C=v([{label:"健身资讯",value:1},{label:"系统公告",value:2}]),B=_=>{o.value.content=_};return(_,u)=>{const N=te,S=ee,A=ne,a=Z,n=Y,i=ie,U=z,F=oe,c=ce;return G(),X(c,{show:f.value,"onUpdate:show":u[2]||(u[2]=P=>f.value=P),title:R.value,preset:"card",class:"w-800px"},{footer:t(()=>[e(F,{justify:"end",size:16},{default:t(()=>[e(U,{onClick:b},{default:t(()=>[O($(l(h)("common.cancel")),1)]),_:1}),e(U,{type:"primary",onClick:T},{default:t(()=>[O($(l(h)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(i,{class:"h-480px pr-20px"},{default:t(()=>[e(n,{ref_key:"formRef",ref:k,model:o.value,rules:y,"label-placement":"left","label-width":100},{default:t(()=>[e(a,{responsive:"screen","item-responsive":""},{default:t(()=>[e(S,{span:"24 m:24",label:"标题：",path:"title"},{default:t(()=>[e(N,{value:o.value.title,"onUpdate:value":u[0]||(u[0]=P=>o.value.title=P),placeholder:"请输入标题"},null,8,["value"])]),_:1}),e(S,{span:"24 m:24",label:"类型：",path:"type",class:"pr-24px"},{default:t(()=>[e(A,{value:o.value.type,"onUpdate:value":u[1]||(u[1]=P=>o.value.type=P),options:C.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(S,{span:"24 m:24",label:"内容：",path:"content"},{default:t(()=>[e(he,{contentHtml:o.value.content,onGetWangEditorValue:B},null,8,["contentHtml"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),qe=I({name:"AnnouncementSearch",__name:"announcement-search",props:{model:{required:!0},modelModifiers:{}},emits:E(["reset","search"],["update:model"]),setup(s,{emit:w}){V();const r=w,{formRef:D,validate:f,restoreValidation:k}=K(),p=H(s,"model"),q=Q(()=>{const{patternRules:m}=J();return{userEmail:m.email,userPhone:m.phone}});async function g(){await k(),r("reset")}async function R(){await f(),r("search")}const o=v([{label:"健身资讯",value:1},{label:"系统公告",value:2}]);return(m,y)=>{const d=te,b=ee,T=ne,x=be,C=z,B=we,_=oe,u=Z,N=Y,S=ye,A=ge,a=ae;return G(),X(a,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(A,{"default-expanded-names":["announcement-search"]},{default:t(()=>[e(S,{title:"搜索",name:"announcement-search"},{default:t(()=>[e(N,{ref_key:"formRef",ref:D,model:p.value,rules:q.value,"label-placement":"left","label-width":80},{default:t(()=>[e(u,{responsive:"screen","item-responsive":""},{default:t(()=>[e(b,{span:"24 s:12 m:6",label:"标题：",path:"qp_title_like",class:"pr-24px"},{default:t(()=>[e(d,{value:p.value.qp_title_like,"onUpdate:value":y[0]||(y[0]=n=>p.value.qp_title_like=n),placeholder:"请输入"},null,8,["value"])]),_:1}),e(b,{span:"24 s:12 m:6",label:"类型：",path:"qp_type_eq",class:"pr-24px"},{default:t(()=>[e(T,{value:p.value.qp_type_eq,"onUpdate:value":y[1]||(y[1]=n=>p.value.qp_type_eq=n),options:o.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(b,{span:"24 m:6",class:"pr-24px"},{default:t(()=>[e(_,{class:"w-full",justify:"start"},{default:t(()=>[e(C,{onClick:g},{icon:t(()=>[e(x,{class:"text-icon"})]),default:t(()=>[O(" "+$(l(h)("common.reset")),1)]),_:1}),e(C,{type:"primary",ghost:"",onClick:R},{icon:t(()=>[e(B,{class:"text-icon"})]),default:t(()=>[O(" "+$(l(h)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}}),Re={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function W(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!_e(s)}const $e=I({name:"announcement",__name:"index",setup(s){const w=pe(),{bool:r,setTrue:D}=me();V(),v(null);const{columns:f,columnChecks:k,data:p,loading:q,pagination:g,getData:R,getDataByPage:o,searchParams:m,resetSearchParams:y}=fe({apiFn:xe,apiParams:{currentPage:1,pageSize:10,qp_title_like:null,qp_type_eq:null,qp_content_like:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:"序号",align:"center"},{key:"title",title:"标题",align:"center"},{key:"type",title:"类型",align:"center",render:a=>{if(a.type){let n=[];for(const i of A.value)i.value===a.type&&n.push(i.label);return n.join("、")}return""}},{key:"modifyUser",title:"修改人",align:"center"},{key:"modifyTime",title:"修改时间",width:154,align:"center",render:a=>a.modifyTime?a.modifyTime.replace("T"," "):""},{key:"operate",title:h("common.operate"),align:"center",width:230,render:a=>{let n;return e("div",{class:"flex-center justify-center gap-8px"},[e(z,{type:"primary",ghost:!0,size:"small",onClick:()=>N(a)},W(n=h("common.edit"))?n:{default:()=>[n]}),e(se,{onPositiveClick:()=>_(a.id)},{default:()=>h("common.confirmDelete"),trigger:()=>{let i;return e(z,{type:"error",ghost:!0,size:"small"},W(i=h("common.delete"))?i:{default:()=>[i]})}})])}}]}),{checkedRowKeys:d,onBatchDeleted:b,onDeleted:T}=ve(p,R),x=v("add");function C(){x.value="add",D()}async function B(){const{error:a,data:n}=await L(d.value);console.log(d.value),b()}async function _(a){const{error:n,data:i}=await L(a);console.log(a),T()}const u=v(null);function N(a){x.value="edit",u.value={...a},D()}const S=v([]),A=v([{label:"健身资讯",value:1},{label:"系统公告",value:2}]);return(a,n)=>{const i=le,U=ke,F=ae;return G(),de("div",Re,[e(qe,{model:l(m),"onUpdate:model":n[0]||(n[0]=c=>M(m)?m.value=c:null),onReset:l(y),onSearch:l(o)},null,8,["model","onReset","onSearch"]),e(F,{title:"数据列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[e(i,{columns:l(k),"onUpdate:columns":n[1]||(n[1]=c=>M(k)?k.value=c:null),"disabled-delete":l(d).length===0,loading:l(q),onAdd:C,onDelete:B,onRefresh:l(R)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:t(()=>[e(U,{"checked-row-keys":l(d),"onUpdate:checkedRowKeys":n[2]||(n[2]=c=>M(d)?d.value=c:null),columns:l(f),data:l(p),size:"small","flex-height":!l(w).isMobile,"scroll-x":1088,loading:l(q),"row-key":c=>c.id,remote:"",pagination:l(g),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(De,{visible:l(r),"onUpdate:visible":n[3]||(n[3]=c=>M(r)?r.value=c:null),"operate-type":x.value,"row-data":u.value,"all-pages":S.value,onSubmitted:l(o)},null,8,["visible","operate-type","row-data","all-pages","onSubmitted"])]),_:1})])}}});export{$e as default};
