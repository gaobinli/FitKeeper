import{_ as le,N as se}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BvwCvuJW.js";import{aI as z,aJ as re,d as O,at as L,m as A,au as K,n as J,q as H,a as Q,r as T,av as ue,aM as ie,c as W,o as V,w as t,f as e,aK as ce,z as X,az as Y,aA as Z,v as ee,aN as de,x as te,B as P,g as q,t as $,h as l,$ as f,aL as pe,L as ae,E as me,ar as _e,b as fe,aC as I,aD as ve}from"./index-BAq2SbaD.js";import{u as he,a as ge}from"./table-DmjEK7tG.js";import{_ as ye}from"./Upload-DmXdhDTT.js";import{_ as be,a as we,b as ke,c as Ne}from"./round-refresh-DNCv4Ss6.js";import{_ as xe}from"./Image-Bgw24gBA.js";import{_ as Ce}from"./DataTable-D6rjIJFQ.js";import"./RadioGroup-BGb2VClf.js";import"./Pagination-PYMt0YJG.js";function De(s){return z({url:re("/carousel",s),method:"get"})}function Se(s){return z({url:"/carousel",method:"post",data:s})}function Te(s,b){return z({url:"/carousel/"+s,method:"patch",data:b})}function E(s){return z({url:"/carousel/"+s,method:"delete"})}const Re=O({name:"CarouselOperateModal",__name:"carousel-operate-modal",props:L({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:L(["submitted"],["update:visible"]),setup(s,{emit:b}){const v="http://localhost:9000/upload";A();const c=s,R=b,d=K(s,"visible"),{formRef:h,validate:D,restoreValidation:M}=J(),{defaultRequiredRule:_}=H(),g=Q(()=>({add:"新增",edit:"编辑"})[c.operateType]),a=T(S());function S(){return{id:null,name:null,url:null,sort:null}}const p={id:_,name:_,url:_,sort:_};function U(){a.value=S(),c.operateType==="edit"&&c.rowData&&Object.assign(a.value,c.rowData),m.value=[],console.log("handleInitModel - operateType:",c.operateType),console.log("handleInitModel - rowData:",c.rowData),console.log("handleInitModel - model.url:",a.value.url),a.value.url&&(m.value=[{id:"1",name:"我是react.png",status:"finished",url:a.value.url}],console.log("handleInitModel - fileList:",m.value))}function w(){d.value=!1}async function k(){var u;if(await D(),a.value.id){const{error:n,data:N}=await Te(a.value.id,a.value);if(n)return}else{const{error:n,data:N}=await Se(a.value);if(n)return}(u=window.$message)==null||u.success(f("common.updateSuccess")),w(),R("submitted")}ue(d,async()=>{d.value&&(await ie(),U(),M())});const m=T([]);function B(u){var n;u&&u.event&&((n=u.event)!=null&&n.target)&&u.event.target.response&&(a.value.url=JSON.parse(u.event.target.response).data),a.value.url&&(m.value=[{id:"1",name:"我是react.png",status:"finished",url:a.value.url}])}return(u,n)=>{const N=ee,x=Z,o=ye,r=de,y=Y,F=X,j=ce,i=P,ne=te,oe=pe;return V(),W(oe,{show:d.value,"onUpdate:show":n[3]||(n[3]=C=>d.value=C),title:g.value,preset:"card",class:"w-800px"},{footer:t(()=>[e(ne,{justify:"end",size:16},{default:t(()=>[e(i,{onClick:w},{default:t(()=>[q($(l(f)("common.cancel")),1)]),_:1}),e(i,{type:"primary",onClick:k},{default:t(()=>[q($(l(f)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(j,{class:"h-480px pr-20px"},{default:t(()=>[e(F,{ref_key:"formRef",ref:h,model:a.value,rules:p,"label-placement":"left","label-width":100},{default:t(()=>[e(y,{responsive:"screen","item-responsive":""},{default:t(()=>[e(x,{span:"24 m:24",label:"名称：",path:"name"},{default:t(()=>[e(N,{value:a.value.name,"onUpdate:value":n[0]||(n[0]=C=>a.value.name=C),placeholder:"请输入轮播图名称"},null,8,["value"])]),_:1}),e(x,{span:"24 m:24",label:"图片：",path:"url"},{default:t(()=>[e(o,{action:v,"file-list":m.value,"onUpdate:fileList":n[1]||(n[1]=C=>m.value=C),"list-type":"image-card",max:1,onChange:B},null,8,["file-list"])]),_:1}),e(x,{span:"24 m:24",label:"排序：",path:"sort"},{default:t(()=>[e(r,{value:a.value.sort,"onUpdate:value":n[2]||(n[2]=C=>a.value.sort=C),placeholder:"请输入排序"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),Me=O({name:"CarouselSearch",__name:"carousel-search",props:{model:{required:!0},modelModifiers:{}},emits:L(["reset","search"],["update:model"]),setup(s,{emit:b}){A();const v=b,{formRef:c,validate:R,restoreValidation:d}=J(),h=K(s,"model"),D=Q(()=>{const{patternRules:g}=H();return{userEmail:g.email,userPhone:g.phone}});async function M(){await d(),v("reset")}async function _(){await R(),v("search")}return(g,a)=>{const S=ee,p=Z,U=ke,w=P,k=Ne,m=te,B=Y,u=X,n=we,N=be,x=ae;return V(),W(x,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(N,{"default-expanded-names":["carousel-search"]},{default:t(()=>[e(n,{title:"搜索",name:"carousel-search"},{default:t(()=>[e(u,{ref_key:"formRef",ref:c,model:h.value,rules:D.value,"label-placement":"left","label-width":80},{default:t(()=>[e(B,{responsive:"screen","item-responsive":""},{default:t(()=>[e(p,{span:"24 s:12 m:6",label:"名称：",path:"qp_name_like",class:"pr-24px"},{default:t(()=>[e(S,{value:h.value.qp_name_like,"onUpdate:value":a[0]||(a[0]=o=>h.value.qp_name_like=o),placeholder:"请输入"},null,8,["value"])]),_:1}),e(p,{span:"24 m:6",class:"pr-24px"},{default:t(()=>[e(m,{class:"w-full",justify:"start"},{default:t(()=>[e(w,{onClick:M},{icon:t(()=>[e(U,{class:"text-icon"})]),default:t(()=>[q(" "+$(l(f)("common.reset")),1)]),_:1}),e(w,{type:"primary",ghost:"",onClick:_},{icon:t(()=>[e(k,{class:"text-icon"})]),default:t(()=>[q(" "+$(l(f)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}}),Ue={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function G(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!ve(s)}const Oe=O({name:"carousel",__name:"index",setup(s){const b=me(),{bool:v,setTrue:c}=_e();A(),T(null);const{columns:R,columnChecks:d,data:h,loading:D,pagination:M,getData:_,getDataByPage:g,searchParams:a,resetSearchParams:S}=he({apiFn:De,apiParams:{currentPage:1,pageSize:10,qp_name_like:null,qp_url_like:null,qp_sort_like:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:"序号",align:"center"},{key:"name",title:"轮播图名称",align:"center"},{key:"url",title:"图片",align:"center",render:o=>o.url===null?null:e(xe,{src:o.url,width:"100"},null)},{key:"sort",title:"排序",align:"center"},{key:"modifyUser",title:"修改人",align:"center"},{key:"modifyTime",title:"修改时间",width:154,align:"center",render:o=>o.modifyTime?o.modifyTime.replace("T"," "):""},{key:"operate",title:f("common.operate"),align:"center",width:230,render:o=>{let r;return e("div",{class:"flex-center justify-center gap-8px"},[e(P,{type:"primary",ghost:!0,size:"small",onClick:()=>N(o)},G(r=f("common.edit"))?r:{default:()=>[r]}),e(se,{onPositiveClick:()=>u(o.id)},{default:()=>f("common.confirmDelete"),trigger:()=>{let y;return e(P,{type:"error",ghost:!0,size:"small"},G(y=f("common.delete"))?y:{default:()=>[y]})}})])}}]}),{checkedRowKeys:p,onBatchDeleted:U,onDeleted:w}=ge(h,_),k=T("add");function m(){k.value="add",c()}async function B(){const{error:o,data:r}=await E(p.value);console.log(p.value),U()}async function u(o){const{error:r,data:y}=await E(o);console.log(o),w()}const n=T(null);function N(o){k.value="edit",n.value={...o},c()}const x=T([]);return(o,r)=>{const y=le,F=Ce,j=ae;return V(),fe("div",Ue,[e(Me,{model:l(a),"onUpdate:model":r[0]||(r[0]=i=>I(a)?a.value=i:null),onReset:l(S),onSearch:l(g)},null,8,["model","onReset","onSearch"]),e(j,{title:"数据列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[e(y,{columns:l(d),"onUpdate:columns":r[1]||(r[1]=i=>I(d)?d.value=i:null),"disabled-delete":l(p).length===0,loading:l(D),onAdd:m,onDelete:B,onRefresh:l(_)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:t(()=>[e(F,{"checked-row-keys":l(p),"onUpdate:checkedRowKeys":r[2]||(r[2]=i=>I(p)?p.value=i:null),columns:l(R),data:l(h),size:"small","flex-height":!l(b).isMobile,"scroll-x":1088,loading:l(D),"row-key":i=>i.id,remote:"",pagination:l(M),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Re,{visible:l(v),"onUpdate:visible":r[3]||(r[3]=i=>I(v)?v.value=i:null),"operate-type":k.value,"row-data":n.value,"all-pages":x.value,onSubmitted:l(g)},null,8,["visible","operate-type","row-data","all-pages","onSubmitted"])]),_:1})])}}});export{Oe as default};
