import{_ as re,N as ue}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BvwCvuJW.js";import{aI as F,aJ as ce,d as L,at as A,m as V,au as J,n as Q,q as W,a as X,r as h,av as ie,c as Y,o as G,w as a,f as e,aK as pe,z as Z,az as ee,aA as ae,ax as ne,aN as de,v as te,x as le,B as E,g as j,t as z,h as s,$ as q,aL as me,L as oe,E as _e,ar as fe,b as ve,aC as $,aD as he}from"./index-BAq2SbaD.js";import{f as K}from"./user-CToCrV-S.js";import{u as ge,a as be}from"./table-DmjEK7tG.js";import{_ as ye,a as ke,b as we,c as Re}from"./round-refresh-DNCv4Ss6.js";import{_ as xe}from"./DataTable-D6rjIJFQ.js";import"./RadioGroup-BGb2VClf.js";import"./Pagination-PYMt0YJG.js";function Ne(r){return F({url:ce("/rechargeRecord",r),method:"get"})}function qe(r){return F({url:"/rechargeRecord",method:"post",data:r})}function Se(r,S){return F({url:"/rechargeRecord/"+r,method:"patch",data:S})}function H(r){return F({url:"/rechargeRecord/"+r,method:"delete"})}const Ie=L({name:"RechargeRecordOperateModal",__name:"rechargeRecord-operate-modal",props:A({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:A(["submitted"],["update:visible"]),setup(r,{emit:S}){V();const p=r,T=S,k=J(r,"visible"),{formRef:I,validate:c,restoreValidation:D}=Q(),{defaultRequiredRule:w}=W(),U=X(()=>({add:"新增",edit:"编辑"})[p.operateType]),n=h(N());function N(){return{id:null,userId:null,remark:null,money:null,channel:null}}const C={id:w,userId:w,remark:w,money:w,channel:w};function g(){n.value=N(),p.operateType==="edit"&&p.rowData&&Object.assign(n.value,p.rowData),n.value.url&&(d.value=[{id:"1",name:"我是react.png",status:"finished",url:n.value.url}],n.value.url)}function R(){k.value=!1}async function u(){var b;if(await c(),n.value.id){const{error:o,data:_}=await Se(n.value.id,n.value);if(o)return}else{const{error:o,data:_}=await qe(n.value);if(o)return}(b=window.$message)==null||b.success(q("common.updateSuccess")),R(),T("submitted")}ie(k,()=>{k.value?(g(),D(),O()):d.value=[]});const d=h([]),m=h([]);async function O(){const{error:b,data:o}=await K();if(o){m.value=[];for(const _ of o)m.value.push({label:_.name,value:_.id})}}const B=h([{label:"微信",value:1},{label:"支付宝",value:2},{label:"银行卡",value:3}]);return(b,o)=>{const _=ne,y=ae,M=de,l=te,t=ee,i=Z,f=pe,P=E,v=le,se=me;return G(),Y(se,{show:k.value,"onUpdate:show":o[4]||(o[4]=x=>k.value=x),title:U.value,preset:"card",class:"w-800px"},{footer:a(()=>[e(v,{justify:"end",size:16},{default:a(()=>[e(P,{onClick:R},{default:a(()=>[j(z(s(q)("common.cancel")),1)]),_:1}),e(P,{type:"primary",onClick:u},{default:a(()=>[j(z(s(q)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(f,{class:"h-480px pr-20px"},{default:a(()=>[e(i,{ref_key:"formRef",ref:I,model:n.value,rules:C,"label-placement":"left","label-width":100},{default:a(()=>[e(t,{responsive:"screen","item-responsive":""},{default:a(()=>[e(y,{span:"24 m:24",label:"用户：",path:"userId",class:"pr-24px"},{default:a(()=>[e(_,{value:n.value.userId,"onUpdate:value":o[0]||(o[0]=x=>n.value.userId=x),options:m.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(y,{span:"24 m:24",label:"金额：",path:"money"},{default:a(()=>[e(M,{value:n.value.money,"onUpdate:value":o[1]||(o[1]=x=>n.value.money=x),placeholder:"请输入金额"},null,8,["value"])]),_:1}),e(y,{span:"24 m:24",label:"充值渠道：",path:"channel"},{default:a(()=>[e(_,{value:n.value.channel,"onUpdate:value":o[2]||(o[2]=x=>n.value.channel=x),options:B.value,placeholder:"请选择充值渠道"},null,8,["value","options"])]),_:1}),e(y,{span:"24 m:24",label:"备注：",path:"remark"},{default:a(()=>[e(l,{value:n.value.remark,"onUpdate:value":o[3]||(o[3]=x=>n.value.remark=x),placeholder:"请输入备注"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),De=L({name:"RechargeRecordSearch",__name:"rechargeRecord-search",props:{model:{required:!0},modelModifiers:{}},emits:A(["reset","search"],["update:model"]),setup(r,{emit:S}){V();const p=S,{formRef:T,validate:k,restoreValidation:I}=Q(),c=J(r,"model"),D=X(()=>{const{patternRules:R}=W();return{userEmail:R.email,userPhone:R.phone}});async function w(){await I(),p("reset")}async function U(){await k(),p("search")}const n=h([]);async function N(){const{error:R,data:u}=await K();if(u){n.value=[];for(const d of u)n.value.push({label:d.name,value:d.id})}}const C=h([{label:"微信",value:1},{label:"支付宝",value:2},{label:"银行卡",value:3}]);function g(){N()}return g(),(R,u)=>{const d=ne,m=ae,O=te,B=we,b=E,o=Re,_=le,y=ee,M=Z,l=ke,t=ye,i=oe;return G(),Y(i,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(t,{"default-expanded-names":["rechargeRecord-search"]},{default:a(()=>[e(l,{title:"搜索",name:"rechargeRecord-search"},{default:a(()=>[e(M,{ref_key:"formRef",ref:T,model:c.value,rules:D.value,"label-placement":"left","label-width":80},{default:a(()=>[e(y,{responsive:"screen","item-responsive":""},{default:a(()=>[e(m,{span:"24 s:12 m:6",label:"用户：",path:"qp_userId_eq",class:"pr-24px","label-width":100},{default:a(()=>[e(d,{value:c.value.qp_userId_eq,"onUpdate:value":u[0]||(u[0]=f=>c.value.qp_userId_eq=f),options:n.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(m,{span:"24 s:12 m:6",label:"备注：",path:"qp_remark_like",class:"pr-24px","label-width":100},{default:a(()=>[e(O,{value:c.value.qp_remark_like,"onUpdate:value":u[1]||(u[1]=f=>c.value.qp_remark_like=f),placeholder:"请输入"},null,8,["value"])]),_:1}),e(m,{span:"24 s:12 m:6",label:"金额：",path:"qp_money_like",class:"pr-24px","label-width":100},{default:a(()=>[e(O,{value:c.value.qp_money_like,"onUpdate:value":u[2]||(u[2]=f=>c.value.qp_money_like=f),placeholder:"请输入"},null,8,["value"])]),_:1}),e(m,{span:"24 s:12 m:6",label:"充值渠道：",path:"qp_channel_eq",class:"pr-24px","label-width":100},{default:a(()=>[e(d,{value:c.value.qp_channel_eq,"onUpdate:value":u[3]||(u[3]=f=>c.value.qp_channel_eq=f),options:C.value,placeholder:"请选择",clearable:""},null,8,["value","options"])]),_:1}),e(m,{span:"24 m:6",class:"pr-24px","label-width":100},{default:a(()=>[e(_,{class:"w-full",justify:"start"},{default:a(()=>[e(b,{onClick:w},{icon:a(()=>[e(B,{class:"text-icon"})]),default:a(()=>[j(" "+z(s(q)("common.reset")),1)]),_:1}),e(b,{type:"primary",ghost:"",onClick:U},{icon:a(()=>[e(o,{class:"text-icon"})]),default:a(()=>[j(" "+z(s(q)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}}),Ue={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function Oe(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!he(r)}const Fe=L({name:"rechargerecord",__name:"index",setup(r){const S=_e(),{bool:p,setTrue:T}=fe();V(),h(null);const{columns:k,columnChecks:I,data:c,loading:D,pagination:w,getData:U,getDataByPage:n,searchParams:N,resetSearchParams:C}=ge({apiFn:Ne,apiParams:{currentPage:1,pageSize:10,qp_userId_eq:null,qp_remark_like:null,qp_money_like:null,qp_channel_eq:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:"序号",align:"center"},{key:"userId",title:"用户",align:"center",render:l=>{if(l.userId){let t=[];for(const i of y.value)i.value===l.userId&&t.push(i.label);return t.join("、")}return""}},{key:"money",title:"金额",align:"center"},{key:"channel",title:"充值渠道",align:"center",render:l=>l.channel===null||l.channel===void 0?null:{1:"微信",2:"支付宝",3:"银行卡"}[l.channel]||l.channel},{key:"remark",title:"备注",align:"center"},{key:"modifyUser",title:"修改人",align:"center"},{key:"modifyTime",title:"修改时间",width:154,align:"center",render:l=>l.modifyTime?l.modifyTime.replace("T"," "):""},{key:"operate",title:q("common.operate"),align:"center",width:230,render:l=>e("div",{class:"flex-center justify-center gap-8px"},[e(ue,{onPositiveClick:()=>B(l.id)},{default:()=>q("common.confirmDelete"),trigger:()=>{let t;return e(E,{type:"error",ghost:!0,size:"small"},Oe(t=q("common.delete"))?t:{default:()=>[t]})}})])}]}),{checkedRowKeys:g,onBatchDeleted:R,onDeleted:u}=be(c,U),d=h("add");function m(){d.value="add",T()}async function O(){const{error:l,data:t}=await H(g.value);console.log(g.value),R()}async function B(l){const{error:t,data:i}=await H(l);console.log(l),u()}const b=h(null),o=h([]);function _(){M()}const y=h([]);async function M(){const{error:l,data:t}=await K();if(t){y.value=[];for(const i of t)y.value.push({label:i.name,value:i.id})}}return _(),(l,t)=>{const i=re,f=xe,P=oe;return G(),ve("div",Ue,[e(De,{model:s(N),"onUpdate:model":t[0]||(t[0]=v=>$(N)?N.value=v:null),onReset:s(C),onSearch:s(n)},null,8,["model","onReset","onSearch"]),e(P,{title:"数据列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[e(i,{columns:s(I),"onUpdate:columns":t[1]||(t[1]=v=>$(I)?I.value=v:null),"disabled-delete":s(g).length===0,loading:s(D),onAdd:m,onDelete:O,onRefresh:s(U)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:a(()=>[e(f,{"checked-row-keys":s(g),"onUpdate:checkedRowKeys":t[2]||(t[2]=v=>$(g)?g.value=v:null),columns:s(k),data:s(c),size:"small","flex-height":!s(S).isMobile,"scroll-x":1088,loading:s(D),"row-key":v=>v.id,remote:"",pagination:s(w),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Ie,{visible:s(p),"onUpdate:visible":t[3]||(t[3]=v=>$(p)?p.value=v:null),"operate-type":d.value,"row-data":b.value,"all-pages":o.value,onSubmitted:s(n)},null,8,["visible","operate-type","row-data","all-pages","onSubmitted"])]),_:1})])}}});export{Fe as default};
