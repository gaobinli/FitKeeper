import{_ as ae,N as oe}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BvwCvuJW.js";import{bA as r,d as Y,at as q,au as ne,n as se,q as le,a as T,$ as _,r as I,f as a,_ as J,av as G,c as re,o as Q,w as c,aK as ie,z as ue,az as ce,aA as de,v as pe,aN as _e,x as me,B as L,g as k,t as W,h as d,aL as ve,bB as ge,bC as fe,bD as he,E as ye,ar as be,b as Ee,aC as j,L as Pe,bE as X,bF as Re,O as H,aD as Ie}from"./index-BAq2SbaD.js";import{u as De,a as Te}from"./table-DmjEK7tG.js";import{_ as we}from"./DataTable-D6rjIJFQ.js";import"./RadioGroup-BGb2VClf.js";import"./Pagination-PYMt0YJG.js";function Oe(){return Object.keys(Object.assign({"/src/assets/svg-icon/activity.svg":()=>r(()=>import("./activity-B4XY664I.js"),[]),"/src/assets/svg-icon/alova.svg":()=>r(()=>import("./alova-BscF6wF0.js"),[]),"/src/assets/svg-icon/at-sign.svg":()=>r(()=>import("./at-sign-DvqQw7Qx.js"),[]),"/src/assets/svg-icon/avatar.svg":()=>r(()=>import("./avatar-CR4D3Wln.js"),[]),"/src/assets/svg-icon/banner.svg":()=>r(()=>import("./banner-c0_1_hKZ.js"),[]),"/src/assets/svg-icon/cast.svg":()=>r(()=>import("./cast-n3EmpXB4.js"),[]),"/src/assets/svg-icon/chrome.svg":()=>r(()=>import("./chrome-BM_Le6p_.js"),[]),"/src/assets/svg-icon/copy.svg":()=>r(()=>import("./copy-BsYpLlfM.js"),[]),"/src/assets/svg-icon/custom-icon.svg":()=>r(()=>import("./custom-icon-857Ak5pp.js"),[]),"/src/assets/svg-icon/empty-data.svg":()=>r(()=>import("./empty-data-CzgJ8JYF.js"),[]),"/src/assets/svg-icon/expectation.svg":()=>r(()=>import("./expectation-BuEJD7SN.js"),[]),"/src/assets/svg-icon/heart.svg":()=>r(()=>import("./heart-DOH2U7VV.js"),[]),"/src/assets/svg-icon/logo.svg":()=>r(()=>import("./logo-BeLY4cv9.js"),[]),"/src/assets/svg-icon/network-error.svg":()=>r(()=>import("./network-error-BW-nao7Y.js"),[]),"/src/assets/svg-icon/no-icon.svg":()=>r(()=>import("./no-icon-DXySFfyH.js"),[]),"/src/assets/svg-icon/no-permission.svg":()=>r(()=>import("./no-permission-CtR3LTfG.js"),[]),"/src/assets/svg-icon/not-found.svg":()=>r(()=>import("./not-found-wOawdi8Z.js"),[]),"/src/assets/svg-icon/service-error.svg":()=>r(()=>import("./service-error-D3TuQMX7.js"),[]),"/src/assets/svg-icon/visactor.svg":()=>r(()=>import("./visactor-DWgZNho9.js"),[]),"/src/assets/svg-icon/wind.svg":()=>r(()=>import("./wind-Dy5zdHKW.js"),[])})).map(l=>{var p;return((p=l.split("/").at(-1))==null?void 0:p.replace(".svg",""))||""}).filter(Boolean)}const A="layout.",V="view.",Z="$";function Ne(o){let m="",l="";const[p="",h=""]=(o==null?void 0:o.split(Z))||[];return m=Le(p),l=ke(h||p),{layout:m,page:l}}function Le(o){return o.startsWith(A)?o.replace(A,""):""}function ke(o){return o.startsWith(V)?o.replace(V,""):""}function Ae(o,m){const l=!!o,p=!!m;return l&&p?`${A}${o}${Z}${V}${m}`:l?`${A}${o}`:p?`${V}${m}`:""}function Ve(o){return`/${o.replace(/_/g,"/")}`}function xe(o){const[m,l=""]=o.split("/:");return{path:m,param:l}}const Ce=Y({name:"MenuOperateModal",__name:"menu-operate-modal",props:q({operateType:{},rowData:{},allPages:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:q(["submitted"],["update:visible"]),setup(o,{emit:m}){const l=o,p=m,h=ne(o,"visible"),{formRef:x,validate:D,restoreValidation:w}=se(),{defaultRequiredRule:b}=le(),C=T(()=>({add:_("page.manage.menu.addMenu"),addChild:_("page.manage.menu.addChildMenu"),edit:_("page.manage.menu.editMenu")})[l.operateType]),e=I(O());function O(){return{id:null,icon:"",name:"",code:"",sort:null,path:""}}const y={name:b,code:b,path:b,sort:b};T(()=>l.operateType==="edit"),Oe().map(s=>({label:()=>a("div",{class:"flex-y-center gap-16px"},[a(J,{localIcon:s,class:"text-icon"},null),a("span",null,[s])]),value:s})),T(()=>e.value.parentId===0),T(()=>e.value.menuType==="2"),T(()=>{const s=[...l.allPages];return e.value.routeName&&!s.includes(e.value.routeName)&&s.unshift(e.value.routeName),s.map(u=>({label:u,value:u}))});const M=I([]);async function P(){const{error:s,data:n}=await ge();if(!s){const u=n.map(t=>({label:t.roleName,value:t.roleCode}));M.value=[...u]}}function B(){if(e.value=O(),!!l.rowData){if(l.operateType==="addChild"){const{id:s}=l.rowData;Object.assign(e.value,{parentId:s})}if(l.operateType==="edit"){const{component:s,...n}=l.rowData,{layout:u,page:t}=Ne(s);console.log("rest.routePath====================>",n);const{path2:i,param:g}=xe(n.path);Object.assign(e.value,n,{layout:u,page:t,routePath:i,pathParam:g})}e.value.query||(e.value.query=[]),e.value.buttons||(e.value.buttons=[])}}function N(){h.value=!1}function $(){e.value.routeName?e.value.routePath=Ve(e.value.routeName):e.value.routePath=""}function R(){e.value.routeName?e.value.i18nKey=`route.${e.value.routeName}`:e.value.i18nKey=null}function S(){const{layout:s,page:n,pathParam:u,...t}=e.value,i=Ae(s,n);return t.component=i,t}async function U(){var n;await D();const s=S();if(console.log("============>params: ",s),s.id){const{error:u,data:t}=await fe(s.id,s);if(u)return}else{const{error:u,data:t}=await he(s);if(u)return}(n=window.$message)==null||n.success(_("common.updateSuccess")),N(),p("submitted")}return G(h,()=>{h.value&&(B(),w(),P())}),G(()=>e.value.routeName,()=>{$(),R()}),(s,n)=>{const u=pe,t=de,i=_e,g=ce,E=ue,F=ie,f=L,ee=me,te=ve;return Q(),re(te,{show:h.value,"onUpdate:show":n[5]||(n[5]=v=>h.value=v),title:C.value,preset:"card",class:"w-800px"},{footer:c(()=>[a(ee,{justify:"end",size:16},{default:c(()=>[a(f,{onClick:N},{default:c(()=>[k(W(d(_)("common.cancel")),1)]),_:1}),a(f,{type:"primary",onClick:U},{default:c(()=>[k(W(d(_)("common.confirm")),1)]),_:1})]),_:1})]),default:c(()=>[a(F,{class:"h-480px pr-20px"},{default:c(()=>[a(E,{ref_key:"formRef",ref:x,model:e.value,rules:y,"label-placement":"left","label-width":100},{default:c(()=>[a(g,{responsive:"screen","item-responsive":""},{default:c(()=>[a(t,{span:"24 m:24",label:"菜单名称",path:"name"},{default:c(()=>[a(u,{value:e.value.name,"onUpdate:value":n[0]||(n[0]=v=>e.value.name=v),placeholder:"请输入菜单名称"},null,8,["value"])]),_:1}),a(t,{span:"24 m:24",label:"路由名称",path:"code"},{default:c(()=>[a(u,{value:e.value.code,"onUpdate:value":n[1]||(n[1]=v=>e.value.code=v),placeholder:"请输入路由名称"},null,8,["value"])]),_:1}),a(t,{span:"24 m:24",label:"路由路径",path:"path"},{default:c(()=>[a(u,{value:e.value.path,"onUpdate:value":n[2]||(n[2]=v=>e.value.path=v),placeholder:"请输入路由路径"},null,8,["value"])]),_:1}),a(t,{span:"24 m:24",label:"图标",path:"icon"},{default:c(()=>[a(u,{value:e.value.icon,"onUpdate:value":n[3]||(n[3]=v=>e.value.icon=v),placeholder:"请输入图标"},null,8,["value"])]),_:1}),a(t,{span:"24 m:24",label:"排序",path:"sort"},{default:c(()=>[a(i,{value:e.value.sort,"onUpdate:value":n[4]||(n[4]=v=>e.value.sort=v),class:"w-full",placeholder:"请输入排序"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}});function z(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!Ie(o)}const je=Y({name:"manage_menu",__name:"index",setup(o){const m=ye(),{bool:l,setTrue:p}=be(),h=I(null),{columns:x,columnChecks:D,data:w,loading:b,pagination:C,getData:e,getDataByPage:O}=De({apiFn:Re,columns:()=>[{type:"selection",align:"center",width:48},{key:"id",title:_("page.manage.menu.id"),align:"center"},{key:"hasChildren",title:"菜单类型",align:"center",width:80,render:t=>t.hasChildren?a(H,{type:"default"},{default:()=>[k("目录")]}):a(H,{type:"primary"},{default:()=>[k("菜单")]})},{key:"name",title:"菜单名称",align:"center"},{key:"icon",title:_("page.manage.menu.icon"),align:"center",width:60,render:t=>(t.icon,a("div",{class:"flex-center"},[a(J,{icon:t.icon,localIcon:void 0,class:"text-icon"},null)]))},{key:"code",title:"路由名称",align:"center"},{key:"path",title:"路由路径",align:"center"},{key:"sort",title:"排序",align:"center"},{key:"operate",title:_("common.operate"),align:"center",width:230,render:t=>{let i,g;return a("div",{class:"flex-center justify-end gap-8px"},[t.menuType==="1"&&a(L,{type:"primary",ghost:!0,size:"small",onClick:()=>U(t)},z(i=_("page.manage.menu.addChildMenu"))?i:{default:()=>[i]}),a(L,{type:"primary",ghost:!0,size:"small",onClick:()=>S(t)},z(g=_("common.edit"))?g:{default:()=>[g]}),a(oe,{onPositiveClick:()=>$(t.id)},{default:()=>_("common.confirmDelete"),trigger:()=>{let E;return a(L,{type:"error",ghost:!0,size:"small"},z(E=_("common.delete"))?E:{default:()=>[E]})}})])}}]}),{checkedRowKeys:y,onBatchDeleted:K,onDeleted:M}=Te(w,e),P=I("add");function B(){P.value="add",p()}async function N(){const{error:t,data:i}=await X(y.value);console.log(y.value),K()}async function $(t){const{error:i,data:g}=await X(t);console.log(t),M()}const R=I(null);function S(t){P.value="edit",R.value={...t},console.log("editingData================>",R.value),p()}function U(t){P.value="addChild",R.value={...t},p()}const s=I([]);async function n(){}function u(){n()}return u(),(t,i)=>{const g=ae,E=we,F=Pe;return Q(),Ee("div",{ref_key:"wrapperRef",ref:h,class:"flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},[a(F,{title:d(_)("page.manage.menu.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":c(()=>[a(g,{columns:d(D),"onUpdate:columns":i[0]||(i[0]=f=>j(D)?D.value=f:null),"disabled-delete":d(y).length===0,loading:d(b),onAdd:B,onDelete:N,onRefresh:d(e)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:c(()=>[a(E,{"checked-row-keys":d(y),"onUpdate:checkedRowKeys":i[1]||(i[1]=f=>j(y)?y.value=f:null),columns:d(x),data:d(w),size:"small","flex-height":!d(m).isMobile,"scroll-x":1088,loading:d(b),"row-key":f=>f.id,remote:"",pagination:d(C),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),a(Ce,{visible:d(l),"onUpdate:visible":i[2]||(i[2]=f=>j(l)?l.value=f:null),"operate-type":P.value,"row-data":R.value,"all-pages":s.value,onSubmitted:d(O)},null,8,["visible","operate-type","row-data","all-pages","onSubmitted"])]),_:1},8,["title"])],512)}}});export{je as default};
