import{_ as me,N as _e}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BvwCvuJW.js";import{d as W,at as A,m as Y,au as Z,n as ee,q as ae,a as G,r as v,av as fe,c as le,o as V,w as t,f as e,aK as ve,z as te,az as ne,aA as oe,v as se,ax as he,x as ue,B as R,g as D,t as E,h as r,$ as b,aL as re,aO as be,L as ie,E as ge,ar as ye,b as L,aC as j,O as J,aD as we}from"./index-BAq2SbaD.js";import{_ as ke,f as xe,a as Ce,b as Q,c as Ne}from"./coach-BsqHLKrd.js";import{u as De,a as Se}from"./table-DmjEK7tG.js";import{W as qe}from"./WangEditor-BCwDbreK.js";import{_ as Pe}from"./Upload-DmXdhDTT.js";import{_ as Ue,a as Te,b as Re,c as Me}from"./round-refresh-DNCv4Ss6.js";import{_ as Be}from"./DataTable-D6rjIJFQ.js";import{_ as $e}from"./Image-Bgw24gBA.js";import"./Pagination-PYMt0YJG.js";import"./wangEditor-CAqzKAJM.js";import"./RadioGroup-BGb2VClf.js";const ze=W({name:"CoachOperateModal",__name:"coach-operate-modal",props:A({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:A(["submitted"],["update:visible"]),setup(h,{emit:M}){const g="http://localhost:9000/upload";Y();const d=h,B=M,p=Z(h,"visible"),{formRef:m,validate:S,restoreValidation:$}=ee(),{defaultRequiredRule:c,patternRules:y}=ae(),_=G(()=>({add:"新增",edit:"编辑"})[d.operateType]),x=G({get:()=>d.operateType==="edit"?a.value.newPassword:a.value.password,set:n=>{d.operateType==="edit"?a.value.newPassword=n:a.value.password=n}}),a=v(q());function q(){return{id:null,name:null,username:null,password:null,newPassword:null,phone:null,url:null,birthday:null,address:null,sex:null,enable:null,introduceContent:null}}const P={id:c,name:c,username:c,phone:[c,y.phone],sex:c,enable:c};function C(){a.value=q(),d.operateType==="edit"&&d.rowData&&(Object.assign(a.value,d.rowData),a.value.birthday&&typeof a.value.birthday=="string"&&(a.value.birthday=new Date(a.value.birthday).getTime())),a.value.url&&(w.value=[{id:"1",name:"我是react.png",status:"finished",url:a.value.url}],a.value.url)}function U(){p.value=!1}async function z(){var s;await S();const n={...a.value};if(n.birthday&&typeof n.birthday=="number"&&(n.birthday=be(n.birthday).format("YYYY-MM-DD HH:mm:ss")),a.value.id){n.newPassword?n.password=n.newPassword:delete n.password,delete n.newPassword;const{error:l,data:o}=await xe(a.value.id,n);if(l)return}else{delete n.newPassword;const{error:l,data:o}=await Ce(n);if(l)return}(s=window.$message)==null||s.success(b("common.updateSuccess")),U(),B("submitted")}fe(p,()=>{p.value?(C(),$()):w.value=[]});const w=v([]);function T(n){var s;console.log("======files======>",n),n&&n.event&&((s=n.event)!=null&&s.target)&&n.event.target.response&&(a.value.url=JSON.parse(n.event.target.response).data),a.value.url&&(w.value=[{id:"1",name:"我是react.png",status:"finished",url:a.value.url}])}const O=v([{label:"男",value:1},{label:"女",value:2}]),N=v([{label:"启用",value:!0},{label:"禁用",value:!1}]),f=n=>{a.value.introduceContent=n};return(n,s)=>{const l=se,o=oe,k=Pe,H=ke,F=he,I=ne,u=te,de=ve,K=R,pe=ue,ce=re;return V(),le(ce,{show:p.value,"onUpdate:show":s[8]||(s[8]=i=>p.value=i),title:_.value,preset:"card",class:"w-800px"},{footer:t(()=>[e(pe,{justify:"end",size:16},{default:t(()=>[e(K,{onClick:U},{default:t(()=>[D(E(r(b)("common.cancel")),1)]),_:1}),e(K,{type:"primary",onClick:z},{default:t(()=>[D(E(r(b)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(de,{class:"h-480px pr-20px"},{default:t(()=>[e(u,{ref_key:"formRef",ref:m,model:a.value,rules:P,"label-placement":"left","label-width":100},{default:t(()=>[e(I,{responsive:"screen","item-responsive":""},{default:t(()=>[e(o,{span:"24 m:24",label:"账号：",path:"username"},{default:t(()=>[e(l,{value:a.value.username,"onUpdate:value":s[0]||(s[0]=i=>a.value.username=i),placeholder:"请输入账号",disabled:n.operateType==="edit"},null,8,["value","disabled"])]),_:1}),e(o,{span:"24 m:24",label:"姓名：",path:"name"},{default:t(()=>[e(l,{value:a.value.name,"onUpdate:value":s[1]||(s[1]=i=>a.value.name=i),placeholder:"请输入姓名"},null,8,["value"])]),_:1}),e(o,{span:"24 m:24",label:"密码：",path:"password"},{default:t(()=>[e(l,{value:x.value,"onUpdate:value":s[2]||(s[2]=i=>x.value=i),placeholder:n.operateType==="edit"?"不修改密码请留空":"请输入密码"},null,8,["value","placeholder"])]),_:1}),e(o,{span:"24 m:24",label:"手机号：",path:"phone"},{default:t(()=>[e(l,{value:a.value.phone,"onUpdate:value":s[3]||(s[3]=i=>a.value.phone=i),placeholder:"请输入手机号"},null,8,["value"])]),_:1}),e(o,{span:"24 m:24",label:"宣传照：",path:"url"},{default:t(()=>[e(k,{action:g,"default-file-list":w.value,"list-type":"image-card",max:1,onChange:T},null,8,["default-file-list"])]),_:1}),e(o,{span:"24 m:24",label:"出生日期：",path:"birthday"},{default:t(()=>[e(H,{value:a.value.birthday,"onUpdate:value":s[4]||(s[4]=i=>a.value.birthday=i),type:"date",clearable:""},null,8,["value"])]),_:1}),e(o,{span:"24 m:24",label:"地址：",path:"address"},{default:t(()=>[e(l,{value:a.value.address,"onUpdate:value":s[5]||(s[5]=i=>a.value.address=i),placeholder:"请输入地址"},null,8,["value"])]),_:1}),e(o,{span:"24 m:24",label:"性别：",path:"sex"},{default:t(()=>[e(F,{value:a.value.sex,"onUpdate:value":s[6]||(s[6]=i=>a.value.sex=i),options:O.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(o,{span:"24 m:24",label:"状态：",path:"enable"},{default:t(()=>[e(F,{value:a.value.enable,"onUpdate:value":s[7]||(s[7]=i=>a.value.enable=i),options:N.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(o,{span:"24 m:24",label:"介绍：",path:"introduceContent"},{default:t(()=>[e(qe,{contentHtml:a.value.introduceContent,onGetWangEditorValue:f},null,8,["contentHtml"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),Oe=W({name:"CoachSearch",__name:"coach-search",props:{model:{required:!0},modelModifiers:{}},emits:A(["reset","search"],["update:model"]),setup(h,{emit:M}){Y();const g=M,{formRef:d,validate:B,restoreValidation:p}=ee(),m=Z(h,"model"),S=G(()=>{const{patternRules:y}=ae();return{userEmail:y.email,userPhone:y.phone}});async function $(){await p(),g("reset")}async function c(){await B(),g("search")}return(y,_)=>{const x=se,a=oe,q=Re,P=R,C=Me,U=ue,z=ne,w=te,T=Te,O=Ue,N=ie;return V(),le(N,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(O,{"default-expanded-names":["coach-search"]},{default:t(()=>[e(T,{title:"搜索",name:"coach-search"},{default:t(()=>[e(w,{ref_key:"formRef",ref:d,model:m.value,rules:S.value,"label-placement":"left","label-width":80},{default:t(()=>[e(z,{responsive:"screen","item-responsive":""},{default:t(()=>[e(a,{span:"24 s:12 m:6",label:"姓名：",path:"qp_name_like",class:"pr-24px","label-width":100},{default:t(()=>[e(x,{value:m.value.qp_name_like,"onUpdate:value":_[0]||(_[0]=f=>m.value.qp_name_like=f),placeholder:"请输入"},null,8,["value"])]),_:1}),e(a,{span:"24 s:12 m:6",label:"手机号：",path:"qp_phone_like",class:"pr-24px","label-width":100},{default:t(()=>[e(x,{value:m.value.qp_phone_like,"onUpdate:value":_[1]||(_[1]=f=>m.value.qp_phone_like=f),placeholder:"请输入"},null,8,["value"])]),_:1}),e(a,{span:"24 m:6",class:"pr-24px","label-width":100},{default:t(()=>[e(U,{class:"w-full",justify:"start"},{default:t(()=>[e(P,{onClick:$},{icon:t(()=>[e(q,{class:"text-icon"})]),default:t(()=>[D(" "+E(r(b)("common.reset")),1)]),_:1}),e(P,{type:"primary",ghost:"",onClick:c},{icon:t(()=>[e(C,{class:"text-icon"})]),default:t(()=>[D(" "+E(r(b)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}}),Ve={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},Ee=["innerHTML"],Fe={key:1,class:"text-center text-gray-500"};function X(h){return typeof h=="function"||Object.prototype.toString.call(h)==="[object Object]"&&!we(h)}const Ze=W({name:"coach",__name:"index",setup(h){const M=ge(),{bool:g,setTrue:d}=ye();Y(),v(null);const{columns:B,columnChecks:p,data:m,loading:S,pagination:$,getData:c,getDataByPage:y,searchParams:_,resetSearchParams:x}=De({apiFn:Ne,apiParams:{currentPage:1,pageSize:10,qp_name_like:null,qp_username_like:null,qp_password_like:null,qp_phone_like:null,qp_url_like:null,qp_birthday_like:null,qp_address_like:null,qp_sex_like:null,qp_enable_like:null,qp_introduceContent_like:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:"序号",align:"center"},{key:"name",title:"姓名",align:"center"},{key:"username",title:"账号",align:"center"},{key:"phone",title:"手机号",align:"center"},{key:"url",title:"宣传照",align:"center",render:l=>l.url===null?null:e($e,{src:l.url,width:"100"},null)},{key:"birthday",title:"出生日期",align:"center",render:l=>l.birthday===null?null:l.birthday.split(" ")[0]},{key:"address",title:"地址",align:"center"},{key:"sex",title:"性别",align:"center",render:l=>l.sex===null?null:e(J,{type:l.sex===1?"info":"warning"},{default:()=>[l.sex===1?"男":"女"]})},{key:"introduceContent",title:"介绍",align:"center",render:l=>l.introduceContent===null?e(R,{type:"primary",ghost:!0,size:"small",onClick:()=>n(l)},{default:()=>[D("查看")]}):e(R,{type:"primary",ghost:!0,size:"small",onClick:()=>n(l)},{default:()=>[D("查看")]})},{key:"enable",title:"是否启用",align:"center",render:l=>l.enable===null?null:e(J,{type:l.enable?"success":"error"},{default:()=>[l.enable?"启用":"禁用"]})},{key:"operate",title:b("common.operate"),align:"center",width:230,render:l=>{let o;return e("div",{class:"flex-center justify-center gap-8px"},[e(R,{type:"primary",ghost:!0,size:"small",onClick:()=>O(l)},X(o=b("common.edit"))?o:{default:()=>[o]}),e(_e,{onPositiveClick:()=>w(l.id)},{default:()=>b("common.confirmDelete"),trigger:()=>{let k;return e(R,{type:"error",ghost:!0,size:"small"},X(k=b("common.delete"))?k:{default:()=>[k]})}})])}}]}),{checkedRowKeys:a,onBatchDeleted:q,onDeleted:P}=Se(m,c),C=v("add");function U(){C.value="add",d()}async function z(){const{error:l,data:o}=await Q(a.value);console.log(a.value),q()}async function w(l){const{error:o,data:k}=await Q(l);console.log(l),P()}const T=v(null);function O(l){C.value="edit",T.value={...l},d()}const N=v(!1),f=v(null);function n(l){f.value={name:l.name,introduceContent:l.introduceContent},N.value=!0}const s=v([]);return(l,o)=>{const k=me,H=Be,F=re,I=ie;return V(),L("div",Ve,[e(Oe,{model:r(_),"onUpdate:model":o[0]||(o[0]=u=>j(_)?_.value=u:null),onReset:r(x),onSearch:r(y)},null,8,["model","onReset","onSearch"]),e(I,{title:"数据列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[e(k,{columns:r(p),"onUpdate:columns":o[1]||(o[1]=u=>j(p)?p.value=u:null),"disabled-delete":r(a).length===0,loading:r(S),onAdd:U,onDelete:z,onRefresh:r(c)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:t(()=>[e(H,{"checked-row-keys":r(a),"onUpdate:checkedRowKeys":o[2]||(o[2]=u=>j(a)?a.value=u:null),columns:r(B),data:r(m),size:"small","flex-height":!r(M).isMobile,"scroll-x":1088,loading:r(S),"row-key":u=>u.id,remote:"",pagination:r($),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(ze,{visible:r(g),"onUpdate:visible":o[3]||(o[3]=u=>j(g)?g.value=u:null),"operate-type":C.value,"row-data":T.value,"all-pages":s.value,onSubmitted:r(y)},null,8,["visible","operate-type","row-data","all-pages","onSubmitted"]),e(F,{show:N.value,"onUpdate:show":o[4]||(o[4]=u=>N.value=u),preset:"card",class:"w-800px"},{header:t(()=>{var u;return[D(E((u=f.value)==null?void 0:u.name)+" - 介绍 ",1)]}),default:t(()=>{var u;return[(u=f.value)!=null&&u.introduceContent?(V(),L("div",{key:0,innerHTML:f.value.introduceContent,class:"prose prose-sm max-w-none"},null,8,Ee)):(V(),L("div",Fe," 暂无介绍内容 "))]}),_:1},8,["show"])]),_:1})])}}});export{Ze as default};
