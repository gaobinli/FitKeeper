import{a as js,r as Vs,aE as Ee,aF as as,i as zs,av as rs,m as Rs,aG as ee,aH as Bs,$ as cs}from"./index-BAq2SbaD.js";const Re="undefined",Y=Promise,Ne=t=>Y.resolve(t),ke=t=>Y.reject(t),Lt=Object,Oe=RegExp,m=void 0,He=null,b=!0,y=!1,wt=(t,e,s)=>t.then(e,s),zt=(t,e)=>t.catch(e),bs=(t,e)=>t.finally(e),je=(t,e,s)=>JSON.stringify(t,e,s),Ws=t=>JSON.parse(t),le=(t,e=0)=>setTimeout(t,e),Te=t=>clearTimeout(t),pt=t=>Lt.keys(t),Gs=t=>Lt.values(t),at=(t,e)=>t.forEach(e),Z=(t,...e)=>t.push(...e),ct=(t,e)=>t.map(e),mt=(t,e)=>t.filter(e),Qs=t=>t.shift(),Pt=(t,e,s=0,...n)=>t.splice(e,s,...n),j=t=>t.length,ft=t=>Array.isArray(t),_t=(t,e)=>delete t[e],ue=t=>typeof t,se=(t,e)=>t.includes(e),Js=typeof window===Re&&(typeof process!==Re?typeof process.cwd=="function":typeof Deno!==Re),Gt="memory",At="restore",X=()=>{},ne=t=>t,N=t=>ue(t)==="function",lt=t=>ue(t)==="number"&&!Number.isNaN(t),Qt=t=>ue(t)==="string",Pe=t=>t!==He&&ue(t)==="object",xs=t=>Lt.prototype.toString.call(t),St=t=>xs(t)==="[object Object]",ot=(t,e)=>t instanceof e,Rt=t=>t?t.getTime():Date.now(),vt=t=>t.context,Ft=t=>t.config,Ms=t=>t.options,Ys=t=>Ms(vt(t)),Xs=t=>{const{params:e,headers:s}=Ft(t);return je([t.type,t.url,e,t.data,s])},rt=t=>t.key,Ts=(t,e,s=[])=>{const n=N(t)?t(...s):t;return e(!!n.key,"hook handler must be a method instance or a function that returns method instance"),n},Ve=t=>{const e=xs(t);return/^\[object (Blob|FormData|ReadableStream|URLSearchParams)\]$/i.test(e)||ot(t,ArrayBuffer)},Jt=(t,...e)=>Lt.assign(t,...e),Is=(t,...e)=>{const s={};for(const n in t)e.includes(n)||(s[n]=t[n]);return s};function Ps(){let t,e;return{promise:new Promise((n,o)=>{t=n,e=o}),resolve:t,reject:e}}const Yt=t=>{const{cacheFor:e}=Ft(t),s=u=>lt(u)?Rt()+u:Rt(u||m);let n=Gt,o=()=>0,a=y,r=m;const l=N(e);if(!l){let u=e;if(St(e)){const{mode:h=Gt,expire:c,tag:i}=e||{};n=h,a=h===At,r=i?i.toString():m,u=c}o=h=>s(N(u)?u({method:t,mode:h}):u)}return{f:e,c:l,e:o,m:n,s:a,t:r}},U=(t,...e)=>new t(...e),ze=(t,e=[])=>N(t)?t(...e):t,Zs=(t,e)=>N(t)?t:[y,He].includes(t)?X:e,tn=(t=0)=>{let e=m;return s=>{e&&clearTimeout(e),e=le(s,t)}},en=(t=y)=>{const e=[];let s=m,n=!1;const o=async()=>{for(n=!0;j(e)>0;){const l=Qs(e);l&&await l()}s&&s(),n=!1};return{addQueue:l=>U(Y,(u,h)=>{Z(e,()=>wt(l(),u,i=>{t?u(m):h(i)})),n||o()}),onComplete:l=>{s=l}}},oe=(t,e,s=b,n,o)=>{const a=()=>{o&&n&&(t=e(t,n,o),t!==o[n]&&(o[n]=t))};if(s&&a(),Pe(t))for(const r in t)ot(t,String)||oe(t[r],e,s,r,t);return!s&&a(),t},sn="$a.",de=(t,e)=>sn+t+e,nn=(t,e,s)=>{t=t.endsWith("/")?t.slice(0,-1):t,e!==""&&(e=e.match(/^(\/|https?:\/\/)/)?e:`/${e}`);const n=t+e,o=ct(mt(pt(s),a=>s[a]!==m),a=>`${a}=${s[a]}`).join("&");return o?+n.includes("?")?`${n}&${o}`:`${n}?${o}`:n};class _s extends Error{constructor(e,s,n){super(s+(n?`

For detailed: https://alova.js.org/error#${n}`:"")),this.name=`[alova${e?`/${e}`:""}]`}}const qt=(t="")=>(e,s,n)=>{if(!e)throw U(_s,t,s,n)},fe=()=>{const t={};return{eventMap:t,on(e,s){const n=t[e]=t[e]||[];return Z(n,s),()=>{t[e]=mt(n,o=>o!==s)}},off(e,s){const n=t[e];if(n)if(s){const o=n.indexOf(s);o>-1&&n.splice(o,1)}else delete t[e]},emit(e,s){const n=t[e]||[];return ct(n,o=>o(s))}}};class Vt{constructor(e,s,n,o){this.s=e,this.k=s,this.$dhy=n,this.$exp=o}get v(){return this.$dhy(this.s)}get e(){return this.$exp(this.s)}}class is extends Vt{constructor(e,s,n,o,a){super(e,s,n,o),this.$upd=a}set v(e){this.$upd(this.s,e)}get v(){return super.v}}let he={autoHitCache:"global",ssr:Js};const It="color: black; font-size: 12px; font-weight: bolder";var on=(t,e,s,n)=>{const o=console,a=(...d)=>console.log(...d),{url:r}=e,l=s===At,u="\x1B[42m%s\x1B[49m",h="\x1B[32m%s\x1B[39m",c=` [HitCache]${r} `,i=()=>Array(j(c)+1).join("^");he.ssr?(a(u,c),a(h," Cache ",t),a(h," Mode  ",s),l&&a(h," Tag   ",n),a(h,i())):(o.groupCollapsed?o.groupCollapsed("%cHitCache","padding: 2px 6px; background: #c4fcd3; color: #53b56d;",r):a(u,c),a("%c[Cache]",It,t),a("%c[Mode]",It,s),l&&a("%c[Tag]",It,n),a("%c[Method]",It,e),o.groupEnd?o.groupEnd():a(h,i()))};const _e=t=>`hss.${t}`,As="hsr.",Ae=t=>As+t,ae="$$hsrs",Fs="__$<>$__",Fe=(t,e)=>{t[e]=0},Bt=async(t,e,s,n,o,a,r)=>{if(n>Rt()&&s){const l=de(t,e);if(await o.set(l,mt([s,n===1/0?m:n,r],Boolean)),a){const u={},h=[];at(a,d=>{const f=ot(d,Oe),w=f?d.source+(d.flags?Fs+d.flags:""):d;w&&(f&&!u[w]&&Z(h,w),Fe(u,f?Ae(w):_e(w)))});const c=ct(pt(u),async d=>{const f=await o.get(d)||{};Fe(f,l),await o.set(d,f)}),i=async()=>{if(j(h)){const d=await o.get(ae)||[];Z(d,...h),await o.set(ae,d)}};await Y.all([...c,i()])}}},De=async(t,e,s)=>{const n=de(t,e);await s.remove(n)},Ds=async(t,e,s,n)=>{const o=await s.get(de(t,e));if(o){const[a,r,l]=o;if(l===n&&(!r||r>Rt()))return o;await De(t,e,s)}},Ot=async(t,e,s,n)=>{const o=await Ds(t,e,s,n);return o?o[0]:m},ls=async t=>Y.all(t.map(e=>e.clear())),an=async(t,e,s)=>{const n=`${e}`,o={},a=_e(t);o[a]=await s.get(a);let r;if(e){const c=_e(n);o[c]=await s.get(c),r=await s.get(ae);const i=[];r&&j(r)&&(at(r,d=>{const[f,w]=d.split(Fs);U(Oe,f,w).test(n)&&Z(i,d)}),await Y.all(ct(i,async d=>{const f=Ae(d);o[f]=await s.get(f)})))}const l=async c=>{try{await s.remove(c);for(const i in o){const d=o[i];d&&_t(d,c)}}catch{}},u={};await Y.all(ct(pt(o),async c=>{const i=o[c];if(i){const d=[];for(const f in i)u[f]||(Fe(u,f),Z(d,l(f)));await Y.all(d)}}));const h=j(r||[]);await Y.all(ct(pt(o),async c=>{const i=o[c];i&&(j(pt(i))?await s.set(c,i):(await s.remove(c),c.includes(As)&&r&&(r=mt(r,d=>Ae(d)!==c))))})),h!==j(r||[])&&await s.set(ae,r)};var rn=t=>{const{data:e,config:s}=t,n={...s},{headers:o={},params:a={}}=n,r=vt(t);n.headers={...o},n.params={...a};const l=U(it,t.type,r,t.url,n,e);return Jt(l,{...t,config:n})};const Ue=async(t,{policy:e="all"}={})=>{if(t&&t.key){const{id:s,l1Cache:n,l2Cache:o}=vt(t),a=rt(t),{f:r,c:l,s:u,e:h,t:c}=Yt(t);if(l)return r();let i=e!=="l2"?await Ot(s,a,n):m;return e==="l2"?i=await Ot(s,a,o,c):e==="all"&&!i&&u&&h(At)>Rt()&&(i=await Ot(s,a,o,c)),i}},be=async(t,e,{policy:s="all"}={})=>{const o=(ft(t)?t:[t]).map(async a=>{const{hitSource:r}=a,{id:l,l1Cache:u,l2Cache:h}=vt(a),c=rt(a),{e:i,s:d,t:f,c:w}=Yt(a);if(w)return;let x=e;if(N(e)){let T=s!=="l2"?await Ot(l,c,u):m;if((s==="l2"||s==="all"&&!T&&d&&i(At)>Rt())&&(T=await Ot(l,c,h,f)),x=e(T),x===m)return}return Y.all([s!=="l2"&&Bt(l,c,x,i(Gt),u,r),s==="l2"||s==="all"&&d?Bt(l,c,x,i(At),h,r,f):m])});return Y.all(o)},cn=async t=>{if(!t){await Y.all([ls(re),ls(ce)]);return}const s=(ft(t)?t:[t]).map(n=>{const{id:o,l1Cache:a,l2Cache:r}=vt(n),{c:l}=Yt(n);if(l)return;const u=rt(n);return Y.all([De(o,u,a),De(o,u,r)])});await Y.all(s)},ln=async t=>{const{autoHitCache:e}=he,{l1Cache:s,l2Cache:n}=vt(t),o=rt(t),{name:a}=Ft(t),r={global:[...re,...ce],self:[s,n],close:[]}[e];r&&j(r)&&await Y.all(ct(r,l=>an(o,a,l)))},us={};function un(t,e){let s=b,n;const o=U(Y,r=>{n=r});return{abort:()=>{wt(o,r=>r&&r.abort())},onDownload:r=>{wt(o,l=>l&&l.onDownload&&l.onDownload(r))},onUpload:r=>{wt(o,l=>l&&l.onUpload&&l.onUpload(r))},response:async()=>{const{beforeRequest:r=X,responded:l,requestAdapter:u,cacheLogger:h}=Ys(t),c=rt(t),{s:i,t:d,m:f,e:w}=Yt(t),{id:x,l1Cache:T,l2Cache:E,snapshots:P}=vt(t),{cacheFor:q}=Ft(t),{hitSource:K}=t;let W=await(N(q)?q():e?m:Ot(x,c,T));if(f===At&&!W){const O=await Ds(x,c,E,d);if(O){const[J,st]=O;await Bt(x,c,J,st,T,K),W=J}}const $=rn(t);await r($);const{baseURL:G,url:M,type:_,data:R}=$,{params:S={},headers:V={},transform:F=ne,shareRequest:Q}=Ft($),k=us[x]=us[x]||{};let v=k[c],L=ne,A=m,I=X;if(N(l))L=l;else if(St(l)){const{onSuccess:O,onError:J,onComplete:st}=l;L=N(O)?O:L,A=N(J)?J:A,I=N(st)?st:I}if(W!==m)return n(),Zs(h,on)(W,$,f,d),I($),W;if(s=y,!Q||!v){const O=u({url:nn(G,M,S),type:_,data:R,headers:V},$);v=k[c]=O}n(v);const H=async(O,J,st=b)=>{const bt=await O,ut=await F(bt,J||{});P.save(t);try{await ln($)}catch{}const ht=$.data;if((!ht||!Ve(ht))&&st)try{await Y.all([Bt(x,c,ut,w(Gt),T,K),i&&Bt(x,c,ut,w(At),E,K,d)])}catch{}return ut};return bs(wt(Y.all([v.response(),v.headers()]),([O,J])=>(_t(k,c),H(L(O,$),J)),O=>(_t(k,c),N(A)?H(A(O,$),m,y):ke(O))),()=>{I($)})},fromCache:()=>s}}const ds=(t,e)=>()=>{const s=e.indexOf(t);s>=0&&e.splice(s,1)};class it{constructor(e,s,n,o,a){this.dhs=[],this.uhs=[],this.fromCache=m;const r=()=>{r.a()};r.a=X;const l=this,u=Ms(s);l.abort=r,l.baseURL=u.baseURL||"",l.url=n,l.type=e,l.context=s;const h={},c="cacheFor",i=St(u[c])?u[c][e]:m,d=o&&o.hitSource;at(["timeout","shareRequest"],f=>{u[f]!==m&&(h[f]=u[f])}),i!==m&&(h[c]=i),d&&(l.hitSource=ct(ft(d)?d:[d],f=>ot(f,it)?rt(f):f),_t(o,"hitSource")),l.config={...h,headers:{},params:{},...o||{}},l.data=a,l.meta=o?o.meta:l.meta,l.key=l.generateKey()}onDownload(e){return Z(this.dhs,e),ds(e,this.dhs)}onUpload(e){return Z(this.uhs,e),ds(e,this.uhs)}send(e=y){const s=this,{response:n,onDownload:o,onUpload:a,abort:r,fromCache:l}=un(s,e);return j(s.dhs)>0&&o((u,h)=>at(s.dhs,c=>c({loaded:u,total:h}))),j(s.uhs)>0&&a((u,h)=>at(s.uhs,c=>c({loaded:u,total:h}))),s.abort.a=r,s.fromCache=m,s.promise=wt(n(),u=>(s.fromCache=l(),u)),s.promise}setName(e){Ft(this).name=e}generateKey(){return Xs(this)}then(e,s){return wt(this.send(),e,s)}catch(e){return zt(this.send(),e)}finally(e){return bs(this.send(),e)}}const pe=qt(),Ct="success",dn=()=>{let t={};const e=fe();return{set(n,o){t[n]=o,e.emit(Ct,{type:"set",key:n,value:o,container:t})},get:n=>{const o=t[n];return e.emit(Ct,{type:"get",key:n,value:o,container:t}),o},remove(n){_t(t,n),e.emit(Ct,{type:"remove",key:n,container:t})},clear:()=>{t={},e.emit(Ct,{type:"clear",key:"",container:t})},emitter:e}},yt=()=>(pe(typeof localStorage<"u","l2Cache is not defined."),localStorage),fn=()=>{const t=fe();return{set:(s,n)=>{yt().setItem(s,je(n)),t.emit(Ct,{type:"set",key:s,value:n,container:yt()})},get:s=>{const n=yt().getItem(s),o=n&&Ws(n);return t.emit(Ct,{type:"get",key:s,value:o,container:yt()}),o},remove:s=>{yt().removeItem(s),t.emit(Ct,{type:"remove",key:s,container:yt()})},clear:()=>{yt().clear(),t.emit(Ct,{type:"clear",key:"",container:yt()})},emitter:t}},fs=Set;class hn{constructor(e){this.records={},this.occupy=0,pe(e>=0,"expected snapshots limit to be >= 0"),this.capacity=e}save(e){const{name:s}=Ft(e),{records:n,occupy:o,capacity:a}=this;s&&o<a&&((n[s]=n[s]||U(fs)).add(e),this.occupy+=1)}match(e,s=!0){let n,o,a,r=e;St(e)&&(r=e.name,a=e.filter),ot(r,Oe)?o=r:Qt(r)&&(n=r);const{records:l}=this;let u=U(fs);n?u=l[n]||u:o&&at(mt(pt(l),c=>o.test(c)),c=>{l[c].forEach(i=>u.add(i))});const h=N(a)?mt([...u],a):[...u];return s?h:h[0]}}const Us="GET",pn="HEAD",mn="POST",gn="PUT",vn="PATCH",Sn="DELETE",yn="OPTIONS",hs={cacheFor:{[Us]:3e5},shareRequest:b,snapshots:1e3};let wn=0;class Cn{constructor(e){var s,n;const o=this;o.id=(e.id||(wn+=1)).toString(),o.l1Cache=e.l1Cache||dn(),o.l2Cache=e.l2Cache||fn(),o.options={...hs,...e},o.snapshots=U(hn,(n=(s=e.snapshots)!==null&&s!==void 0?s:hs.snapshots)!==null&&n!==void 0?n:0)}Get(e,s){return U(it,Us,this,e,s)}Post(e,s,n){return U(it,mn,this,e,n,s)}Delete(e,s,n){return U(it,Sn,this,e,n,s)}Put(e,s,n){return U(it,gn,this,e,n,s)}Head(e,s){return U(it,pn,this,e,s)}Patch(e,s,n){return U(it,vn,this,e,n,s)}Options(e,s){return U(it,yn,this,e,s)}}let Wt=m;const re=[],ce=[],En=t=>{const e=U(Cn,t),s=e.options.statesHook;Wt&&pe(Wt===s,"expected to use the same `statesHook`"),Wt=s;const{l1Cache:n,l2Cache:o}=e;return!re.includes(n)&&Z(re,n),!ce.includes(o)&&Z(ce,o),e},Dt=()=>(pe(!!Wt,"`statesHook` is not set in alova instance"),Wt);var Rn={name:"Vue",create:t=>Vs(t),dehydrate:t=>t.value,update:(t,e)=>{e.value=t},effectRequest({handler:t,removeStates:e,immediate:s,watchingStates:n}){Ee()&&as(e),s&&t(),at(n||[],(o,a)=>{rs(o,()=>{t(a)},{deep:b})})},computed:t=>js(t),watch:(t,e)=>{rs(t,e,{deep:b})},onMounted:t=>{Ee()?zs(t):le(t,10)},onUnmounted:t=>{Ee()&&as(t)}};const bn=t=>Qt(t)||Ve(t);function Be(){return(t,e)=>{const s=e.config,n=s.timeout||0,o=new AbortController,{data:a,headers:r}=t,l=/content-type/i.test(Lt.keys(r).join()),u=a&&a.toString()==="[object FormData]";!l&&!u&&(r["Content-Type"]="application/json;charset=UTF-8");const h=fetch(t.url,{...s,method:t.type,signal:o.signal,body:bn(a)?a:je(a)});let c,i=y;return n>0&&(c=le(()=>{i=b,o.abort()},n)),{response:()=>h.then(d=>(Te(c),d.clone()),d=>ke(i?U(Error,"fetchError: network timeout"):d)),headers:()=>h.then(({headers:d})=>d,()=>({})),onDownload:async d=>{let f=y;const w=await h.catch(()=>{f=b});if(!w)return;const{headers:x,body:T}=w.clone(),E=T?T.getReader():m,P=Number(x.get("Content-Length")||x.get("content-length")||0);if(P<=0)return;let q=0;if(E){const K=()=>E.read().then(({done:W,value:$=new Uint8Array})=>{if(W||f)f&&d(P,0);else return q+=$.byteLength,d(P,q),K()});K()}},onUpload(){console.error("fetch API does'nt support uploading progress. please consider to change `@alova/adapter-xhr` or `@alova/adapter-axios`")},abort:()=>{o.abort(),Te(c)}}}}const xe={authRole:null},Zt={authRole:"login"},xn={authRole:"logout"},te={authRole:"refreshToken"},dt=({meta:t},e)=>{if(St(t)){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const n=e[s];if(ot(n,RegExp)?n.test(t[s]):t[s]===n)return b}}return y},Ls=(t,e)=>U(Y,s=>{Z(e,{method:t,resolve:s})}),ps=(t,e,s,n)=>{if(dt(t,(e==null?void 0:e.metaMatches)||s))return(N(e)?e:St(e)&&N(e.handler)?e.handler:X)(n,t)},ms=async(t,e,s,n,o,a)=>{const r=j(n)>=2;let l=o==null?void 0:o.isExpired(...n);if(ot(l,Y)&&(l=await l),l)try{let u=b;if(r&&a&&(u=y,await Ls(t,e)),u&&(s(b),await(o==null?void 0:o.handler(...n)),s(y),at(e,({resolve:h})=>h())),r){const{config:h}=t,c=h.transform;h.transform=m;const i=await t;return h.transform=c,i}}finally{s(y),Pt(e,0,j(e))}},Mn=t=>{let e=m,s=m,n=m;if(N(t))e=t;else if(St(t)){const{onSuccess:o,onError:a,onComplete:r}=t;e=N(o)?o:e,s=N(a)?a:s,n=N(r)?r:n}return{onSuccess:e,onError:s,onComplete:n}},Tn=({visitorMeta:t,login:e,logout:s,refreshTokenOnSuccess:n,refreshTokenOnError:o,assignToken:a=X})=>{let r=y;const l=[];return{waitingList:l,onAuthRequired:c=>async i=>{const d=dt(i,t||xe),f=dt(i,(e==null?void 0:e.metaMatches)||Zt);return!d&&!f&&!dt(i,(n==null?void 0:n.metaMatches)||te)&&!dt(i,(o==null?void 0:o.metaMatches)||te)&&r&&await Ls(i,l),!d&&!f&&await a(i),c==null?void 0:c(i)},onResponseRefreshToken:c=>{const i=Mn(c);return{...i,onSuccess:async(d,f)=>{if(!dt(f,t||xe)&&!dt(f,(e==null?void 0:e.metaMatches)||Zt)&&!dt(f,(n==null?void 0:n.metaMatches)||te)){const w=await ms(f,l,x=>{r=x},[d,f],n,r);if(w)return w}return await ps(f,e,Zt,d),await ps(f,s,xn,d),(i.onSuccess||ne)(d,f)},onError:async(d,f)=>{if(!dt(f,t||xe)&&!dt(f,(e==null?void 0:e.metaMatches)||Zt)&&!dt(f,(o==null?void 0:o.metaMatches)||te)){const w=await ms(f,l,x=>{r=x},[d,f],o,r);if(w)return w}return(i.onError||X)(d,f)}}}}},Pn=(t,e)=>{let s=He;return function(...o){const a=t.bind(this,...o),r=lt(e)?e:e(...o);s&&Te(s),r>0?s=le(a,r):a()}},_n=(t,e)=>{const s={};for(const n in t)s[n]=e(t[n],n,t);return s};var gt;(function(t){t[t.USE_REQUEST=1]="USE_REQUEST",t[t.USE_WATCHER=2]="USE_WATCHER",t[t.USE_FETCHER=3]="USE_FETCHER"})(gt||(gt={}));function Ht(t,e={trackedKeys:{},bindError:y}){const s=c=>t.ref?t.ref(c):{current:c};e=s(e).current;const n=c=>(t.export||ne)(c,e),o=c=>{if(!N(t.memorize))return c;const i=t.memorize(c);return i.memorized=!0,i},{dehydrate:a}=t,r=(c,i,d)=>c!==a(i,d,e)&&e.trackedKeys[d]&&t.update(c,i,d,e),l=c=>ct(c,i=>ot(i,Vt)?i.e:i),u=[],h={};return{create:(c,i)=>(Z(u,i),U(is,t.create(c,i,e),i,d=>a(d,i,e),n,(d,f)=>r(f,d,i))),computed:(c,i,d)=>(at(i,f=>{f.k&&(h[f.k]=!0)}),U(Vt,t.computed(c,l(i),d,e),d,f=>a(f,d,e),n)),effectRequest:c=>t.effectRequest(c,e),ref:s,watch:(c,i)=>t.watch(l(c),i,e),onMounted:c=>t.onMounted(c,e),onUnmounted:c=>t.onUnmounted(c,e),memorize:o,__referingObj:e,exposeProvider:c=>{const i={},d={};for(const E in c){const P=c[E];if(N(P)&&!e.trackedKeys[E])i[E]=E.startsWith("on")?(...K)=>(P(...K),T):P.memorized?P:o(P);else{const K=ot(P,Vt);K&&(d[E]=P.s),Lt.defineProperty(i,E,{get:()=>(e.trackedKeys[E]=b,K?P.e:P),set:X,enumerable:b,configurable:b})}}const{update:f,__proxyState:w}=i;e.trackedKeys={...h},e.bindError=y;const x={__referingObj:e,update:o(E=>{pt(E).forEach(P=>{se(u,P)?r(E[P],d[P],P):P in i&&N(f)&&f({[P]:E[P]})})}),__proxyState:o(E=>se(u,E)&&ot(c[E],Vt)?(e.trackedKeys[E]=b,c[E]):w(E))},T=Jt(i,x);return T},objectify:(c,i)=>c.reduce((d,f)=>(d[f.k]=i?f[i]:f,d),{}),transformState2Proxy:(c,i)=>U(is,c,i,d=>a(d,i,e),n,(d,f)=>r(f,d,i))}}const An=qt("useRequest"),qs=qt("useWatcher"),Ks=qt("useFetcher"),$s=t=>({[gt.USE_REQUEST]:An,[gt.USE_WATCHER]:qs,[gt.USE_FETCHER]:Ks})[t],Ns=(t,e)=>t(ot(e,it),"expected a method instance."),Le="success",qe="error",Ke="complete";var Fn=(t,e,s,n)=>({m,sf:[],rf:[],fs:{},em:s,ht:t,c:e,ro:n,ms:{}});class Ut{constructor(e,s){this.method=e,this.args=s}clone(){return{...this}}static spawn(e,s){return new Ut(e,s)}}class Dn extends Ut{constructor(e,s,n){super(e.method,e.args),this.data=s,this.fromCache=n}}class Un extends Ut{constructor(e,s){super(e.method,e.args),this.error=s}}class gs extends Ut{constructor(e,s,n,o,a){super(e.method,e.args),this.status=s,this.data=n,this.fromCache=s==="error"?!1:o,this.error=a}}const Ln=(t,e)=>e(),ie={},qn=(t,e)=>(ie[t]||{})[e]||{},Kn=(t,e,s,n)=>{const o=ie[t]=ie[t]||{};o[e]={s,h:n}},$n=(t,e)=>{const s=ie[t];s&&_t(s,e)};function $e(t,e,s=[]){const n=$s(t.ht);let o=Ts(e,n,s);const{fs:a,ht:r,c:l,ms:u}=t,{loading:h,data:c,error:i}=a,d=r===gt.USE_FETCHER,{force:f=y,middleware:w=Ln}=l,x=vt(o),{id:T}=x,E=rt(o),{abortLast:P=b}=l,q=!t.m;return t.m=o,(async()=>{let K=X,W=X,$=y,G=Ne(m),M=X,_=X;const R=await Ue(o);let S=()=>!!R,V=y;d||(W=H=>Kn(T,E,H,t),W({...a,...u}),K=()=>$n(T,E));const F=H=>{$=b;const{force:O=f,method:J=o}=H||{},st=ze(O,[U(Ut,o,s)]),bt=xt=>({loaded:Mt,total:jt})=>{a[xt].v={loaded:Mt,total:jt}};o=J,Z(t.sf,W),Z(t.rf,K),V||(h.v=!!st||!R);const{downloading:ut,uploading:ht}=t.ro.trackedKeys;return M=ut?o.onDownload(bt("downloading")):M,_=ht?o.onUpload(bt("uploading")):_,G=o.send(st),S=()=>o.fromCache||y,G},Q={method:o,cachedResponse:R,config:l,abort:()=>o.abort()},k=()=>r!==gt.USE_WATCHER||!P||t.m===o,v=(H=b)=>{H&&q&&(h.v=y),V=H},L=w(d?{...Q,args:s,fetch:(H,...O)=>(Ns(n,H),$e(t,H,O)),proxyStates:Is(a,"data"),controlLoading:v}:{...Q,args:s,send:(...H)=>$e(t,e,H),proxyStates:a,controlLoading:v},F);let A=m;const I=Ut.spawn(o,s);try{const H=await L,O=J=>{if(!d)k()&&(c.v=J);else if(t.c.updateState!==y){const st=qn(T,E).s;st&&(st.data.v=J)}return k()&&(i.v=m,!V&&(h.v=y),t.em.emit(Le,U(Dn,I,J,S())),t.em.emit(Ke,U(gs,I,Le,J,S(),m))),J};A=H!==m?O(H):$?await wt(G,O,()=>O(m)):m,!$&&!V&&(h.v=y)}catch(H){throw k()&&(i.v=H,!V&&(h.v=y),t.em.emit(qe,U(Un,I,H)),t.em.emit(Ke,U(gs,I,qe,m,S(),H))),H}return M(),_(),A})()}const vs=t=>t.current;function We(t,e,s,n,o=y,a,r=0){var l;s={...s};const{__referingObj:u={trackedKeys:{},bindError:y}}=s;let h=!!o;if(o)try{const v=Ts(e,$s(t)),L=vt(v),A=L.l1Cache.get(de(L.id,rt(v)));let I=m;if(A&&!ot(A,Y)){const[O,J]=A;(!J||J>Rt())&&(I=O)}h=!!ze((l=s.force)!==null&&l!==void 0?l:y)||!I}catch{}const{create:c,effectRequest:i,ref:d,objectify:f,exposeProvider:w,transformState2Proxy:x}=Ht(Dt(),u),T={total:0,loaded:0},{managedStates:E={}}=s,P=_n(E,(v,L)=>x(v,L)),q=c(N(n)?n():n,"data"),K=c(h,"loading"),W=c(m,"error"),$=c({...T},"downloading"),G=c({...T},"uploading"),M=f([q,K,W,$,G]),_=fe(),R=vs(d(Fn(t,s,_,u)));R.fs=M,R.em=_,R.c=s,R.ms=P;const S=a!==m,V=(v=e,L)=>$e(R,v,L),F=vs(d(tn())),Q=(v=u,L)=>{F(()=>{zt(V(L),A=>{if(!v.bindError&&!v.trackedKeys.error)throw A})})},k=d(Pn((v,L,A)=>Q(L,A),v=>lt(v)?ft(r)?r[v]:r:0));return he.ssr||i({handler:S?v=>k.current(v,u,e):()=>Q(u),removeStates:()=>at(R.rf,v=>v()),saveStates:v=>at(R.sf,L=>L(v)),frontStates:{...M,...P},watchingStates:a,immediate:o??b}),w({...f([q,K,W,$,G]),abort:()=>R.m&&R.m.abort(),send:(v,L)=>V(L,v),onSuccess(v){_.on(Le,v)},onError(v){u.bindError=b,_.on(qe,v)},onComplete(v){_.on(Ke,v)}})}function Nn(t={}){const e=We(gt.USE_FETCHER,X,t),{send:s}=e;return _t(e,"send"),Jt(e,{fetch:(n,...o)=>(Ns(Ks,n),s(o,n))})}function Ge(t,e={}){const{immediate:s=b,initialData:n}=e,o=We(gt.USE_REQUEST,t,e,n,!!s),{send:a}=o;return Jt(o,{send:(...r)=>a(r)})}function kn(t,e,s={}){qs(e&&j(e)>0,"expected at least one watching state");const{immediate:n,debounce:o=0,initialData:a}=s,r=We(gt.USE_WATCHER,t,s,a,!!n,e,o),{send:l}=r;return Jt(r,{send:(...u)=>l(u)})}var On=t=>{let e={};return{snapshots:()=>e,save(s,n=y){const o=rt(s);(!e[o]||n)&&(e[o]={entity:s})},get:s=>e[rt(ot(s,it)?s:t(s))],remove(s){s?delete e[s]:e={}}}};const Nt=qt("usePagination"),Ss=(t,e)=>Nt(lt(t)&&t<j(e),"index must be a number that less than list length");var wo=(t,e={})=>{const{create:s,computed:n,ref:o,watch:a,exposeProvider:r,objectify:l,__referingObj:u}=Ht(Dt()),{preloadPreviousPage:h=b,preloadNextPage:c=b,total:i=g=>g.total,data:d=g=>g.data,append:f=y,initialPage:w=1,initialPageSize:x=10,watchingStates:T=[],initialData:E,immediate:P=b,middleware:q,force:K=X,...W}=e,$=o(t),G=o(y),M=s(w,"page"),_=s(x,"pageSize"),R=s(E?d(E)||[]:[],"data"),S=s(E?i(E):m,"total"),{snapshots:V,get:F,save:Q,remove:k}=o(On(g=>$.current(g,_.v))).current,v=g=>d(g)||g,L=Nn({__referingObj:u,updateState:y,force:({args:g})=>g[0]}),{loading:A,fetch:I,abort:H,onSuccess:O}=L,J=o(A),st=(g=M.v)=>{const p=_.v,C=t(g,p);return Q(C),C};a(T,()=>{M.v=w,G.current=b});const bt=o({}),ut=n(()=>{const g=S.v;return g!==m?Math.ceil(g/_.v):m},[_,S],"pageCount"),ht=g=>(...p)=>bt.current[g](...p),xt=kn(st,[...T,M.e,_.e],{__referingObj:u,immediate:P,initialData:E,managedStates:l([R,M,_,S],"s"),middleware(g,p){return q?q({...g,delegatingActions:{refresh:ht("refresh"),insert:ht("insert"),remove:ht("remove"),replace:ht("replace"),reload:ht("reload"),getState:C=>({page:M,pageSize:_,data:R,pageCount:ut,total:S,isLastPage:ge})[C].v}},p):p()},force:g=>g.args[1]||(N(K)?K(g):K),...W}),{send:Mt}=xt,jt=xt.__proxyState("data"),Je=async g=>{const{rawData:p=jt.v,preloadPage:C,fetchMethod:D,forceRequest:z=y,isNextPage:B=y}=g,{e:tt}=Yt(D);if(tt(Gt)<=Rt())return y;if(z)return b;if(await Ue(D))return y;const et=ut.v,nt=et?C>et:B?j(v(p))<_.v:y;return C>0&&!nt},Ye=async(g,p=y)=>{const C=M.v+1,D=st(C);c&&await Je({rawData:g,preloadPage:C,fetchMethod:D,isNextPage:b,forceRequest:p})&&zt(I(D,p),X)},Os=async g=>{const p=M.v-1,C=st(p);h&&await Je({rawData:g,preloadPage:p,fetchMethod:C})&&zt(I(C),X)},ge=n(()=>{const g=jt.v;if(!g)return b;const p=v(g),C=M.v,D=ut.v,z=ft(p)?j(p):0;return D?C>=D:z<_.v},[M,ut,jt,_],"isLastPage"),ve=async()=>{const g=F(M.v);g&&await be(g.entity,p=>{if(p){const C=v(p)||[];return Pt(C,0,j(C),...R.v),p}})};O(({method:g,data:p})=>{const C=F(M.v);if(C&&rt(C.entity)===rt(g)){const D=v(p);if(f){const z=R.v,B=_.v,tt=j(z)%B;if(tt>0){const et=[...R.v];Pt(et,(M.v-1)*B,tt,...D),R.v=et}}else R.v=D}});const Se=o(m),ye=o(m);xt.onSuccess(({data:g,args:[p,C],method:D})=>{const{total:z}=F(D)||{},B=g;S.v=z!==m?z:i(B),C||(Os(B),Ye(B));const tt=_.v,et=v(B);if(Nt(ft(et),"Got wrong array, did you return the correct array of list in `data` function"),f){if(G.current&&(R.v=[]),p===m)R.v=[...R.v,...et];else if(p){const nt=[...R.v];Pt(nt,(p-1)*tt,tt,...et),R.v=nt}}else R.v=et}).onSuccess(({data:g})=>{var p;(p=Se.current)===null||p===void 0||p.call(Se,g)}).onError(({error:g})=>{var p;(p=ye.current)===null||p===void 0||p.call(ye,g)}).onComplete(()=>{G.current=y});const Xt=g=>{const p=R.v.indexOf(g);return Nt(p>=0,"item is not found in list"),p},{addQueue:we,onComplete:Xe}=o(en()).current,Ce=async(g=M.v)=>{let p=g,C=Ne();if(f){if(!lt(g)){const D=Xt(g);p=Math.floor(D/_.v)+1}Nt(p<=M.v,"refresh page can't greater than page"),C=Mt(p,b)}else Nt(lt(p),"unable to calculate refresh page by item in pagination mode"),C=p===M.v?Mt(m,b):I(t(p,_.v),b);return C},Ie=async(g=y)=>{const p=M.v,C=V();let D=Gs(C);if(g)k();else{const z=ct(mt([F(p-1),F(p),F(p+1)],Boolean),({entity:B})=>rt(B));D=ct(mt(pt(C),B=>!se(z,B)),B=>{const tt=C[B];return delete C[B],tt})}await cn(ct(D,({entity:z})=>z))},Ze=async()=>{J.current&&H(),await Ie();const g=F(M.v+1);if(g){const p=v(await Ue(g.entity)||{})||[];Ye(m,j(p)<_.v)}},ts=g=>{if(g===0)return;const p=S.v;if(lt(p)){const C=Math.max(p+g,0);S.v=C;const D=M.v;at([F(D-1),F(D),F(D+1)],z=>{z&&(z.total=C)})}},es=(g,p=0)=>(Xe(Ze),we(async()=>{const C=lt(p)?p:Xt(p)+1;let D=m;const z=[...R.v];if(j(z)%_.v===0&&(D=z.pop()),Pt(z,C,0,g),R.v=z,ts(1),await ve(),D){const B=F(M.v+1);B&&await be(B.entity,tt=>{if(tt){const et=v(tt)||[];return et.unshift(D),et.pop(),tt}})}})),ss=(...g)=>(Xe(Ze),we(async()=>{const p=ct(g,nt=>{const Kt=lt(nt)?nt:Xt(nt);return Ss(Kt,R.v),Kt}),C=M.v,D=C+1,z=F(D),B=[];z&&await be(z.entity,nt=>{if(nt){const Kt=v(nt);return ft(Kt)&&Z(B,...Pt(Kt,0,j(p))),nt}});const tt=ge.v,et=j(B);if(et>0||tt){const nt=mt(R.v,(Kt,Hs)=>!se(p,Hs));!f&&tt&&j(nt)<=0?M.v=C-1:et>0&&Z(nt,...B),R.v=nt}else et<=0&&!tt&&Ce(C);return ts(-j(p)),ve()})),ns=(g,p)=>we(async()=>{Nt(p!==m,"expect specify the replace position");const C=lt(p)?p:Xt(p);Ss(C,R.v);const D=[...R.v];Pt(D,C,1,g),R.v=D,await ve()}),os=async()=>{await Ie(b),G.current=b,M.v===w?zt(Mt(),X):M.v=w;const{resolve:g,reject:p,promise:C}=Ps();return Se.current=g,ye.current=p,C};return bt.current={refresh:Ce,insert:es,remove:ss,replace:ns,reload:os},r({...xt,...l([R,M,ut,_,S,ge]),fetching:L.loading,onFetchSuccess:L.onSuccess,onFetchError:L.onError,onFetchComplete:L.onComplete,refresh:Ce,insert:es,remove:ss,replace:ns,reload:os})},Hn={forward:t=>ot(t,Date)?t.getTime():m,backward:t=>U(Date,t)},jn={forward:t=>ot(t,RegExp)?t.source:void 0,backward:t=>U(RegExp,t)};const Vn=(t={})=>{const e={date:Hn,regexp:jn,...t};return{serialize:o=>(Pe(o)&&(o=oe(ft(o)?[...o]:{...o},a=>{let r=m;const l=pt(e).reduce((h,c)=>{if(!r){const i=e[c].forward(h);i!==m&&(r=c,h=i)}return h},a);return Lt.prototype.toString.call(a)==="[object Object]"?a={...a}:ft(a)&&(a=[...a]),r!==m?[r,l]:a})),o),deserialize:o=>Pe(o)?oe(o,a=>{if(ft(a)&&j(a)===2){const r=e[a[0]];a=r?r.backward(a[1]):a}return a},y):o}},Et=(t,e={})=>{let s=b;const{enableFocus:n=b,enableVisibility:o=b,enableNetwork:a=b,pollingTime:r=0,throttle:l=1e3}=e,{onMounted:u,onUnmounted:h,__referingObj:c}=Ht(Dt()),i=Ge(t,{...e,__referingObj:c}),d=()=>{s&&(i.send(),l>0&&(s=y,setTimeout(()=>{s=b},l)))};let f=X,w=X,x=X,T=X;return u(()=>{he.ssr||(f=a?Et.onNetwork(d,e):f,w=n?Et.onFocus(d,e):w,x=o?Et.onVisibility(d,e):x,T=r>0?Et.onPolling(d,e):T)}),h(()=>{f(),w(),x(),T()}),i},Qe=(t,e)=>(window.addEventListener(t,e),()=>window.removeEventListener(t,e));Et.onNetwork=t=>Qe("online",t);Et.onFocus=t=>Qe("focus",t);Et.onVisibility=t=>Qe("visibilitychange",()=>document.visibilityState==="visible"&&t());Et.onPolling=(t,e)=>{const s=setInterval(t,e.pollingTime);return()=>clearInterval(s)};const ks="useCaptcha",zn=qt(ks);var Co=(t,e={})=>{const{initialCountdown:s,middleware:n}=e;zn(s===m||s>0,"initialCountdown must be greater than 0");const{create:o,ref:a,objectify:r,exposeProvider:l,__referingObj:u}=Ht(Dt()),h=o(0,"countdown"),c=Ge(t,{...e,__referingObj:u,immediate:y,managedStates:r([h],"s"),middleware:n?(f,w)=>n({...f,send:d},w):m}),i=a(m),d=(...f)=>U(Y,(w,x)=>{h.v<=0?c.send(...f).then(T=>{h.v=e.initialCountdown||60,i.current=setInterval(()=>{h.v-=1,h.v<=0&&clearInterval(i.current)},1e3),w(T)}).catch(T=>x(T)):x(U(_s,ks,"the countdown is not over yet"))});return l({...c,send:d,...r([h])})};const ys=Symbol("FormRestore"),Bn=(t,e)=>`alova/form-${e||rt(t)}`,Wn={},ws=t=>{const e=s=>ft(s)?[...s]:St(s)?{...s}:s;return oe(e(t),e)};var Eo=(t,e={})=>{const s=Wn,{id:n,initialForm:o,store:a,resetAfterSubmiting:r,immediate:l=y,middleware:u}=e;Dt();const{create:h,ref:c,onMounted:i,watch:d,objectify:f,exposeProvider:w,__referingObj:x}=Ht(Dt()),T=St(a),E=T?a.enable:a,P=n?s[n]:m,q=h(ws(o),"form"),K=t,W=fe(),$=c(ze(K,[q.v])),G=vt($.current).l2Cache,M=Bn($.current,n),_=c(y),R=c(Vn(T?a.serializers:m)),S=c(!1),V=Ge((...A)=>K(q.v,...A),{...e,__referingObj:x,middleware:u?(A,I)=>u({...A,delegatingActions:{updateForm:Q,reset:F}},I):m,immediate:E||P?y:l}),F=()=>{_.current=b;const A=ws(o);A&&(q.v=A),E&&G.remove(M)},Q=A=>{q.v={...q.v,...A}},k=w({...V,...f([q]),updateForm:Q,reset:F,onRestore(A){W.on(ys,A)}});n&&(P||(S.current=b),S.current&&(s[n]={hookProvider:k,config:e}));const{send:v,onSuccess:L}=k;return i(()=>{if(E&&!P){const A=R.current.deserialize(G.get(M));A&&(q.v=A,W.emit(ys,m)),E&&l&&v()}}),d([q],()=>{if(_.current||!E){_.current=y;return}G.set(M,R.current.serialize(q.v))}),L(()=>{r&&F()}),P&&!S.current?P.hookProvider:k},Cs;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.OPEN=1]="OPEN",t[t.CLOSED=2]="CLOSED"})(Cs||(Cs={}));const kt={},Gn=t=>!!t.send,Qn=qt("subscriber"),Ro=t=>{const{ref:e}=Ht(Dt()),s=e(y);return(n,o)=>{if(!s.current){const{abort:a,proxyStates:r,delegatingActions:l={}}=n,u=c=>{for(const i in c)r[i]&&(r[i].v=c[i])};(kt[t]=kt[t]||[]).push(Gn(n)?{...l,send:n.send,abort:a,update:u}:{...l,fetch:n.fetch,abort:a,update:u}),s.current=b}return o()}},bo=(t,e,s=!1)=>{const n=[];typeof t=="symbol"||Qt(t)||lt(t)?kt[t]&&Z(n,...kt[t]):ot(t,RegExp)&&at(mt(pt(kt),o=>t.test(o)),o=>{Z(n,...kt[o])}),n.length===0&&!s&&Qn(!1,`no handler can be matched by using \`${t.toString()}\``),at(n,e)},Jn="BACKEND_ERROR",Yn=(t,e)=>{const{tokenRefresher:s}=e,{onAuthRequired:n,onResponseRefreshToken:o}=Tn({refreshTokenOnSuccess:{isExpired:(r,l)=>(s==null?void 0:s.isExpired(r,l))||!1,handler:async(r,l)=>s==null?void 0:s.handler(r,l)},refreshTokenOnError:{isExpired:(r,l)=>(s==null?void 0:s.isExpired(r,l))||!1,handler:async(r,l)=>s==null?void 0:s.handler(r,l)}});return En({...t,timeout:t.timeout??10*1e3,requestAdapter:t.requestAdapter??Be(),statesHook:Rn,beforeRequest:n(e.onRequest),responded:o({onSuccess:async(r,l)=>{var c;let u=null,h=null;try{await e.isBackendSuccess(r)?h=await e.transformBackendResponse(r):(u=new Error("the backend request error"),u.code=Jn)}catch(i){u=i}if(u)throw await((c=e.onError)==null?void 0:c.call(e,u,r,l)),u;return h},onComplete:e.onComplete,onError:(r,l)=>{var u;return(u=e.onError)==null?void 0:u.call(e,r,null,l)}})})},Xn="mock",In="#64bde8",Zn="#ccefff",to="Realtime",eo="#999999",so="#ededed",no=(t,e)=>`padding: 2px 6px; background: ${t}; color: ${e};`,$t="color: black; font-size: 12px; font-weight: bolder",Me=t=>{const e={};for(const s in t)e[s]={value:t[s]};return e},oo=({isMock:t,url:e,method:s,headers:n,query:o,data:a,responseHeaders:r,response:l})=>{const u=console;u.groupCollapsed(`%c${t?Xn:to}`,no(t?Zn:so,t?In:eo),e),u.log("%c[Method]",$t,s.toUpperCase()),u.log("%c[Request Headers]",$t),u.table(Me(n)),u.log("%c[Query String Parameters]",$t),u.table(Me(o)),u.log("%c[Request Body]",$t,a||""),t&&(Object.keys(r).length>0&&(u.log("%c[Response Headers]",$t),u.table(Me(r))),u.log("%c[Response Body]",$t,l||"")),u.groupEnd()},ao=({status:t=200,responseHeaders:e,statusText:s="ok",body:n})=>({response:new Response(Ve(n)?n:JSON.stringify(n),{status:t,statusText:s}),headers:new Headers(e)}),ro=t=>t,co=t=>{t=/^[^/]*\/\//.test(t)?t:`//${t}`;const e=t.split("/").slice(3),s={};let n=e.pop(),o="",a="";return n&&(n=n.replace(/\?[^?#]+/,r=>(r.substring(1).split("&").forEach(l=>{const[u,h]=l.split("=");u&&(s[u]=h)}),"")),n=n.replace(/#[^#]*/,r=>(a=r,"")),e.push(n),o=`/${e.join("/")}`),{pathname:o,query:s,hash:a}};function io({enable:t=b,delay:e=2e3,httpAdapter:s,mockRequestLogger:n=oo,mock:o,onMockResponse:a=ao,onMockError:r=ro,matchMode:l="pathname"}={mock:{}}){return(u,h)=>{o=t&&o||{};const{url:c,data:i,type:d,headers:f}=u;let w=h.url,x=h.config.params||{};if(l==="pathname"){const S=co(c);w=S.pathname,x=S.query}const T={},E=w.split("/"),P=Object.keys(o).filter(S=>{if(S.startsWith("-"))return y;let V="GET";if(S=S.replace(/^\[(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|TRACE|CONNECT)\]/i,(Q,k)=>(V=k.toUpperCase(),"")),V!==d.toUpperCase())return y;const F=S.split("/");if(F.length!==E.length)return y;for(const Q in F){const k=F[Q],v=(k.match(/^\{(.*)\}$/)||["",""])[1];if(v)T[v]=E[Q];else if(k!==E[Q])return y}return b});let q=P.find(S=>!/\{.*\}/.test(S));q=q||P.shift();const K=q?o[q]:m;if(K===m){if(s)return N(n)&&n({isMock:y,url:c,method:d,params:T,headers:f,query:x,data:{},responseHeaders:{}}),s(u,h);throw new Error(`cannot find the httpAdapter.
[url]${c}`)}const W=Ps(),{resolve:$}=W;let{promise:G,reject:M}=W;const _=h.config.timeout||0;_>0&&setTimeout(()=>{M(new Error("request timeout"))},_);const R=setTimeout(()=>{try{const S=N(K)?K({query:x,params:T,data:Qt(i)||!i?{}:i,headers:f}):K;$(U(Promise,(V,F)=>{M=F,Ne(S).then(V).catch(F)}))}catch(S){M(S)}},e);return G=G.then(S=>{let V=200,F="ok",Q={},k=m;return S===m?(V=404,F="api not found"):S&&lt(S.status)&&Qt(S.statusText)?(V=S.status,F=S.statusText,Q=S.responseHeaders||Q,k=S.body):k=S,U(Promise,(v,L)=>{try{const A=a({status:V,statusText:F,responseHeaders:Q,body:k},{headers:f,query:x,params:T,data:i||{}},h);v(A)}catch(A){L(A)}}).then(v=>(N(n)&&n({isMock:b,url:c,method:d,params:T,headers:f,query:x,data:i||{},responseHeaders:Q,response:k}),v))}).catch(S=>ke(r(S,h))),{response:()=>G.then(({response:S})=>S&&S.toString()==="[object Response]"?S.clone():S),headers:()=>G.then(({headers:S})=>S),abort:()=>{clearTimeout(R),M(new Error("The user abort request"))}}}}function lo(t,e={enable:!0}){let s={};return t.filter(({enable:n})=>n).forEach(({data:n})=>{s={...n,...s}}),io({...e,mock:s})}var uo=(t,e=!0)=>({enable:e,data:t});const fo=uo({"[POST]/systemManage/addUser":()=>({code:"0000",msg:"success",data:null}),"[POST]/systemManage/updateUser":()=>({code:"0000",msg:"success",data:null}),"[DELETE]/systemManage/deleteUser":()=>({code:"0000",msg:"success",data:null}),"[DELETE]/systemManage/batchDeleteUser":()=>({code:"0000",msg:"success",data:null}),"[POST]/auth/sendCaptcha":()=>({code:"0000",msg:"success",data:null}),"[POST]/auth/verifyCaptcha":()=>({code:"0000",msg:"success",data:null}),"/mock/getLastTime":()=>({code:"0000",msg:"success",data:{time:new Date().toLocaleTimeString()}})});function ho(){console.log("token处理添加-=---------------》");const t=ee.get("token");return t?`Bearer ${t}`:null}async function po(){const{resetStore:t}=Rs(),e=ee.get("refreshToken")||"",s=So(e);s.meta.authRole="refreshToken";try{const n=await s;ee.set("token",n.token),ee.set("refreshToken",n.refreshToken)}catch(n){throw t(),n}}function Es(t,e){var n,o;(n=t.errMsgStack)!=null&&n.length||(t.errMsgStack=[]),t.errMsgStack.includes(e)||(t.errMsgStack.push(e),(o=window.$message)==null||o.error(e,{onLeave:()=>{t.errMsgStack=t.errMsgStack.filter(a=>a!==e),setTimeout(()=>{t.errMsgStack=[]},5e3)}}))}const mo={VITE_OTHER_SERVICE_BASE_URL:'{"demo":"http://localhost:9000"}',VITE_SERVICE_BASE_URL:"http://localhost:9000"},go=!1,{baseURL:vo}=Bs(mo,go),Tt={errMsgStack:[]};lo([fo],{httpAdapter:Be(),delay:1e3,enable:!0,matchMode:"methodurl"});const me=Yn({baseURL:vo,requestAdapter:Be()},{onRequest({config:t}){console.log("token处理添加-=---------------》");const e=ho();t.headers.Authorization=e,t.headers.apifoxToken="XL299LiMEDZ0H5h3A29PxwQXdMJqWyY2"},tokenRefresher:{async isExpired(t){const e="9999,9998,3333".split(",")||[],{code:s}=await t.clone().json();return e.includes(String(s))},async handler(){await po()}},async isBackendSuccess(t){const s=await t.clone().json();return String(s.code)==="000000"},async transformBackendResponse(t){return(await t.clone().json()).data},async onError(t,e){var h,c;const s=Rs();let n=t.message,o="";if(e){const i=await(e==null?void 0:e.clone().json());n=i.msg,o=String(i.code)}function a(){Es(Tt,n),s.resetStore()}function r(){a(),window.removeEventListener("beforeunload",a),Tt.errMsgStack=Tt.errMsgStack.filter(i=>i!==n)}throw("8888,8889,401,10000".split(",")||[]).includes(o)?(a(),t):("7777,7778".split(",")||[]).includes(o)&&!((h=Tt.errMsgStack)!=null&&h.includes(n))?(Tt.errMsgStack=[...Tt.errMsgStack||[],n],window.addEventListener("beforeunload",a),(c=window.$dialog)==null||c.error({title:cs("common.error"),content:n,positiveText:cs("common.confirm"),maskClosable:!1,closeOnEsc:!1,onPositiveClick(){r()},onClose(){r()}}),t):(Es(Tt,n),t)}});function xo(t){return me.Post("/auth/sendCaptcha",{phone:t})}function Mo(t,e){return me.Post("/auth/verifyCaptcha",{phone:t,code:e})}function So(t){return me.Post("/auth/refreshToken",{refreshToken:t},{meta:{authRole:"refreshToken"}})}function To(t,e){return me.Get("/auth/error",{params:{code:t,msg:e},shareRequest:!1})}export{Ro as a,Eo as b,me as c,Et as d,bo as e,To as f,kn as g,wo as h,xo as s,Co as u,Mo as v};
