import{_ as Ci}from"./web-site-link.vue_vue_type_script_setup_true_lang-C943zWtg.js";import{V as yi}from"./vchart-all-qVMIEpz6.js";import{d as ot,r as Re,d3 as Pt,a as De,i as jt,c3 as pi,av as Ft,b as Ne,o as Ke,M as tt,df as St,f as L,bl as bt,a3 as It,P as Ye,F as fi,w as me,L as mi,h as O,Q as ht,c as ut,x as _i}from"./index-BAq2SbaD.js";import{l as Me,t as ct,m as wi,n as Hi,o as ce,p as it,H as Qe,q as Ti,r as Je,s as Pi,u as Si,w as bi,x as Ii,y as Ri,z as Di,A as Fi,E as At,F as Kt,J as vt,K as Le,M as ie,R as Ai,N as Ki,O as Li,Q as xi,U as Mi,V as Oi,W as Ei,X as Ni,Y as Bi,Z as Vi,_ as gt,$ as Wt,a0 as ft,a1 as nt,a2 as Lt,a3 as Ae,a4 as zi,a5 as st,a6 as Ct,a7 as Xe,a8 as Ut,a9 as ki,aa as xt,ab as Mt,ac as Ot,ad as qt,ae as Gt,af as Qt,ag as Jt,ah as $t,ai as Yt,aj as Xt,ak as Zt,al as ei,am as ti,an as ii,ao as oi,ap as ri,aq as si,ar as ji,as as Ge,at as rt,au as Et,av as Wi,aw as Ui,I as qi,T as Gi,ax as Qi,G as Ji,ay as $i,az as Yi,h as mt,aA as Xi,k as Ze,D as et}from"./index-CAM7bcOv.js";import{j as Oe,e as ge,i as M,G as lt,x as Zi}from"./symlog-scale-BFgIQWoy.js";import"./index-BgyTeVoR.js";function eo(D,e,t,i,o,r){const n=r.columnHeaderLevelCount,s=[],l=[];for(let c=0;c<t.length;c++)i.includes(t[c])||l.push(o[c]);for(let c=0;c<i.length;c++)if(!t.includes(i[c])){const h={col:D,row:n+c};s.push(h)}let d=r.getParentCellId(D,e),a=r.getRowHeaderCellAddressByCellId(d);const u=[];for(a&&u.push(a);d;)d=r.getParentCellId(a.col,a.row),d&&(a=r.getRowHeaderCellAddressByCellId(d),u.push(a));return{addCellPositions:s,removeCellPositions:l,updateCellPositions:u}}const Nt={startInTotal:0,level:0};class Ee{constructor(e,t,i,o){var r,n,s,l,d,a,u,c,h,v,g,f,C,w,S,H,m;this.colIndex=0,this._showHeader=!0,this.columnHeaderObjs=[],this.rowHeaderObjs=[],this._cornerHeaderCellFullPathIds=[],this._columnHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds_FULL=[],this._cornerHeaderCellIds=[],this._columnHeaderCellIds=[],this._rowHeaderCellIds=[],this._rowHeaderCellIds_FULL=[],this._columnWidths=[],this.columnPaths=[],this._headerObjects=[],this._headerObjectMap={},this._indicators=[],this.indicatorsAsCol=!0,this.hideIndicatorName=!1,this._showRowHeader=!0,this._showColumnHeader=!0,this._indicatorShowType="column",this.rowHierarchyTextStartAlignment=!1,this.rowDimensionKeys=[],this.colDimensionKeys=[],this.indicatorKeys=[],this.indicatorDimensionKey=Me,this._rowHeaderExtensionTree={},this._extensionRowDimensionKeys=[],this.fullRowDimensionKeys=[],this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this._useGetBodyCache=!1,this._getBodyCache=new Map,this._useHeaderPathCache=!1,this._colHeaderPathCache=new Map,this._rowHeaderPathCache=new Map,this.sharedVar=e.layoutNodeId,this._table=e,e.options.rowHierarchyType==="tree"&&(this.extensionRows=e.options.extensionRows),this.dataset=t,this._largeCellRangeCache=[],this._CellHeaderPathMap=new Map,this.rowTree=e.internalProps.rowTree,this.columnTree=e.internalProps.columnTree,this.rowsDefine=(r=e.internalProps.rows)!==null&&r!==void 0?r:[],this.columnsDefine=(n=e.internalProps.columns)!==null&&n!==void 0?n:[],this.indicatorsDefine=(s=e.internalProps.indicators)!==null&&s!==void 0?s:[],this.indicatorTitle=e.options.indicatorTitle,this.indicatorsAsCol=(l=e.options.indicatorsAsCol)===null||l===void 0||l,this.hideIndicatorName=(d=e.options.hideIndicatorName)!==null&&d!==void 0&&d,this.showRowHeader=(a=e.options.showRowHeader)===null||a===void 0||a,this.showColumnHeader=(u=e.options.showColumnHeader)===null||u===void 0||u,this.rowHeaderTitle=e.options.rowHeaderTitle,this.columnHeaderTitle=e.options.columnHeaderTitle,this.rowHierarchyType=(c=e.options.rowHierarchyType)!==null&&c!==void 0?c:"grid",this.rowExpandLevel=(h=e.options.rowExpandLevel)!==null&&h!==void 0?h:1,this.rowHierarchyIndent=(v=e.options.rowHierarchyIndent)!==null&&v!==void 0?v:20,this.rowHierarchyTextStartAlignment=e.options.rowHierarchyTextStartAlignment,this.cornerSetting=Object.assign({titleOnDimension:"column",forceShowHeader:!1},e.options.corner),t&&(this.rowTree=t.rowHeaderTree,this.columnTree=t.colHeaderTree),(g=this.indicatorsDefine)===null||g===void 0||g.forEach(y=>{typeof y=="string"?this.indicatorKeys.push(y):this.indicatorKeys.push(y.indicatorKey)}),this.columnDimensionTree=i,this.rowDimensionTree=o,this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this.resetRowHeaderLevelCount(),this._table.isPivotChart()&&(this.hasTwoIndicatorAxes=this.indicatorsDefine.some(y=>{var T,_;if(y.chartSpec&&y.chartSpec.series&&y.chartSpec.series.length>1){const b=(_=(T=y.chartSpec.axes)!==null&&T!==void 0?T:this._table.pivotChartAxes)!==null&&_!==void 0?_:[];if(!b.length||b.every(K=>K.orient!==(this.indicatorsAsCol?"top":"right")||K.visible!==!1))return!0}return!1})),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=ct(this._rowHeaderCellFullPathIds_FULL),e.options.rowHierarchyType==="tree"&&((f=this.extensionRows)===null||f===void 0?void 0:f.length)>=1&&(this.generateExtensionRowTree(),this.extensionRows.forEach(y=>{const T=[];y.rows.forEach(_=>{typeof _=="string"?T.push(_):T.push(_.dimensionKey)}),this._extensionRowDimensionKeys.push(T),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(T)})),this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let p,I=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr();!this.dataset||this._table.isPivotChart()||((w=(C=this.dataset.records)===null||C===void 0?void 0:C.length)!==null&&w!==void 0?w:0)!==0||this.dataset.customColTree||(I=this.columnsDefine.map(y=>typeof y=="string"?y:y.dimensionKey),this.indicatorsAsCol&&I.push(this.indicatorDimensionKey)),I=this.columnHeaderTitle?[""].concat(I):I;let P=[];if(this.rowHierarchyType==="tree"&&((S=this.extensionRows)===null||S===void 0?void 0:S.length)>=1){const y=[];y.push(this.rowDimensionKeys[0]),this._extensionRowDimensionKeys.forEach(T=>{y.push(T[0])}),P=this.extensionRows.reduce((T,_)=>T.concat(_.rows),[]),p=this.rowHeaderTitle?[""].concat(y):y}else p=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),!this.dataset||this._table.isPivotChart()||((m=(H=this.dataset.records)===null||H===void 0?void 0:H.length)!==null&&m!==void 0?m:0)!==0||this.dataset.customRowTree||(p=this.rowsDefine.map(y=>typeof y=="string"?y:y.dimensionKey),this.indicatorsAsCol||p.push(this.indicatorDimensionKey)),p=this.rowHeaderTitle?[""].concat(p):p;this.cornerHeaderObjs=this._addCornerHeaders(I,p,this.columnsDefine.concat(...this.rowsDefine,...P)),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((y,T)=>(y[T.id]=T,y),{}),this.indicatorsAsCol&&!this.hideIndicatorName?this._indicatorShowType="column":this.indicatorsAsCol||this.hideIndicatorName?this._indicatorShowType="none":this._indicatorShowType="row",this.generateCellIdsConsiderHideHeader(),this.setPagination(e.options.pagination),this._table.isPivotChart()&&(this._chartItemSpanSize=0,this._chartItemBandSize=0,this._indicators.find(y=>{var T,_,b,K,j,G,X,Z;!((T=y==null?void 0:y.style)===null||T===void 0)&&T.padding&&(this._chartPadding=y.style.padding),!((_=y.chartSpec)===null||_===void 0)&&_.barWidth&&typeof y.chartSpec.barWidth=="number"&&(this._chartItemSpanSize=(b=y.chartSpec)===null||b===void 0?void 0:b.barWidth);const W=(j=(K=y.chartSpec)===null||K===void 0?void 0:K.axes)===null||j===void 0?void 0:j.find($=>$.type==="band");return W!=null&&W.bandSize&&(this._chartItemBandSize=W==null?void 0:W.bandSize,this._chartPaddingInner=(G=Oe(W.paddingInner)?W.paddingInner[0]:W.paddingInner)!==null&&G!==void 0?G:0,this._chartPaddingOuter=(X=Oe(W.paddingOuter)?W.paddingOuter[0]:W.paddingOuter)!==null&&X!==void 0?X:0),this._chartItemSpanSize>0||((Z=y.chartSpec.series)===null||Z===void 0||Z.find($=>($.barWidth&&typeof $.barWidth=="number"&&(this._chartItemSpanSize=$.barWidth),this._chartItemSpanSize>0)),!1)})),this.handleRowSeriesNumber(e.internalProps.rowSeriesNumber),this.setColumnWidths()}handleRowSeriesNumber(e){var t,i;e&&(Array.isArray(e)?this.rowSeriesNumberColumn=e.map(o=>{var r,n;return{id:"",title:o.title,define:o,cellType:(r=o.cellType)!==null&&r!==void 0?r:"text",headerType:(n=o.cellType)!==null&&n!==void 0?n:"text",width:o.width,style:o.style,format:o.format,field:o.field,icon:o.icon}}):this.rowSeriesNumberColumn=[{id:"",title:e.title,define:e,cellType:(t=e.cellType)!==null&&t!==void 0?t:"text",headerType:(i=e.cellType)!==null&&i!==void 0?i:"text",style:e.style,width:e.width,format:e.format,field:"",icon:e.icon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(o=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(o=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}_generateColHeaderIds(){var e,t,i,o,r,n,s,l;if(((e=this.columnDimensionTree.tree.children)===null||e===void 0?void 0:e.length)>=1){let d=0;if(this.dataset&&!this._table.isPivotChart()&&((i=(t=this.dataset.records)===null||t===void 0?void 0:t.length)!==null&&i!==void 0?i:0)===0&&!this.dataset.customColTree&&!this.dataset.customRowTree&&this.indicatorsAsCol&&this.columnDimensionTree.totalLevel<this.columnHeaderLevelCount){d=this.columnHeaderLevelCount-this.columnDimensionTree.totalLevel;for(let a=0;a<d;a++)this._columnHeaderCellFullPathIds.unshift([])}this._addHeaders(this._columnHeaderCellFullPathIds,d,this.columnDimensionTree.tree.children,[],this.columnHeaderObjs)}if(this.columnHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);const d=++this.sharedVar.seqId,a=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(d);this._columnHeaderCellFullPathIds.unshift(a);const u={id:d,title:typeof this.columnHeaderTitle.title=="string"?this.columnHeaderTitle.title:this.columnsDefine.reduce((c,h)=>typeof h=="string"?c:c+(c?`/${h.title}`:`${h.title}`),""),field:void 0,headerType:(r=(o=this.columnHeaderTitle)===null||o===void 0?void 0:o.headerType)!==null&&r!==void 0?r:"text",style:(n=this.columnHeaderTitle)===null||n===void 0?void 0:n.headerStyle,define:{id:d,disableHeaderHover:!!(!((s=this.columnHeaderTitle)===null||s===void 0)&&s.disableHeaderHover),disableHeaderSelect:!!(!((l=this.columnHeaderTitle)===null||l===void 0)&&l.disableHeaderSelect)}};this.columnHeaderObjs.push(u),this._headerObjects[d]=u}}_generateRowHeaderIds(){var e,t,i,o,r,n,s,l,d,a;if(((e=this.rowDimensionTree.tree.children)===null||e===void 0?void 0:e.length)>=1)if(this.rowHierarchyType==="tree")this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs);else{let u=0;if(this.dataset&&!this._table.isPivotChart()&&((i=(t=this.dataset.records)===null||t===void 0?void 0:t.length)!==null&&i!==void 0?i:0)===0&&!this.dataset.customColTree&&!this.dataset.customRowTree&&!this.indicatorsAsCol&&this.rowDimensionTree.totalLevel<this.rowHeaderLevelCount){u=this.rowHeaderLevelCount-this.rowDimensionTree.totalLevel;for(let c=0;c<u;c++)this._rowHeaderCellFullPathIds_FULL.unshift([])}this._addHeaders(this._rowHeaderCellFullPathIds_FULL,u,this.rowDimensionTree.tree.children,[],this.rowHeaderObjs)}if(this.rowHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);const u=++this.sharedVar.seqId,c=Array((r=(o=this._rowHeaderCellFullPathIds_FULL[0])===null||o===void 0?void 0:o.length)!==null&&r!==void 0?r:this.rowDimensionTree.tree.size).fill(u);this._rowHeaderCellFullPathIds_FULL.unshift(c);const h={id:u,title:typeof this.rowHeaderTitle.title=="string"?this.rowHeaderTitle.title:this.rowsDefine.reduce((v,g)=>typeof g=="string"?v:v+(v?`/${g.title}`:`${g.title}`),""),field:void 0,headerType:(s=(n=this.rowHeaderTitle)===null||n===void 0?void 0:n.headerType)!==null&&s!==void 0?s:"text",style:(l=this.rowHeaderTitle)===null||l===void 0?void 0:l.headerStyle,define:{id:u,disableHeaderHover:!!(!((d=this.rowHeaderTitle)===null||d===void 0)&&d.disableHeaderHover),disableHeaderSelect:!!(!((a=this.rowHeaderTitle)===null||a===void 0)&&a.disableHeaderSelect)}};this.rowHeaderObjs.push(h),this._headerObjects[u]=h}}_addHeaders(e,t,i,o,r){const n=this;e[t]||function(s){const l=e[s]=[];if(n.colIndex===0)return l;const d=e[s-1];for(let a=0;a<(d==null?void 0:d.length);a++)l[a]=d[a]}(t);for(let s=0;s<i.length;s++){const l=i[s];wi(l,e,r,o,t,this)}}_addHeadersForTreeMode(e,t,i,o,r,n,s,l){const d=this;e[t]||function(a){const u=e[a]=[];if(d.colIndex===0)return u;const c=e[a-1];for(let h=0;h<(c==null?void 0:c.length);h++)u[h]=c[h]}(t);for(let a=0;a<i.length;a++){const u=i[a];Hi(u,e,l,o,t,r,n,s,this)}}_addCornerHeaders(e,t,i){var o,r;const n=[];if(this.cornerSetting.titleOnDimension==="all")if(this.indicatorsAsCol){let s=-1;e&&e.forEach((l,d)=>{var a,u;l===this.indicatorDimensionKey&&(s=d);const c=++this.sharedVar.seqId,h=i.find(g=>typeof g!="string"&&g.dimensionKey===l),v={id:c,title:l===this.indicatorDimensionKey?this.indicatorTitle:h?h.title:l==="axis"?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:h==null?void 0:h.showSortInCorner,sort:h==null?void 0:h.sort,define:{showSort:h==null?void 0:h.showSortInCorner,sort:h==null?void 0:h.sort,dimensionKey:l,id:c,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:h==null?void 0:h.cornerDropDownMenu,headerIcon:h==null?void 0:h.cornerHeaderIcon,pivotInfo:{value:(u=h==null?void 0:h.title)!==null&&u!==void 0?u:"",dimensionKey:l,isPivotCorner:!0},description:h==null?void 0:h.cornerDescription};n[c]=v,this._headerObjects[c]=v,this._cornerHeaderCellFullPathIds[d]||(this._cornerHeaderCellFullPathIds[d]=[]);for(let g=0;g<this.rowHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[d][g]=c}),t&&t.forEach((l,d)=>{var a,u;const c=++this.sharedVar.seqId,h=i.find(g=>typeof g!="string"&&g.dimensionKey===l),v={id:c,title:l===this.indicatorDimensionKey?this.indicatorTitle:h?h.title:l==="axis"?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:h==null?void 0:h.showSortInCorner,sort:h==null?void 0:h.sort,define:{showSort:h==null?void 0:h.showSortInCorner,sort:h==null?void 0:h.sort,dimensionKey:l,id:c,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:h==null?void 0:h.cornerDropDownMenu,headerIcon:h==null?void 0:h.cornerHeaderIcon,pivotInfo:{value:(u=h==null?void 0:h.title)!==null&&u!==void 0?u:"",dimensionKey:l,isPivotCorner:!0},description:h==null?void 0:h.cornerDescription};n[c]=v,this._headerObjects[c]=v,this._cornerHeaderCellFullPathIds[s]||(this._cornerHeaderCellFullPathIds[s]=[]),this._cornerHeaderCellFullPathIds[s][d]=c})}else{let s=-1;t&&t.forEach((l,d)=>{var a,u;l===this.indicatorDimensionKey&&(s=d);const c=++this.sharedVar.seqId,h=i.find(g=>typeof g!="string"&&g.dimensionKey===l),v={id:c,title:l===this.indicatorDimensionKey?this.indicatorTitle:h?h.title:l==="axis"?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:h==null?void 0:h.showSortInCorner,sort:h==null?void 0:h.sort,define:{showSort:h==null?void 0:h.showSortInCorner,sort:h==null?void 0:h.sort,dimensionKey:l,id:c,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:h==null?void 0:h.cornerDropDownMenu,headerIcon:h==null?void 0:h.cornerHeaderIcon,pivotInfo:{value:(u=h==null?void 0:h.title)!==null&&u!==void 0?u:"",dimensionKey:l,isPivotCorner:!0},description:h==null?void 0:h.cornerDescription};n[c]=v,this._headerObjects[c]=v;for(let g=0;g<this.columnHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[g]||(this._cornerHeaderCellFullPathIds[g]=[]),this._cornerHeaderCellFullPathIds[g][d]=c}),e&&e.forEach((l,d)=>{var a,u;const c=++this.sharedVar.seqId,h=i.find(g=>typeof g!="string"&&g.dimensionKey===l),v={id:c,title:l===this.indicatorDimensionKey?this.indicatorTitle:h?h.title:l==="axis"?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:h==null?void 0:h.showSortInCorner,sort:h==null?void 0:h.sort,define:{showSort:h==null?void 0:h.showSortInCorner,sort:h==null?void 0:h.sort,dimensionKey:l,id:c,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:h==null?void 0:h.cornerDropDownMenu,headerIcon:h==null?void 0:h.cornerHeaderIcon,pivotInfo:{value:(u=h==null?void 0:h.title)!==null&&u!==void 0?u:"",dimensionKey:l,isPivotCorner:!0},description:h==null?void 0:h.cornerDescription};n[c]=v,this._headerObjects[c]=v,this._cornerHeaderCellFullPathIds[d][s]=c})}else if(this.cornerSetting.titleOnDimension==="row"||this.cornerSetting.titleOnDimension==="column"){const s=((o=this.cornerSetting)===null||o===void 0?void 0:o.titleOnDimension)==="row"?t:e;s&&s.forEach((l,d)=>{var a,u;const c=++this.sharedVar.seqId,h=i.find(g=>typeof g!="string"&&g.dimensionKey===l),v={id:c,title:l===this.indicatorDimensionKey?this.indicatorTitle:h?h.title:l==="axis"?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:h==null?void 0:h.showSortInCorner,sort:h==null?void 0:h.sort,define:{showSort:h==null?void 0:h.showSortInCorner,sort:h==null?void 0:h.sort,dimensionKey:l,id:c,value:l,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:h==null?void 0:h.cornerDropDownMenu,headerIcon:h==null?void 0:h.cornerHeaderIcon,pivotInfo:{value:(u=h==null?void 0:h.title)!==null&&u!==void 0?u:"",dimensionKey:l,isPivotCorner:!0},description:h==null?void 0:h.cornerDescription};if(n[c]=v,this._headerObjects[c]=v,this.cornerSetting.titleOnDimension==="column"){this._cornerHeaderCellFullPathIds[d]||(this._cornerHeaderCellFullPathIds[d]=[]);for(let g=0;g<this.rowHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[d][g]=c}else if(this.cornerSetting.titleOnDimension==="row")for(let g=0;g<this.columnHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[g]||(this._cornerHeaderCellFullPathIds[g]=[]),this._cornerHeaderCellFullPathIds[g][d]=c})}else{const s=++this.sharedVar.seqId,l={id:s,title:"",field:"维度名称",style:this.cornerSetting.headerStyle,headerType:(r=this.cornerSetting.headerType)!==null&&r!==void 0?r:"text",define:{dimensionKey:"维度名称",id:s,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect}};n[s]=l,this._headerObjects[s]=l;for(let d=0;d<this.columnHeaderLevelCount;d++)for(let a=0;a<this.rowHeaderLevelCount;a++)this._cornerHeaderCellFullPathIds[d]||(this._cornerHeaderCellFullPathIds[d]=[]),this._cornerHeaderCellFullPathIds[d][a]=s}return n}generateExtensionRowTree(){this.extensionRows.forEach((e,t)=>{const i=this._rowHeaderCellFullPathIds_FULL;this._rowHeaderCellFullPathIds_FULL=[],i.forEach((o,r)=>{const n=o[o.length-1];let s,l;if(this.colIndex=0,typeof e.rowTree=="function"){const a=this.findFullCellIds(o);s=e.rowTree(a.map(u=>({dimensionKey:this._headerObjects[u].field,value:this._headerObjects[u].title})))}else s=ge(e.rowTree);this._rowHeaderExtensionTree[n]?(this._rowHeaderExtensionTree[n].reset(this._rowHeaderExtensionTree[n].tree.children,!0),l=this._rowHeaderExtensionTree[n]):(l=new ce(s??[],this.sharedVar,this.rowHierarchyType,void 0),this._rowHeaderExtensionTree[n]=l);const d=[];this._addHeadersForTreeMode(d,0,l.tree.children,[],l.totalLevel,!0,e.rows,this.rowHeaderObjs);for(let a=0;a<d[0].length;a++)this._rowHeaderCellFullPathIds_FULL.push(o.concat(d[0][a]))})})}setColumnWidths(){var e,t,i;const o=new Array(this.colCount).fill(void 0);if(this.leftRowSeriesNumberColumnCount&&(o[0]=this.leftRowSeriesNumberColumn[0]),this.showHeader&&this.showRowHeader)if(this.rowHeaderTitle&&(o[0+this.leftRowSeriesNumberColumnCount]={}),this.rowHierarchyType==="tree"){const r=this.rowDimensionKeys[0];if(r){const n=(e=this.rowsDefine)===null||e===void 0?void 0:e.find(s=>typeof s!="string"&&s.dimensionKey===r);n&&(o[0+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:n.width,minWidth:n.minWidth,maxWidth:n.maxWidth})}(t=this._extensionRowDimensionKeys)===null||t===void 0||t.forEach((n,s)=>{var l;const d=n[0];if(d){const a=(l=this.extensionRows[s].rows)===null||l===void 0?void 0:l.find(u=>typeof u!="string"&&u.dimensionKey===d);a&&(o[s+1+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:a.width,minWidth:a.minWidth,maxWidth:a.maxWidth})}})}else(this.rowDimensionTree.totalLevel>0?this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr():this.rowsDefine.map(r=>typeof r=="string"?r:r.dimensionKey)).forEach((r,n)=>{var s;const l=(s=this.rowsDefine)===null||s===void 0?void 0:s.find(d=>typeof d!="string"&&d.dimensionKey===r);l&&(o[n+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:l.width,minWidth:l.minWidth,maxWidth:l.maxWidth})});if(this.indicatorsAsCol)for(let r=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;r<this.colCount;r++){const n=this.getBody(r,this.columnHeaderLevelCount);o[r]={width:n==null?void 0:n.width,minWidth:n==null?void 0:n.minWidth,maxWidth:n==null?void 0:n.maxWidth}}else{let r,n,s,l=0;(i=this._indicators)===null||i===void 0||i.forEach((d,a)=>{var u,c;typeof d.width=="number"?l=Math.max(d.width,l):d.width==="auto"&&(s=!0),typeof d.minWidth=="number"&&(n=Math.max(d.minWidth,(u=n)!==null&&u!==void 0?u:0)),typeof d.maxWidth=="number"&&(r=Math.min(d.maxWidth,(c=r)!==null&&c!==void 0?c:Number.MAX_VALUE))}),l=l>0?l:s?"auto":void 0,o.fill({width:l,minWidth:n,maxWidth:r},this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount,this.colCount-this.rightFrozenColCount)}this._columnWidths=o}get columnWidths(){return this._columnWidths}getColumnWidthDefined(e){return this._columnWidths[e]}get showHeader(){return this._showHeader}set showHeader(e){this._showHeader=e}get showColumnHeader(){return this._showColumnHeader}set showColumnHeader(e){this._showColumnHeader=e}get showRowHeader(){return this._showRowHeader}set showRowHeader(e){this._showRowHeader=e}get columnHeaderTitle(){return this._columnHeaderTitle}set columnHeaderTitle(e){this._columnHeaderTitle=e}get rowHeaderTitle(){return this._rowHeaderTitle}set rowHeaderTitle(e){this._rowHeaderTitle=e}getHeaderFieldKey(e,t){}getCellLocation(e,t){return this.isCornerHeader(e,t)?"cornerHeader":this.isColumnHeader(e,t)?"columnHeader":this.isRowHeader(e,t)?"rowHeader":"body"}isHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||t>=0&&t<this.columnHeaderLevelCount||e>=this.colCount-this.rightHeaderColCount||t>=this.rowCount-this.bottomHeaderRowCount}isCornerHeader(e,t){return e>=0&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=0&&t<this.columnHeaderLevelCount}isColumnHeader(e,t){return e>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=0&&t<this.columnHeaderLevelCount}isRowHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=this.columnHeaderLevelCount}isFrozen(e,t){return this.isFrozenColumn(e)||this.isRightFrozenColumn(e)||this.isBottomFrozenRow(t)||this.isFrozenRow(t)||this.isSeriesNumberInBody(e,t)||this.isSeriesNumberInHeader(e,t)}isFrozenColumn(e,t){if(M(t)){if(e>=0&&e<this.frozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&e>=0&&e<this.frozenColCount)return!0;return!1}isRightFrozenColumn(e,t){if(M(t)){if(e>=this.colCount-this.rightFrozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&e>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(e,t){if(M(t)){if(t>=0&&t<this.frozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.frozenRowCount>0&&t>=0&&t<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(e,t){if(M(t)){if(t>=this.rowCount-this.bottomFrozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.bottomFrozenRowCount>0&&t>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftBottomCorner(e,t){return e>=0&&e<this.rowHeaderLevelCount&&t>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=0&&t<this.columnHeaderLevelCount}isRightBottomCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}getColumnHeaderRange(){return{start:{col:this.rowHeaderLevelCount,row:0},end:{col:this.colCount-1,row:this.columnHeaderLevelCount-1}}}getRowHeaderRange(){return{start:{col:0,row:this.columnHeaderLevelCount},end:{col:this.rowHeaderLevelCount-1,row:this.rowCount-1}}}getCornerHeaderRange(){return{start:{col:0,row:0},end:{col:this.rowHeaderLevelCount-1,row:this.columnHeaderLevelCount-1}}}getBodyRange(){return{start:{col:this.rowHeaderLevelCount,row:this.columnHeaderLevelCount},end:{col:this.colCount-1,row:this.rowCount-1}}}resetCellIds(){}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get headerLevelCount(){return this.columnHeaderLevelCount}resetColumnHeaderLevelCount(){var e,t,i,o,r,n,s,l,d,a,u;if(this.showHeader&&this.showColumnHeader){if(this._table.isPivotChart()&&this.indicatorsAsCol&&!(!((t=(e=this.dataset)===null||e===void 0?void 0:e.colKeys)===null||t===void 0)&&t.length)&&((o=(i=this.columnDimensionTree)===null||i===void 0?void 0:i.tree)===null||o===void 0?void 0:o.level)===0&&!this.hasTwoIndicatorAxes)return void(this.columnHeaderLevelCount=0);let c=this.indicatorsAsCol&&this.hideIndicatorName&&this.colDimensionKeys[this.colDimensionKeys.length-1]===this.indicatorDimensionKey?this.columnDimensionTree.totalLevel-1:this.columnDimensionTree.totalLevel;return c===0&&this.dataset&&!(!((r=this.dataset.customColTree)===null||r===void 0)&&r.length)?this.cornerSetting.titleOnDimension==="row"&&this.cornerSetting.forceShowHeader?c=1:this._table.isPivotChart()||((s=(n=this.dataset.records)===null||n===void 0?void 0:n.length)!==null&&s!==void 0?s:0)!==0||this.cornerSetting.titleOnDimension!=="column"&&this.cornerSetting.titleOnDimension!=="all"||(c=(l=this.columnsDefine.length)!==null&&l!==void 0?l:0):!this.dataset||this._table.isPivotChart()||((a=(d=this.dataset.records)===null||d===void 0?void 0:d.length)!==null&&a!==void 0?a:0)!==0||this.dataset.customColTree||this.cornerSetting.titleOnDimension!=="column"&&this.cornerSetting.titleOnDimension!=="all"||(c=(u=this.columnsDefine.length)!==null&&u!==void 0?u:0,!this.hideIndicatorName&&this.indicatorsAsCol&&c++),this.columnHeaderTitle&&(c+=1),this._table.isPivotChart()&&this.indicatorsAsCol&&!this.hasTwoIndicatorAxes&&it(this.indicatorsDefine)&&(c-=1),void(this.columnHeaderLevelCount=c)}this.columnHeaderLevelCount=this.indicatorsAsCol?this.hideIndicatorName?0:1:0}resetRowHeaderLevelCount(){var e,t,i,o,r,n,s,l;if(this.showHeader&&this.showRowHeader){if(this.rowHierarchyType==="tree"){const u=(t=(e=this.extensionRows)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0;return this.rowHeaderTitle?void(this.rowHeaderLevelCount=2+u):void(this.rowHeaderLevelCount=1+u)}const d=this.rowDimensionTree.totalLevel;let a=d;return a===0&&this.dataset&&!(!((i=this.dataset.customRowTree)===null||i===void 0)&&i.length)?this.cornerSetting.titleOnDimension==="column"&&this.cornerSetting.forceShowHeader?a=1:this._table.isPivotChart()||((r=(o=this.dataset.records)===null||o===void 0?void 0:o.length)!==null&&r!==void 0?r:0)!==0||this.cornerSetting.titleOnDimension!=="row"&&this.cornerSetting.titleOnDimension!=="all"||(a=(n=this.rowsDefine.length)!==null&&n!==void 0?n:0):!this.dataset||this._table.isPivotChart()||((l=(s=this.dataset.records)===null||s===void 0?void 0:s.length)!==null&&l!==void 0?l:0)!==0||this.dataset.customRowTree||this.cornerSetting.titleOnDimension!=="row"&&this.cornerSetting.titleOnDimension!=="all"||(a=this.rowsDefine.length,this.hideIndicatorName||this.indicatorsAsCol||a++),!this.indicatorsAsCol&&this.hideIndicatorName&&this.rowDimensionKeys[this.rowDimensionKeys.length-1]===this.indicatorDimensionKey&&(a=d-1),this.rowHeaderTitle&&(a+=1),void(this.rowHeaderLevelCount=a)}this.rowHeaderLevelCount=this.indicatorsAsCol||this.hideIndicatorName?0:1}get columnHeaderLevelCount(){return this._columnHeaderLevelCount}set columnHeaderLevelCount(e){this._columnHeaderLevelCount=e}get rowHeaderLevelCount(){return this._rowHeaderLevelCount}set rowHeaderLevelCount(e){this._rowHeaderLevelCount=e}get colCount(){var e;return(this.columnDimensionTree.totalLevel>0||this._table.isPivotChart()||((e=this.dataset.records)===null||e===void 0?void 0:e.length)>0||this.dataset.records&&!Array.isArray(this.dataset.records)?this.columnDimensionTree.tree.size:0)+this.rowHeaderLevelCount+this.rightHeaderColCount+this.leftRowSeriesNumberColumnCount}get rowCount(){var e,t,i,o;return((this._table.records||this.dataset.records)&&(!Array.isArray(this._table.records)||this._table.records.length>0)&&((e=this._indicators)===null||e===void 0?void 0:e.length)>0&&!(!((t=this._rowHeaderCellIds)===null||t===void 0)&&t.length)?1:(o=(i=this._rowHeaderCellIds)===null||i===void 0?void 0:i.length)!==null&&o!==void 0?o:0)+this.columnHeaderLevelCount+this.bottomHeaderRowCount}get bodyRowSpanCount(){return this.rowDimensionTree.tree.size}get bottomFrozenRowCount(){if(!this._table.isPivotChart())return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0;if(this.indicatorKeys.length>=1&&it(this.indicatorsDefine)){const e=this._table.pivotChartAxes.find(t=>t.orient==="bottom");return(e==null?void 0:e.visible)===!1?0:(this.indicatorsAsCol,1)}return 0}get rightFrozenColCount(){if(!this._table.isPivotChart())return this._table.internalProps.rightFrozenColCount?this.colCount-this.rowHeaderLevelCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:this.colCount-this.rowHeaderLevelCount:0;const e=this._table.pivotChartAxes.find(t=>t.orient==="right");return(e==null?void 0:e.visible)===!1||this.indicatorsAsCol?0:this.hasTwoIndicatorAxes?1:0}get bodyRowCount(){return this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount}get headerObjects(){return this._headerObjects}get columnObjects(){return this._indicators}getCellId(e,t){var i,o,r,n,s;if(t>=0&&e>=0){if(this.isSeriesNumber(e,t))return"";if(this.isCornerHeader(e,t))return(i=this._cornerHeaderCellIds[t])===null||i===void 0?void 0:i[e-this.leftRowSeriesNumberColumnCount];if(this.isColumnHeader(e,t))return(o=this._columnHeaderCellIds[t])===null||o===void 0?void 0:o[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount];if(this.isRowHeader(e,t))return(r=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])===null||r===void 0?void 0:r[e-this.leftRowSeriesNumberColumnCount];if(this.isRightFrozenColumn(e,t))return(n=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])===null||n===void 0?void 0:n[this.rowHeaderLevelCount-1];if(this.isBottomFrozenRow(e,t))return(s=this._columnHeaderCellIds[this.columnHeaderLevelCount-1])===null||s===void 0?void 0:s[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount]}}getHeader(e,t){var i;if(this.isSeriesNumberInHeader(e,t))return this.getSeriesNumberHeader(e,t);const o=this.getCellId(e,t);return(i=this._headerObjectMap[o])!==null&&i!==void 0?i:{id:void 0,field:"",headerType:"text",define:void 0}}getHeaderField(e,t){var i,o;const r=this.getCellId(e,t);return((i=this._headerObjectMap[r])===null||i===void 0?void 0:i.field)||((o=this.getBody(e,t))===null||o===void 0?void 0:o.field)}getHeaderCellAdressById(e){for(let t=0;t<this._columnHeaderCellIds.length;t++){const i=this._columnHeaderCellIds[t];for(let o=0;o<i.length;o++)if(i[o]===e)return{col:o+this._table.frozenColCount,row:t}}for(let t=0;t<this._rowHeaderCellIds.length;t++){const i=this._rowHeaderCellIds[t];for(let o=0;o<i.length;o++)if(i[o]===e)return{col:o,row:t+this._table.frozenRowCount}}for(let t=0;t<this._cornerHeaderCellIds.length;t++){const i=this._cornerHeaderCellIds[t];for(let o=0;o<i.length;o++)if(i[o]===e)return{col:o,row:t}}}getHeaderCellAddressByField(e){const t=this.headerObjects.find(i=>i&&i.field===e);return t&&this.getHeaderCellAdressById(t.id)}getBody(e,t){var i,o,r,n,s,l,d,a,u,c;const h=this.getBodyWidthCache(e,t);if(h)return h;if(this.isSeriesNumber(e,t)){const C=this.getSeriesNumberBody(e,t);return this.setBodyWidthCache(e,t,C),C}const v=this.getCellHeaderPaths(e,t);if(this.indicatorsAsCol){const C=(o=(i=v.colHeaderPaths)===null||i===void 0?void 0:i.find(S=>S.indicatorKey))===null||o===void 0?void 0:o.indicatorKey,w=M(C)&&(s=(n=(r=this._indicators)===null||r===void 0?void 0:r.find(S=>S.indicatorKey===C))!==null&&n!==void 0?n:this._indicators[0])!==null&&s!==void 0?s:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(e,t,w),w}const g=(d=(l=v.rowHeaderPaths)===null||l===void 0?void 0:l.find(C=>C.indicatorKey))===null||d===void 0?void 0:d.indicatorKey,f=M(g)&&(c=(u=(a=this._indicators)===null||a===void 0?void 0:a.find(C=>C.indicatorKey===g))!==null&&u!==void 0?u:this._indicators[0])!==null&&c!==void 0?c:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(e,t,f),f}getCellRange(e,t){var i,o;const r={start:{col:e,row:t},end:{col:e,row:t}};if(!this.isHeader(e,t)||e===-1||t===-1||this.isRightFrozenColumn(e,t)||this.isBottomFrozenRow(e,t))return r;if(this._table.isPivotChart()){if(this.isLeftBottomCorner(e,t))return{start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.frozenColCount-1,row:this.rowCount-1}};if(this.isRightTopCorner(e,t))return{start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}};if(this.isRightBottomCorner(e,t))return{start:{col:this.colCount-this.rightFrozenColCount,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}}}for(let n=0;n<this._largeCellRangeCache.length;n++){const s=this._largeCellRangeCache[n];if(e>=s.start.col&&e<=s.end.col&&t>=s.start.row&&t<=s.end.row)return s}if(this.isHeader(e,t)&&e!==-1&&t!==-1){const n=this.getCellId(e,t);for(let s=e-1;s>=0&&n===this.getCellId(s,t);s--)r.start.col=s;for(let s=e+1;s<((i=this.colCount)!==null&&i!==void 0?i:0)&&n===this.getCellId(s,t);s++)r.end.col=s;for(let s=t-1;s>=0&&n===this.getCellId(e,s);s--)r.start.row=s;for(let s=t+1;s<((o=this.rowCount)!==null&&o!==void 0?o:0)&&!(n!==this.getCellId(e,s)||this.isSeriesNumberInHeader(e,t)&&s>=this.columnHeaderLevelCount);s++)r.end.row=s}return(r.end.col-r.start.col>100||r.end.row-r.start.row>100)&&this._largeCellRangeCache.push(r),r}isCellRangeEqual(e,t,i,o){const r=this.getCellRange(e,t),n=this.getCellRange(i,o);return r.start.col===n.start.col&&r.end.col===n.end.col&&r.start.row===n.start.row&&r.end.row===n.end.row}getBodyIndexByRow(e){return e<this.columnHeaderLevelCount||e>=this.rowCount-this.bottomHeaderRowCount?-1:e-this.columnHeaderLevelCount}get bottomHeaderRowCount(){return this._table.isPivotChart()?this.bottomFrozenRowCount:0}get rightHeaderColCount(){return this._table.isPivotChart()?this.rightFrozenColCount:0}getBodyIndexByCol(e){return e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||e>=this.colCount-this.rightHeaderColCount?-1:e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount}getRecordStartRowByRecordIndex(e){return this.columnHeaderLevelCount+e}getRecordShowIndexByCell(e,t){}getCellHeaderPathsWithTreeNode(e,t){for(let s=0;s<this._largeCellRangeCache.length;s++){const l=this._largeCellRangeCache[s];if(e>=l.start.col&&e<=l.end.col&&t>=l.start.row&&t<=l.end.row)break}let i=this.getColHeaderPathCache(e,t),o=this.getRowHeaderPathCache(e,t);const r=this.getBodyIndexByCol(e),n=this.getBodyIndexByRow(t)+this.currentPageStartIndex;if(!i&&t>=0&&r>=0&&(i=this.columnDimensionTree.getTreePath(r,this.showHeader&&this.showColumnHeader?t-(this.columnHeaderTitle?1:0):this.columnDimensionTree.totalLevel),this.setColHeaderPathCache(e,t,i)),!o&&e>=0&&n>=0){if(o=[],this.rowHierarchyType==="tree"){const s=this._rowHeaderCellFullPathIds[n];let l=this.rowDimensionTree,d=0;for(;l;){const a=[];let u=s[d];for(a.push(u);;){const h=this._headerObjectMap[u];if(!(h!=null&&h.parentCellId))break;a.unshift(h.parentCellId),u=h.parentCellId}const c=l.getTreePathByCellIds(a);o.push(...c),l=this._rowHeaderExtensionTree[s[d]],d++}}else o=this.rowDimensionTree.getTreePath(n,this.showHeader&&this.showRowHeader?e-(this.rowHeaderTitle?1:0)-this.leftRowSeriesNumberColumnCount:this.rowDimensionTree.totalLevel);this.setRowHeaderPathCache(e,t,o)}return{colHeaderPaths:i,rowHeaderPaths:o,cellLocation:this.getCellLocation(e,t)}}getCellHeaderPaths(e,t){var i,o;const r=this.getCellHeaderPathsWithTreeNode(e,t),n={colHeaderPaths:[],rowHeaderPaths:[],cellLocation:r.cellLocation};return(i=r.colHeaderPaths)===null||i===void 0||i.forEach(s=>{var l,d,a;const u={};u.dimensionKey=s.dimensionKey,u.indicatorKey=s.indicatorKey,u.value=(a=(l=s.value)!==null&&l!==void 0?l:(d=this.getIndicatorInfoByIndicatorKey(s.indicatorKey))===null||d===void 0?void 0:d.title)!==null&&a!==void 0?a:"",u.virtual=s.virtual,n.colHeaderPaths.push(u)}),(o=r.rowHeaderPaths)===null||o===void 0||o.forEach(s=>{var l,d,a;if(s.dimensionKey!=="axis"){const u={};u.dimensionKey=s.dimensionKey,u.indicatorKey=s.indicatorKey,u.value=(a=(l=s.value)!==null&&l!==void 0?l:(d=this.getIndicatorInfoByIndicatorKey(s.indicatorKey))===null||d===void 0?void 0:d.title)!==null&&a!==void 0?a:"",u.virtual=s.virtual,n.rowHeaderPaths.push(u)}}),n}getIndicatorInfoByIndicatorKey(e){var t;return(t=this.indicatorsDefine)===null||t===void 0?void 0:t.find(i=>typeof i!="string"&&!!e&&i.indicatorKey===e)}findFullCellIds(e){const t=[];for(let i=0;i<e.length;i++){let o=e[i];for(t.push(o);;){const r=this._headerObjectMap[o];if(!(r!=null&&r.parentCellId))break;t.unshift(r.parentCellId),o=r.parentCellId}}return t}getHeaderDimension(e,t){var i,o,r;if(this.isHeader(e,t)){const n=this.getHeader(e,t);return(o=(i=this.rowsDefine)===null||i===void 0?void 0:i.find(s=>typeof s!="string"&&s.dimensionKey===n.field))!==null&&o!==void 0?o:(r=this.columnsDefine)===null||r===void 0?void 0:r.find(s=>typeof s!="string"&&s.dimensionKey===n.field)}}isColumnIndicatorHeader(e,t){return this._indicatorShowType==="column"&&t===this.columnHeaderLevelCount-1&&e>=this.rowHeaderLevelCount}isRowIndicatorHeader(e,t){return this._indicatorShowType==="row"&&e===this.rowHeaderLevelCount-1&&t>=this.columnHeaderLevelCount}isIndicatorHeader(e,t){return this.isColumnIndicatorHeader(e,t)||this.isRowIndicatorHeader(e,t)}toggleHierarchyState(e,t){var i,o,r,n,s,l;this.colIndex=0;const d=this._rowHeaderCellFullPathIds_FULL.slice(0),a=d.map((h,v)=>({col:e,row:v+this.columnHeaderLevelCount})),u=this.getHeader(e,t);if(u.define.hierarchyState=u.define.hierarchyState===Qe.collapse?Qe.expand:Qe.collapse,this.rowDimensionTree.reset(this.rowDimensionTree.tree.children,!0),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[],this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs),this.rowHeaderTitle){const h=++this.sharedVar.seqId,v=Array(this.rowCount-this.columnHeaderLevelCount).fill(h);this._rowHeaderCellFullPathIds_FULL.unshift(v);const g={id:h,title:typeof this.rowHeaderTitle.title=="string"?this.rowHeaderTitle.title:this.rowsDefine.reduce((f,C)=>typeof C=="string"?f:f+(f?`/${C.title}`:`${C.title}`),""),field:void 0,headerType:(o=(i=this.rowHeaderTitle)===null||i===void 0?void 0:i.headerType)!==null&&o!==void 0?o:"text",style:(r=this.rowHeaderTitle)===null||r===void 0?void 0:r.headerStyle,define:{field:"",headerType:"text",cellType:"text",disableHeaderHover:!!(!((n=this.rowHeaderTitle)===null||n===void 0)&&n.disableHeaderHover),disableHeaderSelect:!!(!((s=this.rowHeaderTitle)===null||s===void 0)&&s.disableHeaderSelect)}};this.rowHeaderObjs.push(g),this._headerObjects[h]=g}this._rowHeaderCellFullPathIds_FULL=ct(this._rowHeaderCellFullPathIds_FULL),this.rowHierarchyType==="tree"&&((l=this.extensionRows)===null||l===void 0?void 0:l.length)>=1&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((h,v)=>(h[v.id]=v,h),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0;const c=eo(e,t,d.map(h=>h[e-this.leftRowSeriesNumberColumnCount]),this._rowHeaderCellFullPathIds_FULL.map(h=>h[e-this.leftRowSeriesNumberColumnCount]),a,this);return this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),c}isHeaderForColWidth(e,t){return this.isHeader(e,t)}getHeaderForColWidth(e,t){return this.getHeader(e,t)}getPivotCellAdress(e){var t;if(!Array.isArray(e))return;let i,o,r=this.rowTree,n=this.columnTree;for(let d=0;d<e.length;d++){const a=e[d];if((a.isPivotCorner||!M(a.value))&&d===e.length-1){if(((t=this==null?void 0:this.cornerSetting)===null||t===void 0?void 0:t.titleOnDimension)==="row"){let h=0;return this.rowHierarchyType==="grid"&&(h=this.rowDimensionKeys.indexOf(a.dimensionKey)),h===-1?void 0:{col:(this.rowHeaderTitle?h+1:h)+this.leftRowSeriesNumberColumnCount,row:0}}const c=this.colDimensionKeys.indexOf(a.dimensionKey);return c===-1?void 0:{col:0+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderTitle?c+1:c}}let u=!1;for(let c=0;c<n.length;c++){const h=n[c];if((M(a.dimensionKey)&&h.dimensionKey===a.dimensionKey||M(a.indicatorKey)&&h.indicatorKey===a.indicatorKey)&&h.value===a.value){n=h.children,o=h,u=!0;break}}if(!u)for(let c=0;c<r.length;c++){const h=r[c];if((M(a.dimensionKey)&&h.dimensionKey===a.dimensionKey||M(a.indicatorKey)&&h.indicatorKey===a.indicatorKey)&&h.value===a.value){r=h.children,i=h;break}}}let s=0,l=0;if(i){l=this.columnHeaderLevelCount;const{startInTotal:d,level:a}=i;return l+=d,s=this.rowHierarchyType==="grid"?(this.rowHeaderTitle?a+1:a)+this.leftRowSeriesNumberColumnCount:0+this.leftRowSeriesNumberColumnCount,{col:s,row:l}}if(o){s=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;const{startInTotal:d,level:a}=o;return s+=d,l=this.columnHeaderTitle?a+1:a,{col:s,row:l}}}getPivotDimensionInfo(e,t){var i;const{colHeaderPaths:o,rowHeaderPaths:r}=this.getCellHeaderPaths(e,t),n=[];return o.length?o.forEach((s,l)=>{n.push({dimensionKey:s.dimensionKey,value:s.value,isPivotCorner:!1,indicatorKey:s.indicatorKey})}):r.length?r.forEach((s,l)=>{n.push({dimensionKey:s.dimensionKey,value:s.value,isPivotCorner:!1,indicatorKey:s.indicatorKey})}):this.isCornerHeader(e,t)&&(((i=this==null?void 0:this.cornerSetting)===null||i===void 0?void 0:i.titleOnDimension)==="row"?n.push({dimensionKey:this.rowDimensionKeys[(this.rowHeaderTitle?e-1:e)-this.leftRowSeriesNumberColumnCount],isPivotCorner:!0}):n.push({dimensionKey:this.colDimensionKeys[this.columnHeaderTitle?t-1:t],isPivotCorner:!0})),n}getIndicatorKey(e,t){var i;return(i=this.getBody(e,t))===null||i===void 0?void 0:i.indicatorKey}getParentCellId(e,t){if(t!==0)return this.isColumnHeader(e,t)?this.getCellId(e,t-1):this.isRowHeader(e,t)?this.getCellId(e-1,t):void 0}getRowHeaderCellAddressByCellId(e){let t,i;if(this._rowHeaderCellIds.find((o,r)=>!!o.find((n,s)=>n===e&&(t=s,!0))&&(i=r,!0)),M(t)&&M(i))return{col:t,row:i+this.columnHeaderLevelCount}}canMoveHeaderPosition(e,t){if(this.isSeriesNumberInHeader(t.col,t.row)||this.isSeriesNumberInHeader(e.col,e.row)||this.isCornerHeader(t.col,t.row)||e.col<0||e.row<0||t.col<0||t.row<0)return!1;this.isSeriesNumberInBody(t.col,t.row)&&this.isSeriesNumberInBody(e.col,e.row)&&(e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1);const i=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row))return this.getParentCellId(e.col,i.start.row)===this.getParentCellId(t.col,i.start.row);if(this.isRowHeader(e.col,e.row)){if(this.rowHierarchyType!=="tree")return this.getParentCellId(i.start.col,e.row)===this.getParentCellId(i.start.col,t.row);{const o=ge(this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths),r=ge(this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths);if(o.pop(),r.pop(),o.length<=r.length){if(o.length===r.length)return!o.find((n,s)=>n.dimensionKey!==r[s].dimensionKey||n.value!==r[s].value);if(o.length>0){for(let n=0;n<o.length;n++)if(o[n].startInTotal!==r[n].startInTotal)return!1}return!0}}}return!1}moveHeaderPosition(e,t){if(this.canMoveHeaderPosition(e,t)&&!this.isCellRangeEqual(e.col,e.row,t.col,t.row)){const i=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row)){const o=i.end.col-i.start.col+1;let r;const n=this.getCellRange(t.col,i.start.row);if(r=t.col>=e.col?n.end.col-o+1:n.start.col,r===i.start.col)return null;for(let l=0;l<this._columnHeaderCellFullPathIds.length;l++){const d=this._columnHeaderCellFullPathIds[l].splice(i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,o);d.unshift(r-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnHeaderCellFullPathIds[l],d)}const s=this._columnWidths.splice(i.start.col-this.leftRowSeriesNumberColumnCount,o);return s.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnWidths,s),this.columnDimensionTree.movePosition(this.getCellHeaderPathsWithTreeNode(e.col,e.row).colHeaderPaths.length-1,i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,n.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount),this.columnDimensionTree.reset(this.columnDimensionTree.tree.children,!0),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.col,targetIndex:r,sourceSize:o,targetSize:n.end.col-n.start.col+1,moveType:"column"}}if(this.isRowHeader(e.col,e.row)){let o;const r=this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths,n=this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,s=r[r.length-1],l=n[r.length-1],d=s.size;if(o=t.row>=e.row?l.startInTotal+l.size-d:l.startInTotal,o===i.start.row-this.columnHeaderLevelCount)return null;const a=this._rowHeaderCellIds.splice(i.start.row-this.columnHeaderLevelCount,d);a.unshift(o-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellIds,a);const u=this._rowHeaderCellFullPathIds.splice(i.start.row-this.columnHeaderLevelCount,d);u.unshift(o-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds,u);const c=this._rowHeaderCellIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,d);c.unshift(o,0),Array.prototype.splice.apply(this._rowHeaderCellIds_FULL,c);const h=this._rowHeaderCellFullPathIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,d);return h.unshift(o,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds_FULL,h),this.rowDimensionTree.movePosition(r.length-1,i.start.row-this.columnHeaderLevelCount,o+(t.row>e.row?s.size-1:0)),this.rowDimensionTree.reset(this.rowDimensionTree.tree.children,!0),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.row,targetIndex:o+this.columnHeaderLevelCount,sourceSize:d,targetSize:l.size,moveType:"row"}}}return null}getCellAdressByHeaderPath(e){var t,i,o,r,n,s;let l,d,a=!1,u=!1;if(Array.isArray(e)){if(e.length>this.rowDimensionKeys.length+this.colDimensionKeys.length)return;l=e.filter(m=>this.colDimensionKeys.indexOf(m.dimensionKey)>=0||this.colDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&m.indicatorKey),d=e.filter(m=>this.rowDimensionKeys.indexOf(m.dimensionKey)>=0||this.rowDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&m.indicatorKey)}else l=e.colHeaderPaths,d=e.rowHeaderPaths,(e==null?void 0:e.cellLocation)==="body"&&this._table.isPivotTable()&&(u=!0);if(!Array.isArray(l)&&!Array.isArray(d))return;if(l==null||l.sort((m,p)=>{var I,P;return this.colDimensionKeys.indexOf((I=m.dimensionKey)!==null&&I!==void 0?I:this.indicatorDimensionKey)-this.colDimensionKeys.indexOf((P=p.dimensionKey)!==null&&P!==void 0?P:this.indicatorDimensionKey)}),d==null||d.sort((m,p)=>{var I,P;return this.fullRowDimensionKeys.indexOf((I=m.dimensionKey)!==null&&I!==void 0?I:this.indicatorDimensionKey)-this.fullRowDimensionKeys.indexOf((P=p.dimensionKey)!==null&&P!==void 0?P:this.indicatorDimensionKey)}),l==null||l.forEach(m=>{m.isPivotCorner&&(a=!0)}),d==null||d.forEach(m=>{m.isPivotCorner&&(a=!0)}),a){if(this.cornerSetting.titleOnDimension==="all"&&this.indicatorsAsCol&&l.length===0){for(let m=0;m<this.rowDimensionKeys.length;m++)if(((t=d[0])===null||t===void 0?void 0:t.dimensionKey)===this.rowDimensionKeys[m])return{col:m+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderLevelCount-1}}else if(this.cornerSetting.titleOnDimension!=="all"||this.indicatorsAsCol||d.length!==0){if(this.cornerSetting.titleOnDimension==="row"||this.cornerSetting.titleOnDimension==="all"&&!this.indicatorsAsCol){for(let m=0;m<this.rowDimensionKeys.length;m++)if(((o=d[0])===null||o===void 0?void 0:o.dimensionKey)===this.rowDimensionKeys[m])return{col:m+this.leftRowSeriesNumberColumnCount,row:0}}else for(let m=0;m<this.colDimensionKeys.length;m++)if(((r=l[0])===null||r===void 0?void 0:r.dimensionKey)===this.colDimensionKeys[m])return{col:0,row:m}}else for(let m=0;m<this.colDimensionKeys.length;m++)if(((i=l[0])===null||i===void 0?void 0:i.dimensionKey)===this.colDimensionKeys[m])return{col:this.rowHeaderLevelCount-1,row:m}}let c,h,v,g,f=!1;(l==null?void 0:l.length)>=1&&(d==null?void 0:d.length)>=1&&(f=!0);let C,w,S=this.rowTree,H=this.columnTree;if(l)for(let m=0;m<l.length;m++){const p=l[m];for(let I=0;I<H.length;I++){const P=H[I];if(!M(p.indicatorKey)&&P.dimensionKey===p.dimensionKey&&P.value===p.value||M(p.indicatorKey)&&P.indicatorKey===p.indicatorKey){H=P.children,f&&!H?w=P:f||(w=P);break}}}if((d==null?void 0:d.length)>=1)if(this.rowHierarchyType==="tree"){const m=d[d.length-1],p=this.headerObjects.filter(P=>((P==null?void 0:P.field)===m.dimensionKey||(P==null?void 0:P.field)===m.indicatorKey)&&(P==null?void 0:P.title)===m.value).map(P=>P.id),I=this._rowHeaderCellIds.filter(P=>p.indexOf(P[P.length-1])>=0).find(P=>{const y=this.findFullCellIds(P);return y.length===d.length&&y.every(T=>{const _=this._headerObjectMap[T];return d.find(b=>b.dimensionKey===_.field&&b.value===_.title)})});h=this._rowHeaderCellIds.indexOf(I)+this.columnHeaderLevelCount}else for(let m=0;m<d.length;m++){const p=d[m];for(let I=0;I<S.length;I++){const P=S[I];if(!M(p.indicatorKey)&&P.dimensionKey===p.dimensionKey&&P.value===p.value||M(p.indicatorKey)&&P.indicatorKey===p.indicatorKey&&(!M(p.value)||P.value===p.value)){S=P.children,(!f||S&&!S.some(y=>y.dimensionKey==="axis"))&&f||(C=P);break}}}if(u||!f||(C||M(h))&&w){if(C||u){h=this.columnHeaderLevelCount;const{startInTotal:m,level:p}=(n=C)!==null&&n!==void 0?n:Nt;h+=m??0,v=this.rowHierarchyType==="grid"?(this.rowHeaderTitle?p+1:p)+this.leftRowSeriesNumberColumnCount:0}if(w||u){c=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;const{startInTotal:m,level:p}=(s=w)!==null&&s!==void 0?s:Nt;c+=m??0,g=this.columnHeaderTitle?p+1:p}return M(c)||M(h)?{col:c??v,row:h??g}:void 0}}setChartInstance(e,t,i){var o,r,n,s;const l=this.getCellHeaderPaths(e,t);let d;if(this.indicatorsAsCol){const a=(o=l.colHeaderPaths.find(u=>u.indicatorKey))===null||o===void 0?void 0:o.indicatorKey;d=(r=this._indicators)===null||r===void 0?void 0:r.find(u=>u.indicatorKey===a)}else{const a=(n=l.rowHeaderPaths.find(u=>u.indicatorKey))===null||n===void 0?void 0:n.indicatorKey;d=(s=this._indicators)===null||s===void 0?void 0:s.find(u=>u.indicatorKey===a)}typeof(d==null?void 0:d.chartSpec)!="function"&&d&&(d.chartInstance=i)}getChartInstance(e,t){var i,o,r,n;const s=this.getCellHeaderPaths(e,t);let l;if(this.indicatorsAsCol){const d=(i=s.colHeaderPaths.find(a=>a.indicatorKey))===null||i===void 0?void 0:i.indicatorKey;l=(o=this._indicators)===null||o===void 0?void 0:o.find(a=>a.indicatorKey===d)}else{const d=(r=s.rowHeaderPaths.find(a=>a.indicatorKey))===null||r===void 0?void 0:r.indicatorKey;l=(n=this._indicators)===null||n===void 0?void 0:n.find(a=>a.indicatorKey===d)}return l==null?void 0:l.chartInstance}checkHasChart(){return Ti(this)}getDimension(e,t){var i,o;return t==="column"?(i=this.columnsDefine)===null||i===void 0?void 0:i.find(r=>typeof r!="string"&&r.dimensionKey===e):t==="row"?(o=this.rowsDefine)===null||o===void 0?void 0:o.find(r=>typeof r!="string"&&r.dimensionKey===e):void 0}getAxisConfigInPivotChart(e,t){if((this.isFrozenColumn(e,t)||this.isRightFrozenColumn(e,t))&&Je(e,t,"row",this)||(this.isFrozenRow(e,t)||this.isBottomFrozenRow(e,t))&&Je(e,t,"col",this))return Le.getFunction("getAxisConfigInPivotChart")(e,t,this)}isEmpty(e,t){return!!this._table.isPivotChart()&&(!!this.isLeftBottomCorner(e,t)||!!this.isRightBottomCorner(e,t)||!!this.isRightTopCorner(e,t))}isAxisCell(e,t){return this._table.isPivotChart()?!!(this.indicatorKeys.length>=1&&it(this.indicatorsDefine)&&(this.isBottomFrozenRow(e,t)&&Je(e,t,"col",this)||this.isRightFrozenColumn(e,t)&&Je(e,t,"row",this)||this.isRowHeader(e,t)&&e===this.rowHeaderLevelCount-1&&Je(e,t,"row",this)||this.hasTwoIndicatorAxes&&this.indicatorsAsCol&&t===this.columnHeaderLevelCount-1&&Je(e,t,"col",this))):!1}getChartAxes(e,t){if(Pi(e,t,this)||this.isAxisCell(e,t))return Si(e,t,this)}getRawChartSpec(e,t){return bi(e,t,this)}getChartSpec(e,t){return Ii(e,t,this)}isShareChartSpec(e,t){return Ri(e,t,this)}getChartDataId(e,t){return Di(e,t,this)}isNoChartDataRenderNothing(e,t){return Fi(e,t,this)}setPagination(e){var t,i,o,r,n,s,l;if(this.clearCellRangeMap(),this._table.internalProps.useOneRowHeightFillAll=!1,this.pagination=e,this.rowHierarchyType==="grid"&&M((t=this.pagination)===null||t===void 0?void 0:t.perPageCount)&&M((i=this.pagination)===null||i===void 0?void 0:i.currentPage)){this.indicatorsAsCol===!1&&(this.pagination.perPageCount=Math.ceil(this.pagination.perPageCount/this.indicatorKeys.length)*this.indicatorKeys.length);const{perPageCount:d,currentPage:a}=this.pagination;this.currentPageStartIndex=d*(a||0),this.currentPageEndIndex=this.currentPageStartIndex+d,this._rowHeaderCellIds=(o=this._rowHeaderCellIds_FULL)===null||o===void 0?void 0:o.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=(r=this._rowHeaderCellFullPathIds_FULL)===null||r===void 0?void 0:r.slice(this.currentPageStartIndex,this.currentPageEndIndex)}else this.currentPageStartIndex=0,this.currentPageEndIndex=this._rowHeaderCellIds_FULL.length,this._rowHeaderCellIds=(n=this._rowHeaderCellIds_FULL)===null||n===void 0?void 0:n.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=(s=this._rowHeaderCellFullPathIds_FULL)===null||s===void 0?void 0:s.slice(this.currentPageStartIndex,this.currentPageEndIndex);this.pagination&&(this.pagination.totalCount=(l=this._rowHeaderCellIds_FULL)===null||l===void 0?void 0:l.length)}release(){var e;const t=this._table._getActiveChartInstance();t==null||t.release(),(e=this._indicators)===null||e===void 0||e.forEach(i=>{var o;(o=i.chartInstance)===null||o===void 0||o.release()})}getHeadNode(e,t){var i,o,r;let n;const s=this.getCellHeaderPaths(e,t);return s.rowHeaderPaths&&((o=(i=s.rowHeaderPaths)===null||i===void 0?void 0:i.length)!==null&&o!==void 0?o:0)>0?n=(r=s.rowHeaderPaths)===null||r===void 0?void 0:r.slice(0,s.rowHeaderPaths.length):s.colHeaderPaths&&s.colHeaderPaths.length>0&&(n=s.colHeaderPaths.slice(0,s.colHeaderPaths.length)),this.getHeadNodeByRowOrColDimensions(n,e,t)}getHeadNodeByRowOrColDimensions(e,t,i){var o;if(!Array.isArray(e))return;let r,n,s=this.rowTree,l=this.columnTree;if(M(i)&&M(t)&&this.rowHierarchyType==="tree"&&this.extensionRows&&t>=1+this.leftRowSeriesNumberColumnCount){const d=this.getCellId(t-1,i);s=this._rowHeaderExtensionTree[d].tree.children}for(let d=0;d<e.length;d++){const a=e[d];if((a.isPivotCorner||!M(a.value))&&d===e.length-1)return;let u=!1;for(let c=0;c<l.length;c++){const h=l[c];if(M(a.dimensionKey)&&h.dimensionKey===a.dimensionKey&&h.value===a.value||M(a.indicatorKey)&&h.indicatorKey===a.indicatorKey&&(h.value===a.value||!M(a.value)||!M(h.value))){l=h.children,n=h,u=!0;break}}if(!u)for(let c=0;(o=c<(s==null?void 0:s.length))!==null&&o!==void 0&&o;c++){const h=s[c];if(M(a.dimensionKey)&&h.dimensionKey===a.dimensionKey&&h.value===a.value||M(a.indicatorKey)&&h.indicatorKey===a.indicatorKey&&(h.value===a.value||!M(a.value)||!M(h.value))){s=h.children,r=h;break}}}return r||n||void 0}clearCellRangeMap(){this._largeCellRangeCache.length=0,this._CellHeaderPathMap=new Map}getDimensionKeyInChartSpec(e,t){var i,o,r,n,s,l;let d;if(this.indicatorsAsCol===!1)for(let a=0;a<this.indicatorsDefine.length;a++){const u=this.indicatorsDefine[a].chartSpec;if(u&&(d=(i=u.xField)!==null&&i!==void 0?i:(r=(o=u==null?void 0:u.series)===null||o===void 0?void 0:o[0])===null||r===void 0?void 0:r.xField,d))return d}else for(let a=0;a<this.indicatorsDefine.length;a++){const u=this.indicatorsDefine[a].chartSpec;if(u&&(d=(n=u.yField)!==null&&n!==void 0?n:(l=(s=u==null?void 0:u.series)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.yField,d))return d}return null}_generateChartState(){return{vtable_selected:{filter:e=>{var t;return this._table._selectedDataItemsInChart.length>=1?!!this._table._selectedDataItemsInChart.find(i=>{for(const o in i)if(typeof i[o]!="object"&&i[o]!==e[o])return!1;return!0}):!((t=this._table._selectedDimensionInChart)===null||t===void 0)&&t.length?!!this._table._selectedDimensionInChart.every(i=>typeof i.value=="object"||e[i.key]===i.value):!1}},vtable_selected_reverse:{filter:e=>{var t;return this._table._selectedDataItemsInChart.length>=1?!this._table._selectedDataItemsInChart.find(i=>{for(const o in i)if(typeof i[o]!="object"&&i[o]!==e[o])return!1;return!0}):!((t=this._table._selectedDimensionInChart)===null||t===void 0)&&t.length?!this._table._selectedDimensionInChart.every(i=>typeof i.value=="object"||e[i.key]===i.value):!1}}}}updateDataStateToChartInstance(e){var t;if(((t=e==null?void 0:e.getSpec().select)===null||t===void 0?void 0:t.enable)!==!1){e||(e=this._table._getActiveChartInstance());const i=this._generateChartState();this._indicators.forEach(o=>{var r;const n=o.chartInstance;((r=o.chartSpec.select)===null||r===void 0?void 0:r.enable)!==!1&&n.updateState(i)}),e==null||e.updateState(i)}}updateDataStateToActiveChartInstance(e){var t;if(((t=e==null?void 0:e.getSpec().select)===null||t===void 0?void 0:t.enable)!==!1){e||(e=this._table._getActiveChartInstance());const i=this._generateChartState();e==null||e.updateState(i)}}getIndicatorKeyInChartSpec(e,t){const i=this.getRawChartSpec(e,t),o=[];if(i){if(i.series||i.xField||i.yField)return this.indicatorsAsCol===!1?i.series?i.series.forEach(r=>{const n=r.yField;o.push(n)}):o.push(i.yField):i.series?i.series.forEach(r=>{const n=r.xField;o.push(n)}):o.push(i.xField),o;if(i.valueField&&o.push(i.valueField),o.length>=1)return o}return null}getOptimunHeightForChart(e){var t,i,o,r,n;const s=this.getCellHeaderPaths(this.rowHeaderLevelCount,e).rowHeaderPaths;let l,d;for(const u in this.dataset.collectValuesBy)if(this.dataset.collectValuesBy[u].type==="yField"&&!this.dataset.collectValuesBy[u].range){l=(t=this.dataset.collectedValues[u])===null||t===void 0?void 0:t[s.map(c=>c.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)d=Bt((i=l==null?void 0:l.length)!==null&&i!==void 0?i:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{const u=this._chartItemSpanSize||25;d=((o=l==null?void 0:l.length)!==null&&o!==void 0?o:0)*(u+u/3)}const a=At((n=(r=this._chartPadding)!==null&&r!==void 0?r:this._table.theme.bodyStyle.padding)!==null&&n!==void 0?n:0);return d+a[0]+a[2]}getOptimunWidthForChart(e){var t,i,o,r,n;const s=this.getCellHeaderPaths(e,this.columnHeaderLevelCount).colHeaderPaths;let l,d;for(const u in this.dataset.collectValuesBy)if(this.dataset.collectValuesBy[u].type==="xField"&&!this.dataset.collectValuesBy[u].range){l=(t=this.dataset.collectedValues[u])===null||t===void 0?void 0:t[s.map(c=>c.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)d=Bt((i=l==null?void 0:l.length)!==null&&i!==void 0?i:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{const u=this._chartItemSpanSize||25;d=((o=l==null?void 0:l.length)!==null&&o!==void 0?o:0)*(u+u/3)}const a=At((n=(r=this._chartPadding)!==null&&r!==void 0?r:this._table.theme.bodyStyle.padding)!==null&&n!==void 0?n:0);return d+a[1]+a[3]}get leftAxesCount(){if(!this._table.isPivotChart())return 0;const e=this._table.pivotChartAxes.find(t=>t.orient==="left");return(e==null?void 0:e.visible)===!1?0:(this.indicatorsAsCol,1)}get topAxesCount(){if(!this._table.isPivotChart())return 0;const e=this._table.pivotChartAxes.find(t=>t.orient==="top");return(e==null?void 0:e.visible)===!1?0:this.indicatorsAsCol&&this.hasTwoIndicatorAxes?1:0}get rightAxesCount(){return this.rightFrozenColCount}get bottomAxesCount(){return this.bottomFrozenRowCount}getColKeysPath(e,t){const i=this.getCellHeaderPaths(e,t),o=[];return i.colHeaderPaths.length&&i.colHeaderPaths.forEach(r=>{r.dimensionKey&&o.push(r.value)}),o==null?void 0:o.join(this.dataset.stringJoinChar)}getRowKeysPath(e,t){const i=this.getCellHeaderPaths(e,t),o=[];return i.rowHeaderPaths.length&&i.rowHeaderPaths.forEach(r=>{r.dimensionKey&&o.push(r.value)}),o==null?void 0:o.join(this.dataset.stringJoinChar)}getIndicatorInfo(e,t=""){var i;return(i=this.indicatorsDefine)===null||i===void 0?void 0:i.find(o=>typeof o!="string"&&(e?o.indicatorKey===e:!!t&&o.title===t))}getLayoutColumnTree(){const e=[],t=this.columnDimensionTree.tree.children;return Kt(e,t),e}getLayoutRowTree(){const e=[],t=this.rowDimensionTree.tree.children;return Kt(e,t),e}getLayoutColumnTreeCount(){const e=this.columnDimensionTree.tree.children;return vt(e,this.rowHierarchyType==="tree")}getLayoutRowTreeCount(){var e;const t=this.rowDimensionTree.tree.children;let i=vt(t,this.rowHierarchyType==="tree");return(e=this.extensionRows)===null||e===void 0||e.forEach(o=>{if(typeof o.rowTree!="function"){const r=vt(o.rowTree,!0);i*=r}}),i}resetHeaderTree(){var e,t,i;this.colIndex=0,this._rowHeaderCellFullPathIds_FULL=[],this._columnHeaderCellFullPathIds=[],this._columnHeaderCellIds=[];const o=this.dataset;this.rowTree=o.rowHeaderTree,this.columnTree=o.colHeaderTree;const r=this.rowDimensionTree.tree.children;(e=this.rowTree)===null||e===void 0||e.forEach((n,s)=>{const l=r.find(d=>d.dimensionKey===n.dimensionKey&&d.value===n.value);l&&this._table._syncHierarchyState(l,n)}),this.columnDimensionTree=new ce((t=this.columnTree)!==null&&t!==void 0?t:[],this.sharedVar),this.rowDimensionTree=new ce((i=this.rowTree)!==null&&i!==void 0?i:[],this.sharedVar,this.rowHierarchyType,this.rowHierarchyType==="tree"?this.rowExpandLevel:void 0),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=ct(this._rowHeaderCellFullPathIds_FULL),this._headerObjectMap=this._headerObjects.reduce((n,s)=>(n[s.id]=s,n),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination)}isSeriesNumberInHeader(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&t>=0&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&t>=0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount}isSeriesNumberInBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount}isSeriesNumber(e,t){return!!(M(e)&&M(t)&&(this.leftRowSeriesNumberColumnCount>0&&e>=0&&t>=0&&e<this.leftRowSeriesNumberColumnCount||this.rightRowSeriesNumberColumnCount>0&&t>=0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount))}getSeriesNumberHeader(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount?Object.assign({},this.leftRowSeriesNumberColumn[e],{style:this._table.internalProps.rowSeriesNumber.headerStyle}):this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount&&t<this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}getSeriesNumberBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.leftRowSeriesNumberColumn[e]:this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}changeTreeNodeTitle(e,t,i){this.getHeadNode(e,t).value=i;const o=this.getCellId(e,t);this._headerObjectMap[o].title=i}changeCornerTitle(e,t,i){if(this.isCornerHeader(e,t)){const o=this.getCellId(e,t);this._headerObjectMap[o].title=i}}generateCellIdsConsiderHideHeader(){if(this._columnHeaderCellIds=this._columnHeaderCellFullPathIds.slice(),!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){const e=this.colDimensionKeys.indexOf(Me),t=this._columnHeaderCellIds.splice(e,1);this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length),this._columnHeaderCellIds.push(t[0])}else this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length);if(this._rowHeaderCellIds_FULL=this._rowHeaderCellFullPathIds_FULL.slice(),!this.showRowHeader)if(this.indicatorsAsCol||this.hideIndicatorName)this._rowHeaderCellIds_FULL.forEach((e,t)=>{const i=e.slice();i.splice(0,i.length),this._rowHeaderCellIds_FULL[t]=i});else{const e=this.rowDimensionKeys.indexOf(Me);this._rowHeaderCellIds_FULL.forEach((t,i)=>{const o=t.slice(),r=o.splice(e,1);o.splice(0,o.length),o.push(r[0]),this._rowHeaderCellIds_FULL[i]=o})}if(this._rowHeaderCellIds=this._rowHeaderCellIds_FULL.slice(),this._cornerHeaderCellIds=this._cornerHeaderCellFullPathIds.slice(),this.rowHeaderLevelCount===0||this.columnHeaderLevelCount===0)this._cornerHeaderCellIds=[];else if(this.cornerSetting.titleOnDimension!=="row"||this.showRowHeader){if(this.cornerSetting.titleOnDimension==="column"&&!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){const e=this.colDimensionKeys.indexOf(Me),t=this._cornerHeaderCellIds.splice(e,1);this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length),this._cornerHeaderCellIds.push(t[0])}else this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length)}else if(this.indicatorsAsCol||this.hideIndicatorName)this._cornerHeaderCellIds.forEach((e,t)=>{const i=e.slice();i.splice(0,i.length),this._cornerHeaderCellIds[t]=i});else{const e=this.rowDimensionKeys.indexOf(Me);this._cornerHeaderCellIds.forEach((t,i)=>{const o=t.slice(),r=o.splice(e,1);o.splice(0,o.length),o.push(r[0]),this._cornerHeaderCellIds[i]=o})}}enableUseGetBodyCache(){this._useGetBodyCache=!0,this._getBodyCache.clear()}disableUseGetBodyCache(){this._useGetBodyCache=!1,this._getBodyCache.clear()}enableUseHeaderPathCache(){this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}disableUseHeaderPathCache(){this._useHeaderPathCache=!1,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}getBodyWidthCache(e,t){if(this._useGetBodyCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t))return this.indicatorsAsCol&&this._getBodyCache.has(e)?this._getBodyCache.get(e):!this.indicatorsAsCol&&this._getBodyCache.has(t)?this._getBodyCache.get(t):void 0}setBodyWidthCache(e,t,i){!this._useGetBodyCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||(this.indicatorsAsCol?this._getBodyCache.set(e,i):this._getBodyCache.set(t,i))}getColHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._colHeaderPathCache.has(e))return this._colHeaderPathCache.get(e)}setColHeaderPathCache(e,t,i){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._colHeaderPathCache.set(e,i)}getRowHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._rowHeaderPathCache.has(t))return this._rowHeaderPathCache.get(t)}setRowHeaderPathCache(e,t,i){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._rowHeaderPathCache.set(t,i)}}function Bt(D,e,t,i){t===1&&(t=0);const o=to(D,t,i),r=e/(1-t);return Math.ceil(o*r)}function to(D,e,t){let i;return i=D===1?D+2*t:D-e+2*t,D?i>0?i:1:0}class yt{constructor(e,t){this.tree={},this.beforeChangedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.dataConfig=e,t&&(this.records=t,typeof window<"u"&&window.performance.now(),this.setRecords(t),typeof window<"u"&&window.performance.now())}changeDataConfig(e){this.dataConfig=e}setRecords(e){this.processRecords()}processRecords(){for(let e=0,t=this.records.length;e<t;e++){const i=this.records[e];this.processRecord(i)}}processRecord(e){var t;const i=[],o=[];for(let r=0,n=this.dataConfig.rows.length;r<n;r++){const s=this.dataConfig.rows[r];e[s]!==void 0&&s!==this.dataConfig.indicatorDimensionKey&&o.push(e[s])}for(let r=0,n=this.dataConfig.columns.length;r<n;r++){const s=this.dataConfig.columns[r];e[s]!==void 0&&s!==this.dataConfig.indicatorDimensionKey&&i.push(e[s])}(t=this.dataConfig.indicators)===null||t===void 0||t.forEach(r=>{const n=e[r];n!==void 0&&(this.dataConfig.indicatorsAsCol?i.push(r):o.push(r));const s=o.join(this.stringJoinChar),l=i.join(this.stringJoinChar);o.length!==0&&(this.rowFlatKeys[s]||(this.rowFlatKeys[s]=1)),i.length!==0&&(this.colFlatKeys[l]||(this.colFlatKeys[l]=1)),i.length===0&&o.length===0||(this.tree[s]||(this.tree[s]={}),n!==void 0&&(this.tree[s][l]={value:n,record:e},this.dataConfig.indicatorsAsCol?i.pop():o.pop()))})}getTreeNode(e=[],t=[],i,o=!0){var r,n,s,l;let d,a;if(typeof e=="string")d=e;else{let u=!1;e.map((c,h)=>{c===i&&(e.splice(h,1),u=!0)}),u&&e.push(i),d=e.join(this.stringJoinChar)}if(typeof t=="string")a=t;else{let u=!1;t.map((c,h)=>{c===i&&(t.splice(h,1),u=!0)}),u&&t.push(i),a=t.join(this.stringJoinChar)}return o?(s=(n=(r=this.tree)===null||r===void 0?void 0:r[d])===null||n===void 0?void 0:n[a])!==null&&s!==void 0?s:void 0:M((l=this.beforeChangedTree[d])===null||l===void 0?void 0:l[a])?{value:this.beforeChangedTree[d][a].value,record:this.beforeChangedTree[d][a].record}:void 0}changeTreeNodeValue(e=[],t=[],i,o){var r,n,s,l,d,a,u;let c,h;if(typeof e=="string")c=e;else{let f=!1;e.map((C,w)=>{C===i&&(e.splice(w,1),f=!0)}),f&&e.push(i),c=e.join(this.stringJoinChar)}if(typeof t=="string")h=t;else{let f=!1;t.map((C,w)=>{C===i&&(t.splice(w,1),f=!0)}),f&&t.push(i),h=t.join(this.stringJoinChar)}const v=(n=(r=this.tree[c])===null||r===void 0?void 0:r[h])===null||n===void 0?void 0:n.value,g=Object.assign({},(l=(s=this.tree[c])===null||s===void 0?void 0:s[h])===null||l===void 0?void 0:l.record);!((a=(d=this.tree[c])===null||d===void 0?void 0:d[h])===null||a===void 0)&&a.record?(this.tree[c][h].record[i]=o,this.tree[c][h].value=o):(this.tree[c]||(this.tree[c]={}),this.tree[c][h]={record:this._buildRecord(e,t,i,o),value:o}),!((u=this.beforeChangedTree[c])===null||u===void 0)&&u[h]||(this.beforeChangedTree[c]={},this.beforeChangedTree[c][h]={record:void 0,value:void 0},this.beforeChangedTree[c][h].record=g,this.beforeChangedTree[c][h].value=v)}_buildRecord(e=[],t=[],i,o){const r={},n=this.dataConfig.rows,s=this.dataConfig.columns;return n.forEach((l,d)=>{l!==this.dataConfig.indicatorDimensionKey&&(r[l]=e[d])}),s.forEach((l,d)=>{l!==this.dataConfig.indicatorDimensionKey&&(r[l]=t[d])}),r[i]=o,this.records.push(r),r}addRecords(e){for(let t=0,i=e.length;t<i;t++){const o=e[t];this.processRecord(o)}this.records.push(e)}changeRecordFieldValue(e,t,i){let o=!1;for(let r=0;r<this.dataConfig.indicators.length;r++)this.dataConfig.indicators[r]===e&&(o=!0);if(!o){for(let r=0,n=this.records.length;r<n;r++){const s=this.records[r];s[e]===t&&(s[e]=i)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}}function Vt(D,e){let t="";for(let i=0;i<D.length;i++)t+=D[i],i!==D.length-1&&(t+=e);return t}class at{constructor(e,t,i,o,r,n,s,l,d,a,u,c,h){var v,g,f,C,w,S,H,m,p,I,P,y,T,_,b,K,j,G,X,Z,W,$,se,ne,le,ae,de,he,ue,Ce,_e,we,He,Te,Pe,Se,be,ee;this.tree={},this.changedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.colKeys_normal=[],this.rowKeys_normal=[],this.rowOrder="key_a_to_z",this.colOrder="key_a_to_z",this.sorted=!1,this.indicatorStatistics=[],this.aggregators={},this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.registerAggregators(),this.dataConfig=e,this.filterRules=(v=this.dataConfig)===null||v===void 0?void 0:v.filterRules,this.rowHierarchyType=l??"grid",this.sortRules=(g=this.dataConfig)===null||g===void 0?void 0:g.sortRules,this.aggregationRules=(f=this.dataConfig)===null||f===void 0?void 0:f.aggregationRules,this.derivedFieldRules=(C=this.dataConfig)===null||C===void 0?void 0:C.derivedFieldRules,this.mappingRules=(w=this.dataConfig)===null||w===void 0?void 0:w.mappingRules,this.calculatedFieldRules=(S=this.dataConfig)===null||S===void 0?void 0:S.calculatedFieldRules,this.calculatedFiledKeys=(m=(H=this.calculatedFieldRules)===null||H===void 0?void 0:H.map(z=>z.key))!==null&&m!==void 0?m:[],this.calculatedFieldDependIndicatorKeys=(I=(p=this.calculatedFieldRules)===null||p===void 0?void 0:p.reduce((z,U)=>{for(let q=0;q<U.dependIndicatorKeys.length;q++)z.indexOf(U.dependIndicatorKeys[q])===-1&&z.push(U.dependIndicatorKeys[q]);return z},[]))!==null&&I!==void 0?I:[],this.totals=(P=this.dataConfig)===null||P===void 0?void 0:P.totals,this.rows=t,this.columns=i,this.indicatorKeys=o,this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys=[...o];for(let z=0;z<this.calculatedFieldDependIndicatorKeys.length;z++)this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(this.calculatedFieldDependIndicatorKeys[z])===-1&&this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.push(this.calculatedFieldDependIndicatorKeys[z]);if(this.indicatorsAsCol=n,this.indicators=r,this.customColTree=d,this.customRowTree=a,this.hasExtensionRowTree=c,this.parseCustomTreeToMatchRecords=h,this.parseCustomTreeToMatchRecords&&(this.customColTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customColTree,"col"),this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))),this.colGrandTotalLabel=(_=(T=(y=this.totals)===null||y===void 0?void 0:y.column)===null||T===void 0?void 0:T.grandTotalLabel)!==null&&_!==void 0?_:"总计",this.colSubTotalLabel=(j=(K=(b=this.totals)===null||b===void 0?void 0:b.column)===null||K===void 0?void 0:K.subTotalLabel)!==null&&j!==void 0?j:"小计",this.rowGrandTotalLabel=(Z=(X=(G=this.totals)===null||G===void 0?void 0:G.row)===null||X===void 0?void 0:X.grandTotalLabel)!==null&&Z!==void 0?Z:"总计",this.rowSubTotalLabel=(se=($=(W=this.totals)===null||W===void 0?void 0:W.row)===null||$===void 0?void 0:$.subTotalLabel)!==null&&se!==void 0?se:"小计",this.collectValuesBy=(ne=this.dataConfig)===null||ne===void 0?void 0:ne.collectValuesBy,this.needSplitPositiveAndNegative=u!=null&&u,this.rowsIsTotal=new Array((ae=(le=this.rows)===null||le===void 0?void 0:le.length)!==null&&ae!==void 0?ae:0).fill(!1),this.colsIsTotal=new Array((he=(de=this.columns)===null||de===void 0?void 0:de.length)!==null&&he!==void 0?he:0).fill(!1),((ue=this.totals)===null||ue===void 0?void 0:ue.row)&&this.totals.row.showSubTotals!==!1&&this.totals.row.subTotalsDimensions)for(let z=0,U=(He=(we=(_e=(Ce=this.totals)===null||Ce===void 0?void 0:Ce.row)===null||_e===void 0?void 0:_e.subTotalsDimensions)===null||we===void 0?void 0:we.length)!==null&&He!==void 0?He:0;z<U;z++){const q=this.totals.row.subTotalsDimensions[z],ve=this.rows.indexOf(q);this.rowsIsTotal[ve]=!0}if(!((Te=this.totals)===null||Te===void 0)&&Te.column&&this.totals.column.showSubTotals!==!1&&this.totals.column.subTotalsDimensions)for(let z=0,U=(ee=(be=(Se=(Pe=this.totals)===null||Pe===void 0?void 0:Pe.column)===null||Se===void 0?void 0:Se.subTotalsDimensions)===null||be===void 0?void 0:be.length)!==null&&ee!==void 0?ee:0;z<U;z++){const q=this.totals.column.subTotalsDimensions[z],ve=this.columns.indexOf(q);this.colsIsTotal[ve]=!0}this.setRecords(s)}setRecords(e){var t,i,o,r,n,s,l,d,a,u,c,h,v,g,f,C,w,S,H;this.records=e,this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.tree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.rowsHasValue=[],this.columnsHasValue=[],e&&(this.records=e,typeof window<"u"&&window.performance.now(),this.processRecords(),this.processCollectedValuesWithSumBy(),this.generateCollectedValuesSortRule(),this.processCollectedValuesWithSortBy(),typeof window<"u"&&window.performance.now(),typeof window<"u"&&window.performance.now(),this.totalStatistics(),typeof window<"u"&&window.performance.now(),this.rowKeys_normal=this.rowKeys.slice(),this.colKeys_normal=this.colKeys.slice(),typeof window<"u"&&window.performance.now(),this.sortKeys(),typeof window<"u"&&window.performance.now(),typeof window<"u"&&window.performance.now(),this.customRowTree?this.rowHeaderTree=this.customRowTree:this.rowHierarchyType==="tree"?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((m,p)=>this.rowsHasValue[p]),this.indicatorsAsCol?void 0:this.indicators,((i=(t=this.totals)===null||t===void 0?void 0:t.row)===null||i===void 0?void 0:i.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((m,p)=>this.rowsHasValue[p]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,((r=(o=this.totals)===null||o===void 0?void 0:o.row)===null||r===void 0?void 0:r.showGrandTotals)||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel,this.rowSubTotalLabel,(l=(s=(n=this.totals)===null||n===void 0?void 0:n.row)===null||s===void 0?void 0:s.showGrandTotalsOnTop)!==null&&l!==void 0&&l,(u=(a=(d=this.totals)===null||d===void 0?void 0:d.row)===null||a===void 0?void 0:a.showSubTotalsOnTop)!==null&&u!==void 0&&u),this.customColTree?this.colHeaderTree=this.customColTree:this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((m,p)=>this.columnsHasValue[p]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,((h=(c=this.totals)===null||c===void 0?void 0:c.column)===null||h===void 0?void 0:h.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0,this.colGrandTotalLabel,this.colSubTotalLabel,(f=(g=(v=this.totals)===null||v===void 0?void 0:v.column)===null||g===void 0?void 0:g.showGrandTotalsOnLeft)!==null&&f!==void 0&&f,(S=(w=(C=this.totals)===null||C===void 0?void 0:C.column)===null||w===void 0?void 0:w.showSubTotalsOnLeft)!==null&&S!==void 0&&S),typeof window<"u"&&window.performance.now(),!((H=this.dataConfig)===null||H===void 0)&&H.isPivotChart&&this.cacheDeminsionCollectedValues())}registerAggregator(e,t){this.aggregators[e]=t}registerAggregators(){this.registerAggregator(ie.RECORD,Ai),this.registerAggregator(ie.SUM,Ki),this.registerAggregator(ie.COUNT,Li),this.registerAggregator(ie.MAX,xi),this.registerAggregator(ie.MIN,Mi),this.registerAggregator(ie.AVG,Oi),this.registerAggregator(ie.NONE,Ei),this.registerAggregator(ie.RECALCULATE,Ni)}processCollectedValuesWithSumBy(){var e,t,i,o,r,n;for(const s in this.collectedValues)if(!((t=(e=this.collectValuesBy)===null||e===void 0?void 0:e[s])===null||t===void 0)&&t.sumBy)for(const l in this.collectedValues[s]){let d;((i=this.collectValuesBy[s])===null||i===void 0?void 0:i.extendRange)==="sum"?(d=Object.values(this.collectedValues[s][l]).reduce((h,v)=>h+v.value(),0),d+=Math.round(d/20)):(d=Object.values(this.collectedValues[s][l]).reduce((h,v)=>v.value()>h?v.value():h,Number.MIN_SAFE_INTEGER),((o=this.collectValuesBy[s])===null||o===void 0?void 0:o.extendRange)==="max"?d+=Math.round(d/20):typeof((r=this.collectValuesBy[s])===null||r===void 0?void 0:r.extendRange)=="number"&&(d=Math.max(d,(n=this.collectValuesBy[s])===null||n===void 0?void 0:n.extendRange)));const a=Object.values(this.collectedValues[s][l]).reduce((h,v)=>v.value()<h?v.value():h,Number.MAX_SAFE_INTEGER);let u,c;this.needSplitPositiveAndNegative&&(u=Object.values(this.collectedValues[s][l]).reduce((h,v)=>v.positiveValue()>h?v.positiveValue():h,Number.MIN_SAFE_INTEGER),c=Object.values(this.collectedValues[s][l]).reduce((h,v)=>v.negativeValue()<h?v.negativeValue():h,Number.MAX_SAFE_INTEGER)),this.collectedValues[s][l]={},this.collectedValues[s][l].max=d,this.collectedValues[s][l].min=a,this.needSplitPositiveAndNegative&&(this.collectedValues[s][l].positiveMax=u,this.collectedValues[s][l].negativeMin=c)}}processCollectedValuesWithSortBy(){var e,t;const i=this;for(const o in this.collectedValues)if(!((t=(e=this.collectValuesBy)===null||e===void 0?void 0:e[o])===null||t===void 0)&&t.sortBy)for(const r in this.collectedValues[o])this.collectedValues[o][r]=this.collectedValues[o][r].sort((n,s)=>{var l,d,a,u;return((d=(l=i.collectValuesBy[o].sortBy)===null||l===void 0?void 0:l.indexOf(n))!==null&&d!==void 0?d:-1)-((u=(a=i.collectValuesBy[o].sortBy)===null||a===void 0?void 0:a.indexOf(s))!==null&&u!==void 0?u:-1)})}generateCollectedValuesSortRule(){for(const e in this.collectedValues)if(this.collectValuesBy&&this.collectValuesBy[e]&&!this.collectValuesBy[e].sortBy){let t=[];for(const i in this.collectedValues[e])Array.isArray(this.collectedValues[e][i])&&(t.push(...this.collectedValues[e][i]),t=Array.from(new Set(t)));t.length>0&&(this.collectValuesBy[e].sortBy=t)}}processRecords(){var e,t;let i=!1;if(((t=(e=this.filterRules)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0)>=1&&(i=!0),Array.isArray(this.records)){this.filteredRecords||(this.filteredRecords=[]);for(let o=0,r=this.records.length;o<r;o++){const n=this.records[o];i&&!this.filterRecord(n)||(this.filteredRecords.push(n),this.processRecord(n))}}else{this.filteredRecords||(this.filteredRecords={});for(const o in this.records)for(let r=0,n=this.records[o].length;r<n;r++){const s=this.records[o][r];i&&!this.filterRecord(s)||(this.filteredRecords[o]||(this.filteredRecords[o]=[]),this.filteredRecords[o].push(s),this.processRecord(s,o))}}this.rowFlatKeys={},this.colFlatKeys={}}filterRecord(e){var t,i;let o=!0;if(this.filterRules)for(let r=0;r<this.filterRules.length;r++){const n=this.filterRules[r];if(n.filterKey){const s=e[n.filterKey];if(((t=n.filteredValues)===null||t===void 0?void 0:t.indexOf(s))===-1){o=!1;break}}else if(!(!((i=n.filterFunc)===null||i===void 0)&&i.call(n,e))){o=!1;break}}return o}processRecord(e,t){var i,o,r,n,s,l,d,a,u,c,h,v,g,f,C,w,S,H,m,p,I,P,y,T,_,b,K,j,G,X,Z,W,$,se,ne,le,ae,de,he,ue,Ce,_e,we,He,Te,Pe,Se,be,ee,z,U,q,ve,ye,fe,oe,pe,Ie,Be,Ve,ze,ke,je,We,Ue;(i=this.derivedFieldRules)===null||i===void 0||i.forEach((R,A)=>{R.fieldName&&R.derivedFunc&&(e[R.fieldName]=R.derivedFunc(e))});for(const R in this.collectValuesBy)if(M(e[R])){this.collectedValues[R]||(this.collectedValues[R]={});const A=this.collectValuesBy[R].by.map(B=>e[B]).join(this.stringJoinChar);if(this.collectedValues[R][A]||(this.collectValuesBy[R].sumBy?this.collectedValues[R][A]={}:this.collectValuesBy[R].range?this.collectedValues[R][A]={min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}:this.collectedValues[R][A]=[]),this.collectValuesBy[R].sumBy){const B=this.collectValuesBy[R].sumBy.map(k=>e[k]).join(this.stringJoinChar);this.collectedValues[R][A][B]||(this.collectedValues[R][A][B]=new this.aggregators[ie.SUM]({key:R,dimension:R,isRecord:void 0,needSplitPositiveAndNegative:this.needSplitPositiveAndNegative})),this.collectedValues[R][A][B].push(e)}else if(this.collectValuesBy[R].range){const B=this.collectedValues[R][A],k=Math.max(e[R],B.max),Q=Math.min(e[R],B.min);isNaN(k)||(B.max=k,B.min=Q)}else{const B=this.collectedValues[R][A];B.indexOf(e[R])===-1&&B.push(e[R])}}let xe=!1;const qe=[],re=[];if(!this.parseCustomTreeToMatchRecords||!((o=this.dataConfig)===null||o===void 0)&&o.isPivotChart||!(!((r=this.customRowTree)===null||r===void 0)&&r.length)||t||this.hasExtensionRowTree){const R=[];re.push({rowKey:R,indicatorKey:t});for(let A=0,B=this.rows.length;A<B;A++){const k=this.rows[A];if(k in e)this.rowsHasValue[A]=!0,R.push(e[k]);else if(k!==Me){if(!((l=(s=(n=this.dataConfig)===null||n===void 0?void 0:n.totals)===null||s===void 0?void 0:s.row)===null||l===void 0)&&l.showGrandTotals&&A===0&&!this.rows.find(Q=>Q in e)){R.push(this.rowGrandTotalLabel),xe=!0;break}if(!((u=(a=(d=this.dataConfig)===null||d===void 0?void 0:d.totals)===null||a===void 0?void 0:a.row)===null||u===void 0)&&u.subTotalsDimensions&&((v=(h=(c=this.dataConfig)===null||c===void 0?void 0:c.totals)===null||h===void 0?void 0:h.row)===null||v===void 0?void 0:v.subTotalsDimensions.indexOf(this.rows[A-1]))>=0){this.rowHierarchyType==="grid"&&R.push(this.rowSubTotalLabel),xe=!0;break}}}}else{const R=this.getFieldMatchRowDimensionPaths(e);if(R.length>0)for(let A=0,B=R.length;A<B;A++){const k=R[A],Q=[];let V;for(let x=0,J=k.length;x<J;x++)M(k[x].indicatorKey)?V=k[x].indicatorKey:Q.push(k[x].value);re.push({rowKey:Q,indicatorKey:V})}}if(!this.parseCustomTreeToMatchRecords||!((g=this.dataConfig)===null||g===void 0)&&g.isPivotChart||!(!((f=this.customColTree)===null||f===void 0)&&f.length)||t||this.hasExtensionRowTree){const R=[];qe.push({colKey:R,indicatorKey:t});for(let A=0,B=this.columns.length;A<B;A++){const k=this.columns[A];if(k in e)this.columnsHasValue[A]=!0,R.push(e[k]);else if(k!==Me){if(!((S=(w=(C=this.dataConfig)===null||C===void 0?void 0:C.totals)===null||w===void 0?void 0:w.column)===null||S===void 0)&&S.showGrandTotals&&A===0&&!this.columns.find(Q=>Q in e)){R.push(this.colGrandTotalLabel),xe=!0;break}if(!((p=(m=(H=this.dataConfig)===null||H===void 0?void 0:H.totals)===null||m===void 0?void 0:m.column)===null||p===void 0)&&p.subTotalsDimensions&&((y=(P=(I=this.dataConfig)===null||I===void 0?void 0:I.totals)===null||P===void 0?void 0:P.column)===null||y===void 0?void 0:y.subTotalsDimensions.indexOf(this.columns[A-1]))>=0){R.push(this.colSubTotalLabel),xe=!0;break}}}}else{const R=this.getFieldMatchColDimensionPaths(e);if(R.length>0)for(let A=0,B=R.length;A<B;A++){const k=R[A],Q=[];let V;for(let x=0,J=k.length;x<J;x++)M(k[x].indicatorKey)?V=k[x].indicatorKey:Q.push(k[x].value);qe.push({colKey:Q,indicatorKey:V})}}for(let R=0;R<re.length;R++){const A=re[R].rowKey;let B;this.indicatorsAsCol||(B=re[R].indicatorKey);for(let k=0;k<qe.length;k++){const Q=qe[k].colKey;this.indicatorsAsCol&&(B=qe[k].indicatorKey);const V=A.join(this.stringJoinChar),x=Q.join(this.stringJoinChar);if(xe){this.totalRecordsTree[V]||(this.totalRecordsTree[V]={}),this.totalRecordsTree[V][x]||(this.totalRecordsTree[V][x]=[]);const F=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let N=0;N<F.length;N++)if(this.calculatedFiledKeys.indexOf(F[N])>=0){const te=(T=this.calculatedFieldRules)===null||T===void 0?void 0:T.find(Fe=>Fe.key===F[N]);!((b=(_=this.totalRecordsTree[V])===null||_===void 0?void 0:_[x])===null||b===void 0)&&b[N]||(this.totalRecordsTree[V][x][N]=new this.aggregators[ie.RECALCULATE]({key:F[N],dimension:F[N],isRecord:!0,formatFun:(j=(K=this.indicators)===null||K===void 0?void 0:K.find(Fe=>typeof Fe!="string"&&Fe.indicatorKey===F[N]))===null||j===void 0?void 0:j.format,calculateFun:te==null?void 0:te.calculateFun,dependAggregators:this.totalRecordsTree[V][x],dependIndicatorKeys:te==null?void 0:te.dependIndicatorKeys})),F[N]in e&&((X=(G=this.totalRecordsTree[V])===null||G===void 0?void 0:G[x])===null||X===void 0||X[N].push(e))}else{const te=this.getAggregatorRule(F[N]);!((W=(Z=this.totalRecordsTree[V])===null||Z===void 0?void 0:Z[x])===null||W===void 0)&&W[N]||(this.totalRecordsTree[V][x][N]=new this.aggregators[($=te==null?void 0:te.aggregationType)!==null&&$!==void 0?$:ie.SUM]({key:F[N],dimension:(se=te==null?void 0:te.field)!==null&&se!==void 0?se:F[N],formatFun:(ne=te==null?void 0:te.formatFun)!==null&&ne!==void 0?ne:(ae=(le=this.indicators)===null||le===void 0?void 0:le.find(Fe=>typeof Fe!="string"&&Fe.indicatorKey===F[N]))===null||ae===void 0?void 0:ae.format})),F[N]in e&&((he=(de=this.totalRecordsTree[V])===null||de===void 0?void 0:de[x])===null||he===void 0||he[N].push(e))}return}A.length!==0&&(this.rowFlatKeys[V]||(this.rowKeys.push(A),this.rowFlatKeys[V]=1)),Q.length!==0&&(this.colFlatKeys[x]||(this.colKeys.push(Q),this.colFlatKeys[x]=1)),this.tree[V]||(this.tree[V]={}),!((ue=this.tree[V])===null||ue===void 0)&&ue[x]||(this.tree[V][x]=[]);const J=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let F=0;F<J.length;F++)if(this.calculatedFiledKeys.indexOf(J[F])>=0){const N=(Ce=this.calculatedFieldRules)===null||Ce===void 0?void 0:Ce.find(te=>te.key===J[F]);!((we=(_e=this.tree[V])===null||_e===void 0?void 0:_e[x])===null||we===void 0)&&we[F]||(this.tree[V][x][F]=new this.aggregators[ie.RECALCULATE]({key:J[F],dimension:J[F],isRecord:!0,formatFun:(Te=(He=this.indicators)===null||He===void 0?void 0:He.find(te=>typeof te!="string"&&te.indicatorKey===J[F]))===null||Te===void 0?void 0:Te.format,calculateFun:N==null?void 0:N.calculateFun,dependAggregators:this.tree[V][x],dependIndicatorKeys:N==null?void 0:N.dependIndicatorKeys})),(Se=(Pe=this.tree[V])===null||Pe===void 0?void 0:Pe[x])===null||Se===void 0||Se[F].push(e)}else{const N=this.getAggregatorRule(J[F]);let te=!1;B?t===B?J[F]===B&&(te=!0):J[F]===B&&J[F]in e&&(te=!0):N!=null&&N.field?typeof(N==null?void 0:N.field)=="string"?(N==null?void 0:N.field)in e&&(te=!0):N!=null&&N.field.find(Fe=>Fe in e)&&(te=!0):J[F]in e&&(te=!0),!(!((ee=(be=this.tree[V])===null||be===void 0?void 0:be[x])===null||ee===void 0)&&ee[F])&&te&&(this.tree[V][x][F]=new this.aggregators[(z=N==null?void 0:N.aggregationType)!==null&&z!==void 0?z:ie.SUM]({key:J[F],dimension:(U=N==null?void 0:N.field)!==null&&U!==void 0?U:J[F],formatFun:(q=N==null?void 0:N.formatFun)!==null&&q!==void 0?q:(ye=(ve=this.indicators)===null||ve===void 0?void 0:ve.find(Fe=>typeof Fe!="string"&&Fe.indicatorKey===J[F]))===null||ye===void 0?void 0:ye.format})),te&&((oe=(fe=this.tree[V])===null||fe===void 0?void 0:fe[x])===null||oe===void 0||oe[F].push(e))}if(this.mappingRules)for(let F=0;F<this.indicatorKeys.length;F++){if(!this.indicatorStatistics[F]){const N=this.getAggregatorRule(this.indicatorKeys[F]);this.indicatorStatistics[F]={max:new this.aggregators[ie.MAX]({key:this.indicatorKeys[F],dimension:this.indicatorKeys[F]}),min:new this.aggregators[ie.MIN]({key:this.indicatorKeys[F],dimension:this.indicatorKeys[F]}),total:new this.aggregators[(pe=N==null?void 0:N.aggregationType)!==null&&pe!==void 0?pe:ie.SUM]({key:this.indicatorKeys[F],dimension:(Ie=N==null?void 0:N.field)!==null&&Ie!==void 0?Ie:this.indicatorKeys[F],formatFun:(Be=N==null?void 0:N.formatFun)!==null&&Be!==void 0?Be:(ze=(Ve=this.indicators)===null||Ve===void 0?void 0:Ve.find(te=>typeof te!="string"&&te.indicatorKey===this.indicatorKeys[F]))===null||ze===void 0?void 0:ze.format})}}this.indicatorStatistics[F].max.push((je=(ke=this.tree[V])===null||ke===void 0?void 0:ke[x])===null||je===void 0?void 0:je[F].value()),this.indicatorStatistics[F].min.push((Ue=(We=this.tree[V])===null||We===void 0?void 0:We[x])===null||Ue===void 0?void 0:Ue[F].value()),this.indicatorStatistics[F].total.push(e)}}}}updateSortRules(e){var t,i,o,r,n,s,l,d,a,u,c,h,v,g,f,C,w,S;this.sorted=!1,this.sortRules=e,this.sortKeys(),this.customRowTree||(this.rowHierarchyType==="tree"?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((H,m)=>this.rowsHasValue[m]),this.indicatorsAsCol?void 0:this.indicators,((i=(t=this.totals)===null||t===void 0?void 0:t.row)===null||i===void 0?void 0:i.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((H,m)=>this.rowsHasValue[m]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,((r=(o=this.totals)===null||o===void 0?void 0:o.row)===null||r===void 0?void 0:r.showGrandTotals)||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel,this.rowSubTotalLabel,(l=(s=(n=this.totals)===null||n===void 0?void 0:n.row)===null||s===void 0?void 0:s.showGrandTotalsOnTop)!==null&&l!==void 0&&l,(u=(a=(d=this.totals)===null||d===void 0?void 0:d.row)===null||a===void 0?void 0:a.showSubTotalsOnTop)!==null&&u!==void 0&&u)),this.customColTree||(this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((H,m)=>this.columnsHasValue[m]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,((h=(c=this.totals)===null||c===void 0?void 0:c.column)===null||h===void 0?void 0:h.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0,this.colGrandTotalLabel,this.colSubTotalLabel,(f=(g=(v=this.totals)===null||v===void 0?void 0:v.column)===null||g===void 0?void 0:g.showGrandTotalsOnLeft)!==null&&f!==void 0&&f,(S=(w=(C=this.totals)===null||C===void 0?void 0:C.column)===null||w===void 0?void 0:w.showSubTotalsOnLeft)!==null&&S!==void 0&&S))}updateFilterRules(e,t=!1){var i,o;if(this.filterRules=e,this.filteredRecords=void 0,t)this.tree={};else for(const r in this.tree)for(const n in this.tree[r])for(let s=0;s<this.tree[r][n].length;s++)(i=this.tree[r][n][s])===null||i===void 0||i.reset();this.collectedValues={},this.processRecords(),this.processCollectedValuesWithSumBy(),this.processCollectedValuesWithSortBy(),this.totalStatistics(),!((o=this.dataConfig)===null||o===void 0)&&o.isPivotChart&&this.cacheDeminsionCollectedValues()}getAggregatorRule(e){var t;return(t=this.aggregationRules)===null||t===void 0?void 0:t.find((i,o)=>e===i.indicatorKey)}getAggregator(e=[],t=[],i,o=!0,r){var n,s,l,d;const a=this.indicatorKeys.indexOf(i);let u,c;typeof e=="string"?u=e:(r&&r.position!=="row"||e.map((v,g)=>{v!==i||M(r==null?void 0:r.index)&&g!==r.index||e.splice(g,1)}),u=Vt(e,this.stringJoinChar)),typeof t=="string"?c=t:(r&&r.position!=="col"||t.map((v,g)=>{v!==i||M(r==null?void 0:r.index)&&g!==r.index||t.splice(g,1)}),c=Vt(t,this.stringJoinChar));const h=(s=(n=this.tree[u])===null||n===void 0?void 0:n[c])===null||s===void 0?void 0:s[a];if(o&&M((d=(l=this.changedTree[u])===null||l===void 0?void 0:l[c])===null||d===void 0?void 0:d[a])){const v=this.changedTree[u][c][a];return h?{value:()=>v,formatValue:h.formatValue,formatFun:h.formatFun,records:h.records,className:"",recalculate(){},push(){},deleteRecord(){},updateRecord(){},clearCacheValue(){},reset(){}}:{value:()=>v,className:"",push(){},deleteRecord(){},updateRecord(){},recalculate(){},formatValue:()=>v,clearCacheValue(){},reset(){}}}return h||{className:"",push(){},deleteRecord(){},updateRecord(){},recalculate(){},value:()=>null,clearCacheValue(){},reset(){}}}sortKeys(){if(this.colKeys=this.colKeys_normal.slice(),this.rowKeys=this.rowKeys_normal.slice(),!this.sorted){this.sorted=!0,this.rowKeys.sort(this.arrSort(this.rows,!0));const e=this.arrSort(this.columns,!1);this.colKeys.sort(e)}}arrSort(e,t){let i;const o=this,r=(function(n){const s=[];for(let l=0,d=e.length;l<d;l++)if(i=e[l],o.sortRules)for(let a=0,u=o.sortRules.length;a<u;a++)o.sortRules[a].sortField===i&&s.push({field:i,fieldIndex:l,sortRule:o.sortRules[a],func:o.getSort(o.sortRules[a],t)});return s}).call(this);return function(n,s){var l,d,a,u;let c,h;for(let v=0;v<r.length;v++){if(h=r[v],(l=h.sortRule)===null||l===void 0?void 0:l.sortByIndicator){let g=n,f=s;h.fieldIndex<e.length-1&&(g=n.slice(0,h.fieldIndex+1),o.rowHierarchyType==="grid"&&t?g.push(o.rowSubTotalLabel):t||g.push(o.colSubTotalLabel),f=s.slice(0,h.fieldIndex+1),o.rowHierarchyType==="grid"&&t?f.push(o.rowSubTotalLabel):t||f.push(o.colSubTotalLabel)),c=h.func(g,f,(d=h.sortRule)===null||d===void 0?void 0:d.sortType)}else c=(a=h.func)===null||a===void 0?void 0:a.call(h,n[h.fieldIndex],s[h.fieldIndex],(u=h.sortRule)===null||u===void 0?void 0:u.sortType);if(c!==0)return c}return 0}}getSort(e,t){const i=this;return e.sortByIndicator?(o,r,n)=>{const s=function(l,d){return i.rowHierarchyType==="grid"&&l.length<i.rows.length&&l[l.length-1]!==i.rowSubTotalLabel&&l[l.length-1]!==i.rowGrandTotalLabel&&l.push(i.rowSubTotalLabel),d.length<i.columns.length&&d[d.length-1]!==i.colSubTotalLabel&&d[d.length-1]!==i.colGrandTotalLabel&&d.push(i.colSubTotalLabel),i.getAggregator(l,d,e.sortByIndicator).value()};return t?gt(s(o,e.query),s(r,e.query),n):gt(s(e.query,o),s(e.query,r),n)}:e.sortBy?Bi(e.sortBy):e.sortFunc?e.sortFunc:e.sortType?Vi:gt}totalStatistics(){var e,t,i,o,r,n,s,l,d,a,u,c,h,v;const g=this,f=(C,w)=>{var S,H,m,p,I,P,y,T,_,b,K,j,G,X,Z,W,$,se,ne,le,ae,de,he,ue,Ce,_e,we,He,Te,Pe,Se,be,ee,z,U,q,ve,ye,fe,oe,pe,Ie,Be,Ve,ze,ke,je,We,Ue,xe;if(!((H=(S=this.totalRecordsTree)===null||S===void 0?void 0:S[C])===null||H===void 0)&&H[w])return this.tree[C]||(this.tree[C]={}),void(this.tree[C][w]=(p=(m=this.totalRecordsTree)===null||m===void 0?void 0:m[C])===null||p===void 0?void 0:p[w]);const qe=w.split(this.stringJoinChar);if(!((P=(I=g.totals)===null||I===void 0?void 0:I.column)===null||P===void 0)&&P.subTotalsDimensions&&((_=(T=(y=g.totals)===null||y===void 0?void 0:y.column)===null||T===void 0?void 0:T.subTotalsDimensions)===null||_===void 0?void 0:_.length)>0&&g.totals.column.showSubTotals!==!1)for(let re=0,R=(j=(K=(b=g.totals)===null||b===void 0?void 0:b.column)===null||K===void 0?void 0:K.subTotalsDimensions)===null||j===void 0?void 0:j.length;re<R;re++){const A=g.totals.column.subTotalsDimensions[re],B=g.columns.indexOf(A);if(B>=0){const k=qe.slice(0,B+1);k.push(g.colSubTotalLabel);const Q=k.join(this.stringJoinChar);if(!((X=(G=this.totalRecordsTree)===null||G===void 0?void 0:G[C])===null||X===void 0)&&X[Q])return void(this.tree[C][Q]=(W=(Z=this.totalRecordsTree)===null||Z===void 0?void 0:Z[C])===null||W===void 0?void 0:W[Q]);this.tree[C][Q]||(this.tree[C][Q]=[]);const V=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let x=0;x<V.length;x++)if(this.calculatedFiledKeys.indexOf(V[x])>=0){const J=($=this.calculatedFieldRules)===null||$===void 0?void 0:$.find(F=>F.key===V[x]);!((ne=(se=this.tree[C])===null||se===void 0?void 0:se[Q])===null||ne===void 0)&&ne[x]||(this.tree[C][Q][x]=new this.aggregators[ie.RECALCULATE]({key:V[x],dimension:V[x],isRecord:!0,formatFun:(ae=(le=this.indicators)===null||le===void 0?void 0:le.find(F=>typeof F!="string"&&F.indicatorKey===V[x]))===null||ae===void 0?void 0:ae.format,calculateFun:J==null?void 0:J.calculateFun,dependAggregators:this.tree[C][Q],dependIndicatorKeys:J==null?void 0:J.dependIndicatorKeys})),Q!==w&&this.tree[C][Q][x].push((he=(de=g.tree[C])===null||de===void 0?void 0:de[w])===null||he===void 0?void 0:he[x])}else{if(!this.tree[C][Q][x]){const J=this.getAggregatorRule(V[x]);this.tree[C][Q][x]=new this.aggregators[(ue=J==null?void 0:J.aggregationType)!==null&&ue!==void 0?ue:ie.SUM]({key:V[x],dimension:(Ce=J==null?void 0:J.field)!==null&&Ce!==void 0?Ce:V[x],formatFun:(_e=J==null?void 0:J.formatFun)!==null&&_e!==void 0?_e:(He=(we=this.indicators)===null||we===void 0?void 0:we.find(F=>typeof F!="string"&&F.indicatorKey===V[x]))===null||He===void 0?void 0:He.format})}Q!==w&&this.tree[C][Q][x].push((Pe=(Te=g.tree[C])===null||Te===void 0?void 0:Te[w])===null||Pe===void 0?void 0:Pe[x])}}}if(!((be=(Se=g.totals)===null||Se===void 0?void 0:Se.column)===null||be===void 0)&&be.showGrandTotals||this.rows.length===0){const re=g.colGrandTotalLabel;if(!((z=(ee=this.totalRecordsTree)===null||ee===void 0?void 0:ee[C])===null||z===void 0)&&z[re])return void(this.tree[C][re]=(q=(U=this.totalRecordsTree)===null||U===void 0?void 0:U[C])===null||q===void 0?void 0:q[re]);this.tree[C][re]||(this.tree[C][re]=[]);const R=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let A=0;A<R.length;A++)if(this.calculatedFiledKeys.indexOf(R[A])>=0){const B=(ve=this.calculatedFieldRules)===null||ve===void 0?void 0:ve.find(k=>k.key===R[A]);!((fe=(ye=this.tree[C])===null||ye===void 0?void 0:ye[re])===null||fe===void 0)&&fe[A]||(this.tree[C][re][A]=new this.aggregators[ie.RECALCULATE]({key:R[A],dimension:R[A],isRecord:!0,formatFun:(pe=(oe=this.indicators)===null||oe===void 0?void 0:oe.find(k=>typeof k!="string"&&k.indicatorKey===R[A]))===null||pe===void 0?void 0:pe.format,calculateFun:B==null?void 0:B.calculateFun,dependAggregators:this.tree[C][re],dependIndicatorKeys:B==null?void 0:B.dependIndicatorKeys})),re!==w&&this.tree[C][re][A].push((Be=(Ie=g.tree[C])===null||Ie===void 0?void 0:Ie[w])===null||Be===void 0?void 0:Be[A])}else{if(!this.tree[C][re][A]){const B=this.getAggregatorRule(R[A]);this.tree[C][re][A]=new this.aggregators[(Ve=B==null?void 0:B.aggregationType)!==null&&Ve!==void 0?Ve:ie.SUM]({key:R[A],dimension:(ze=B==null?void 0:B.field)!==null&&ze!==void 0?ze:R[A],formatFun:(ke=B==null?void 0:B.formatFun)!==null&&ke!==void 0?ke:(We=(je=this.indicators)===null||je===void 0?void 0:je.find(k=>typeof k!="string"&&k.indicatorKey===R[A]))===null||We===void 0?void 0:We.format})}re!==w&&this.tree[C][re][A].push((xe=(Ue=g.tree[C])===null||Ue===void 0?void 0:Ue[w])===null||xe===void 0?void 0:xe[A])}}};if(!((t=(e=g==null?void 0:g.totals)===null||e===void 0?void 0:e.column)===null||t===void 0)&&t.subTotalsDimensions&&((r=(o=(i=g==null?void 0:g.totals)===null||i===void 0?void 0:i.column)===null||o===void 0?void 0:o.subTotalsDimensions)===null||r===void 0?void 0:r.length)>=1||!((s=(n=g==null?void 0:g.totals)===null||n===void 0?void 0:n.row)===null||s===void 0)&&s.subTotalsDimensions&&((a=(d=(l=g==null?void 0:g.totals)===null||l===void 0?void 0:l.row)===null||d===void 0?void 0:d.subTotalsDimensions)===null||a===void 0?void 0:a.length)>=1||!((c=(u=g==null?void 0:g.totals)===null||u===void 0?void 0:u.column)===null||c===void 0)&&c.showGrandTotals||!((v=(h=g==null?void 0:g.totals)===null||h===void 0?void 0:h.row)===null||v===void 0)&&v.showGrandTotals){const C=[];Object.keys(g.tree).forEach(w=>{const S=w.split(this.stringJoinChar);Object.keys(g.tree[w]).forEach(H=>{var m,p,I,P,y,T,_,b,K,j,G,X,Z,W,$,se,ne,le,ae,de,he,ue,Ce,_e,we,He,Te,Pe,Se,be;if(!((p=(m=g.totals)===null||m===void 0?void 0:m.row)===null||p===void 0)&&p.subTotalsDimensions&&((y=(P=(I=g.totals)===null||I===void 0?void 0:I.row)===null||P===void 0?void 0:P.subTotalsDimensions)===null||y===void 0?void 0:y.length)>0&&g.totals.row.showSubTotals!==!1)for(let ee=0,z=(b=(_=(T=g.totals)===null||T===void 0?void 0:T.row)===null||_===void 0?void 0:_.subTotalsDimensions)===null||b===void 0?void 0:b.length;ee<z;ee++){const U=g.totals.row.subTotalsDimensions[ee],q=g.rows.indexOf(U);if(q>=0&&q<g.rows.length-1){const ve=S.slice(0,q+1);this.rowHierarchyType==="grid"&&ve.push(g.rowSubTotalLabel);const ye=ve.join(this.stringJoinChar);this.tree[ye]||(this.tree[ye]={},C.push(ye)),this.tree[ye][H]||(this.tree[ye][H]=[]);const fe=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let oe=0;oe<fe.length;oe++){if(!this.tree[ye][H][oe])if(this.calculatedFiledKeys.indexOf(fe[oe])>=0){const pe=(K=this.calculatedFieldRules)===null||K===void 0?void 0:K.find(Ie=>Ie.key===fe[oe]);this.tree[ye][H][oe]=new this.aggregators[ie.RECALCULATE]({key:fe[oe],dimension:fe[oe],isRecord:!0,formatFun:(G=(j=this.indicators)===null||j===void 0?void 0:j.find(Ie=>typeof Ie!="string"&&Ie.indicatorKey===fe[oe]))===null||G===void 0?void 0:G.format,calculateFun:pe==null?void 0:pe.calculateFun,dependAggregators:this.tree[ye][H],dependIndicatorKeys:pe==null?void 0:pe.dependIndicatorKeys})}else{const pe=this.getAggregatorRule(fe[oe]);this.tree[ye][H][oe]=new this.aggregators[(X=pe==null?void 0:pe.aggregationType)!==null&&X!==void 0?X:ie.SUM]({key:fe[oe],dimension:(Z=pe==null?void 0:pe.field)!==null&&Z!==void 0?Z:fe[oe],formatFun:(W=pe==null?void 0:pe.formatFun)!==null&&W!==void 0?W:(se=($=this.indicators)===null||$===void 0?void 0:$.find(Ie=>typeof Ie!="string"&&Ie.indicatorKey===fe[oe]))===null||se===void 0?void 0:se.format})}ye!==w&&this.tree[ye][H][oe].push((le=(ne=g.tree[w])===null||ne===void 0?void 0:ne[H])===null||le===void 0?void 0:le[oe])}}}if(!((de=(ae=g.totals)===null||ae===void 0?void 0:ae.row)===null||de===void 0)&&de.showGrandTotals||this.columns.length===0){const ee=g.rowGrandTotalLabel;this.tree[ee]||(this.tree[ee]={},C.push(ee)),this.tree[ee][H]||(this.tree[ee][H]=[]);const z=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let U=0;U<z.length;U++){if(!this.tree[ee][H][U])if(this.calculatedFiledKeys.indexOf(z[U])>=0){const q=(he=this.calculatedFieldRules)===null||he===void 0?void 0:he.find(ve=>ve.key===z[U]);this.tree[ee][H][U]=new this.aggregators[ie.RECALCULATE]({key:z[U],dimension:z[U],isRecord:!0,formatFun:(Ce=(ue=this.indicators)===null||ue===void 0?void 0:ue.find(ve=>typeof ve!="string"&&ve.indicatorKey===z[U]))===null||Ce===void 0?void 0:Ce.format,calculateFun:q==null?void 0:q.calculateFun,dependAggregators:this.tree[ee][H],dependIndicatorKeys:q==null?void 0:q.dependIndicatorKeys})}else{const q=this.getAggregatorRule(z[U]);this.tree[ee][H][U]=new this.aggregators[(_e=q==null?void 0:q.aggregationType)!==null&&_e!==void 0?_e:ie.SUM]({key:z[U],dimension:(we=q==null?void 0:q.field)!==null&&we!==void 0?we:z[U],formatFun:(He=q==null?void 0:q.formatFun)!==null&&He!==void 0?He:(Pe=(Te=this.indicators)===null||Te===void 0?void 0:Te.find(ve=>typeof ve!="string"&&ve.indicatorKey===z[U]))===null||Pe===void 0?void 0:Pe.format})}ee!==w&&this.tree[ee][H][U].push((be=(Se=g.tree[w])===null||Se===void 0?void 0:Se[H])===null||be===void 0?void 0:be[U])}}f(w,H)})}),C.forEach(w=>{Object.keys(g.tree[w]).forEach(S=>{f(w,S)})})}for(const C in g.totalRecordsTree)for(const w in g.totalRecordsTree[C])f(C,w)}ArrToTree1(e,t,i,o,r){const n=[],s=this.stringJoinChar,l=new Map;function d(a){const u=[];let c;a.forEach((h,v)=>{var g;u.push(h);const f=u.join(s);let C=l.get(f);C||(C={value:h,dimensionKey:t[v],children:v===a.length-1&&((g=i==null?void 0:i.length)!==null&&g!==void 0?g:0)>=1?i==null?void 0:i.map(w=>typeof w=="string"?{indicatorKey:w,value:w}:{indicatorKey:w.indicatorKey,value:w.title}):[]},l.set(f,C),c?c.children.push(C):n.push(C)),c=C})}return e.forEach(a=>d(a)),o&&d([r]),n}ArrToTree(e,t,i,o,r,n,s,l,d){var a;let u=[];const c=this.stringJoinChar,h=new Map;if(e!=null&&e.length?e.forEach(v=>function(g){const f=[];let C;g.forEach((w,S)=>{var H,m,p,I;f.push(w);const P=f.join(c);let y=h.get(P);if(!y){if(y={value:w,dimensionKey:t[S],children:S===g.length-1&&((H=i==null?void 0:i.length)!==null&&H!==void 0?H:0)>=1?i==null?void 0:i.map(T=>typeof T=="string"?{indicatorKey:T,value:T}:{indicatorKey:T.indicatorKey,value:T.title}):[]},o[S]){let T=(m=y.children)!==null&&m!==void 0?m:[];const _={value:s,dimensionKey:t[S+1],levelSpan:o.length-S-1,children:((p=i==null?void 0:i.length)!==null&&p!==void 0?p:0)>=1?i==null?void 0:i.map(b=>typeof b=="string"?{indicatorKey:b,value:b}:{indicatorKey:b.indicatorKey,value:b.title}):[]};T.push(_),T=(I=_.children)!==null&&I!==void 0?I:[]}h.set(P,y),C?o[S-1]&&!d?C.children.splice(C.children.length-1,0,y):C.children.push(y):u.push(y)}C=y})}(v)):i&&(u=i==null?void 0:i.map(v=>{var g;return typeof v=="string"?{indicatorKey:v,value:v}:{indicatorKey:v.indicatorKey,value:(g=v.title)!==null&&g!==void 0?g:v.indicatorKey}})),r&&(e==null?void 0:e.length)){const v={value:n,dimensionKey:t[0],levelSpan:o.length,children:(a=i==null?void 0:i.map(g=>typeof g=="string"?{indicatorKey:g,value:g}:{indicatorKey:g.indicatorKey,value:g.title}))!==null&&a!==void 0?a:[]};l?u.unshift(v):u.push(v)}return u}cacheDeminsionCollectedValues(){for(const e in this.collectValuesBy)this.collectValuesBy[e].type!=="xField"&&this.collectValuesBy[e].type!=="yField"||(this.dataConfig.dimensionSortArray?this.cacheCollectedValues[e]=io(this.collectedValues[e],this.dataConfig.dimensionSortArray):this.cacheCollectedValues[e]=this.collectedValues[e])}changeTreeNodeValue(e=[],t=[],i,o){var r,n,s;const l=this.indicatorKeys.indexOf(i);let d,a;d=typeof e=="string"?e:e.join(this.stringJoinChar),a=typeof t=="string"?t:t.join(this.stringJoinChar),!((r=this.changedTree[d])===null||r===void 0)&&r[a]?this.changedTree[d][a][l]=o:this.changedTree[d]?(this.changedTree[d][a]=[],this.changedTree[d][a][l]=o):(this.changedTree[d]={},this.changedTree[d][a]=[],this.changedTree[d][a][l]=o);const u=(s=(n=this.tree[d])===null||n===void 0?void 0:n[a])===null||s===void 0?void 0:s[l];(u==null?void 0:u.records.length)===1&&(u.records[0][this.indicatorKeys[l]]=o)}changeRecordFieldValue(e,t,i){let o=!1;for(let r=0;r<this.indicatorKeys.length;r++)this.indicatorKeys[r]===e&&(o=!0);if(!o){if(Array.isArray(this.records))for(let r=0,n=this.records.length;r<n;r++){const s=this.records[r];s[e]===t&&(s[e]=i)}else for(const r in this.records)for(let n=0,s=this.records[r].length;n<s;n++){const l=this.records[r][n];l[e]===t&&(l[e]=i)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}_rowTreeHasChanged(){this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))}changeDataConfig(e){this.rows=e.rows,this.columns=e.columns}addRecords(e){for(let t=0,i=e.length;t<i;t++){const o=e[t];this.processRecord(o)}Array.isArray(this.records)&&this.records.push(e)}customTreeToDimensionPathArr(e,t){const i=[],o=this;function r(n,s){var l,d,a;n.virtual||(!((l=s[s.length-1])===null||l===void 0)&&l.childKeys&&n.dimensionKey&&s[s.length-1].childKeys.indexOf(n.dimensionKey)===-1&&n.dimensionKey!==s[s.length-1].dimensionKey&&s[s.length-1].childKeys.push(n.dimensionKey),s.push({dimensionKey:M(n.indicatorKey)?void 0:n.dimensionKey,value:n.value,indicatorKey:n.indicatorKey,virtual:n.virtual})),((d=n.children)===null||d===void 0?void 0:d.length)>0?(o.rowHierarchyType==="tree"&&t==="row"&&(s[s.length-1].childKeys=[],i.push([...s])),(a=n.children)===null||a===void 0||a.forEach(u=>r(u,[...s]))):i.push(s)}return e==null||e.forEach(n=>r(n,[])),i}getFieldMatchColDimensionPaths(e){var t,i;const o=[];for(let r=0;(i=r<((t=this.customColTreeDimensionPaths)===null||t===void 0?void 0:t.length))!==null&&i!==void 0&&i;r++){const n=this.customColTreeDimensionPaths[r];let s=!0;for(let l=0;l<n.length;l++){const d=n[l];if(d.dimensionKey&&e[d.dimensionKey]!==d.value||d.indicatorKey&&e[d.indicatorKey]===void 0){s=!1;break}}s&&o.push(n)}return o}getFieldMatchRowDimensionPaths(e){var t,i;const o=[];for(let r=0;(i=r<((t=this.customRowTreeDimensionPaths)===null||t===void 0?void 0:t.length))!==null&&i!==void 0&&i;r++){const n=this.customRowTreeDimensionPaths[r];let s=!0;for(let l=0;l<n.length;l++){const d=n[l];if(d.dimensionKey&&e[d.dimensionKey]!==d.value||d.indicatorKey&&e[d.indicatorKey]===void 0){s=!1;break}if(d.childKeys&&l===n.length-1&&d.childKeys.length>0&&d.childKeys.find(a=>M(e[a]))){s=!1;break}}s&&(this.indicatorsAsCol||this.rowHierarchyType!=="tree"||n.find(l=>l.indicatorKey)||(s=!1)),s&&o.push(n)}return o}}function io(D,e){return D.sort((t,i)=>{const o=e.indexOf(t),r=e.indexOf(i);return o<r?-1:o>r?1:0})}class oo extends Wt{constructor(e,t){var i,o,r,n,s,l,d,a,u,c,h,v,g,f,C,w;if(ft.mode==="node"?(t=e,e=null):e instanceof HTMLElement||(t=e,e=e.container?e.container:null),super(e,t),this.layoutNodeId={seqId:0},t){t.layout&&Object.assign(t,t.layout),this.internalProps.columns=ge(t.columns),this.internalProps.rows=ge(t.rows),this.internalProps.indicators=nt(t.indicators),(i=t.indicators)===null||i===void 0||i.forEach((H,m)=>{typeof H=="object"&&(H!=null&&H.editor)&&(this.internalProps.indicators[m].editor=H.editor)}),this.internalProps.columnTree=!t.indicatorsAsCol||!((o=t.columns)===null||o===void 0)&&o.length||t.columnTree?ge(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||!((r=t.rows)===null||r===void 0)&&r.length||t.rowTree?ge(t.rowTree):[],this.internalProps.records=t.records,this.pagination=t.pagination,this.internalProps.columnResizeType=(n=t.columnResizeType)!==null&&n!==void 0?n:"column",this.internalProps.rowResizeType=(s=t.rowResizeType)!==null&&s!==void 0?s:"row",this.internalProps.dataConfig=ge(t.dataConfig),this.internalProps.columnWidthConfig=t.columnWidthConfig;const S=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,((l=S==null?void 0:S[0])===null||l===void 0?void 0:l.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),((d=t.customConfig)===null||d===void 0?void 0:d.enableDataAnalysis)===!1){const H=new ce((a=this.internalProps.columnTree)!==null&&a!==void 0?a:[],this.layoutNodeId),m=new ce((u=this.internalProps.rowTree)!==null&&u!==void 0?u:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(c=this.options.rowExpandLevel)!==null&&c!==void 0?c:1:void 0);this.internalProps.layoutMap=new Ee(this,null,H,m),this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new yt({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey},S))}else{const H=Lt(this,t),{rowKeys:m,columnKeys:p,indicatorKeys:I}=H;let{columnDimensionTree:P,rowDimensionTree:y}=H;this.dataset=new at(this.internalProps.dataConfig,m,p,I,this.internalProps.indicators,(h=t.indicatorsAsCol)===null||h===void 0||h,t.records,t.rowHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!t.extensionRows,!!t.parseCustomTreeToMatchRecords),t.columnTree||(t.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Ae(this.dataset.colHeaderTree,t.indicators)),P=new ce((v=this.dataset.colHeaderTree)!==null&&v!==void 0?v:[],this.layoutNodeId)),t.rowTree||(t.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Ae(this.dataset.rowHeaderTree,t.indicators)),y=new ce((g=this.dataset.rowHeaderTree)!==null&&g!==void 0?g:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(f=this.options.rowExpandLevel)!==null&&f!==void 0?f:1:void 0)),this.internalProps.layoutMap=new Ee(this,this.dataset,P,y)}if(this._changePivotSortStateBySortRules(),((w=(C=t.pivotSortState)===null||C===void 0?void 0:C.length)!==null&&w!==void 0?w:0)>0&&(this.pivotSortState=[],this.pivotSortState=t.pivotSortState),ft.mode!=="node"&&(this.editorManager=new zi(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.stateManager.initCheckedState(S),this.scenegraph.createSceneGraph(),t.title){const H=Le.getComponent("title");this.internalProps.title=new H(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)this.internalProps.emptyTip.resetVisible();else{const H=Le.getComponent("emptyTip");this.internalProps.emptyTip=new H(this.options.emptyTip,this),this.internalProps.emptyTip.resetVisible()}setTimeout(()=>{this.fireListeners(st.INITIALIZED,null)},0)}}static get EVENT_TYPE(){return Ct}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!1}get recordsCount(){var e;return(e=this.records)===null||e===void 0?void 0:e.length}_canResizeColumn(e,t){const i=super._canResizeColumn(e,t);if(i){if(this.internalProps.layoutMap.isSeriesNumber(e,t)&&this.internalProps.rowSeriesNumber.disableColumnResize===!0)return!1;if(!this.internalProps.layoutMap.indicatorsAsCol){const o=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(o!=null&&o.disableColumnResize)return!1}}return i}updateOption(e){var t,i,o,r,n,s,l,d,a,u,c,h,v,g,f,C,w,S;const H=this.internalProps;if(super.updateOption(e),this.layoutNodeId={seqId:0},this.internalProps.columns=ge(e.columns),this.internalProps.rows=ge(e.rows),this.internalProps.indicators=!((t=e.indicators)===null||t===void 0)&&t.length?nt(e.indicators):[],(i=e.indicators)===null||i===void 0||i.forEach((p,I)=>{typeof p=="object"&&(p!=null&&p.editor)&&(this.internalProps.indicators[I].editor=p.editor)}),this.internalProps.columnTree=!e.indicatorsAsCol||!((o=e.columns)===null||o===void 0)&&o.length||e.columnTree?ge(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||!((r=e.rows)===null||r===void 0)&&r.length||e.rowTree?ge(e.rowTree):[],e.records&&(this.internalProps.records=e.records),this.stateManager.initCheckedState(this.internalProps.records),this.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1),this.pagination=e.pagination,H.columnResizeType=(n=e.columnResizeType)!==null&&n!==void 0?n:"column",H.rowResizeType=(s=e.rowResizeType)!==null&&s!==void 0?s:"row",H.dataConfig=ge(e.dataConfig),this.internalProps.columnWidthConfig=e.columnWidthConfig,(e==null?void 0:e.rowHierarchyType)==="tree"&&this.internalProps.layoutMap.rowHierarchyType==="tree"&&this.internalProps.layoutMap.rowExpandLevel===(e==null?void 0:e.rowExpandLevel)){const p=this.internalProps.layoutMap.rowDimensionTree.tree.children;(l=this.internalProps.rowTree)===null||l===void 0||l.forEach((I,P)=>{const y=p.find(T=>T.dimensionKey===I.dimensionKey&&T.value===I.value);y&&this._syncHierarchyState(y,I)})}const m=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,((d=m==null?void 0:m[0])===null||d===void 0?void 0:d.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),((a=e.customConfig)===null||a===void 0?void 0:a.enableDataAnalysis)===!1){let p,I;e.columnTree&&(p=new ce((u=this.internalProps.columnTree)!==null&&u!==void 0?u:[],this.layoutNodeId)),e.rowTree&&(I=new ce((c=this.internalProps.rowTree)!==null&&c!==void 0?c:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(h=this.options.rowExpandLevel)!==null&&h!==void 0?h:1:void 0)),H.layoutMap=new Ee(this,null,p,I),this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new yt({rows:H.layoutMap.fullRowDimensionKeys,columns:H.layoutMap.colDimensionKeys,indicators:H.layoutMap.indicatorKeys,indicatorsAsCol:H.layoutMap.indicatorsAsCol,indicatorDimensionKey:H.layoutMap.indicatorDimensionKey},m))}else{const p=Lt(this,e),{rowKeys:I,columnKeys:P,indicatorKeys:y}=p;let{columnDimensionTree:T,rowDimensionTree:_}=p;this.dataset=new at(H.dataConfig,I,P,y,this.internalProps.indicators,(v=e.indicatorsAsCol)===null||v===void 0||v,m,e.rowHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!e.extensionRows,!!e.parseCustomTreeToMatchRecords),e.columnTree||(e.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Ae(this.dataset.colHeaderTree,e.indicators)),T=new ce((g=this.dataset.colHeaderTree)!==null&&g!==void 0?g:[],this.layoutNodeId)),e.rowTree||(e.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Ae(this.dataset.rowHeaderTree,e.indicators)),_=new ce((f=this.dataset.rowHeaderTree)!==null&&f!==void 0?f:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(C=this.options.rowExpandLevel)!==null&&C!==void 0?C:1:void 0)),H.layoutMap=new Ee(this,this.dataset,T,_)}if(this._changePivotSortStateBySortRules(),((S=(w=e.pivotSortState)===null||w===void 0?void 0:w.length)!==null&&S!==void 0?S:0)>0&&(this.pivotSortState=[],this.pivotSortState=e.pivotSortState),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,H.releaseList&&(H.releaseList.forEach(p=>{var I;return(I=p==null?void 0:p.release)===null||I===void 0?void 0:I.call(p)}),H.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),e.title){const p=Le.getComponent("title");this.internalProps.title=new p(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)this.internalProps.emptyTip.resetVisible();else{const p=Le.getComponent("emptyTip");this.internalProps.emptyTip=new p(this.options.emptyTip,this),this.internalProps.emptyTip.resetVisible()}return new Promise(p=>{setTimeout(p,0)})}updatePagination(e){e?(this.pagination||(this.pagination={currentPage:0,perPageCount:0}),typeof e.currentPage=="number"&&e.currentPage>=0&&(this.pagination.currentPage=e.currentPage),e.perPageCount&&(this.pagination.perPageCount=e.perPageCount||this.pagination.perPageCount),this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(this.pagination),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()):this.pagination&&(this.pagination=void 0,this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(void 0),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render())}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,i,o,r,n,s,l,d;const a=this,{layoutMap:u}=a.internalProps;u&&(a.colCount=(e=u.colCount)!==null&&e!==void 0?e:0,a.rowCount=(t=u.rowCount)!==null&&t!==void 0?t:0,this.internalProps.frozenColCount=Math.max(((i=u.rowHeaderLevelCount)!==null&&i!==void 0?i:0)+u.leftRowSeriesNumberColumnCount,(o=this.options.frozenColCount)!==null&&o!==void 0?o:0),a.frozenRowCount=Math.max(u.headerLevelCount,(r=this.options.frozenRowCount)!==null&&r!==void 0?r:0),a.bottomFrozenRowCount!==((n=this.options.bottomFrozenRowCount)!==null&&n!==void 0?n:0)&&(a.bottomFrozenRowCount=(s=this.options.bottomFrozenRowCount)!==null&&s!==void 0?s:0),a.rightFrozenColCount!==((l=this.options.rightFrozenColCount)!==null&&l!==void 0?l:0)&&(a.rightFrozenColCount=(d=this.options.rightFrozenColCount)!==null&&d!==void 0?d:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}_getSortFuncFromHeaderOption(e,t,i){}get rowHierarchyType(){return this.internalProps.layoutMap.rowHierarchyType}_syncHierarchyState(e,t){var i,o;e.value===t.value&&e.dimensionKey===t.dimensionKey&&(t.hierarchyState=(i=t.hierarchyState)!==null&&i!==void 0?i:t!=null&&t.children?e.hierarchyState:void 0,(o=t==null?void 0:t.children)===null||o===void 0||o.forEach((r,n)=>{var s;if(!((s=e==null?void 0:e.children)===null||s===void 0)&&s[n]&&r){const l=e.children.find(d=>d.dimensionKey===r.dimensionKey&&d.value===r.value);l&&this._syncHierarchyState(l,r)}}))}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByCol(e)}getFieldData(e,t,i){var o,r,n;if(!this.internalProps.layoutMap.isHeader(t,i)){if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(i),l=this.getBodyIndexByCol(t);return(o=this.records[s])===null||o===void 0?void 0:o[l]}if(this.dataset){const s=this.internalProps.layoutMap.getCellHeaderPaths(t,i);if(s){let l;const d=(r=s.colHeaderPaths)===null||r===void 0?void 0:r.filter(c=>!c.virtual).map((c,h)=>{var v;return c.indicatorKey&&(l={position:"col",index:h}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),a=(n=s.rowHeaderPaths)===null||n===void 0?void 0:n.filter(c=>!c.virtual).map((c,h)=>{var v;return c.indicatorKey&&(l={position:"row",index:h}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),u=this.dataset.getAggregator(a,d,this.internalProps.layoutMap.getIndicatorKey(t,i),!0,l);if(u.records&&u.records.length>=1)return u.records[0][e]}}else if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(t,i),l=s.colHeaderPaths.map(u=>{var c;return(c=u.indicatorKey)!==null&&c!==void 0?c:u.value}),d=s.rowHeaderPaths.map(u=>{var c;return(c=u.indicatorKey)!==null&&c!==void 0?c:u.value}),a=this.flatDataToObjects.getTreeNode(d,l,this.internalProps.layoutMap.getBody(t,i).indicatorKey,!1);if(a!=null&&a.record)return a==null?void 0:a.record[e]}}}getCellValue(e,t,i){var o,r,n,s,l,d,a;if(!i){const u=this.getCustomMergeValue(e,t);if(u)return u}if(this.internalProps.layoutMap.isSeriesNumber(e,t)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)){const{title:c}=this.internalProps.layoutMap.getSeriesNumberHeader(e,t);return c}const{format:u}=this.internalProps.layoutMap.getSeriesNumberBody(e,t);return typeof u=="function"?u(e,t,this):t-this.columnHeaderLevelCount+1}if(this.internalProps.layoutMap.isHeader(e,t)){const{title:u,fieldFormat:c}=this.internalProps.layoutMap.getHeader(e,t);return typeof c=="function"?c(u,e,t,this):u}if(this.internalProps.recordsIsTwoDimensionalArray){const{fieldFormat:u}=this.internalProps.layoutMap.getBody(e,t),c=this.getBodyIndexByRow(t),h=this.getBodyIndexByCol(e),v=(o=this.records[c])===null||o===void 0?void 0:o[h];return typeof u=="function"?u(v,e,t,this):v}if(this.dataset){const u=this.internalProps.layoutMap.getCellHeaderPaths(e,t);let c;const h=(n=(r=u.colHeaderPaths)===null||r===void 0?void 0:r.filter(C=>!C.virtual))===null||n===void 0?void 0:n.map((C,w)=>{var S;return C.indicatorKey&&(c={position:"col",index:w}),(S=C.indicatorKey)!==null&&S!==void 0?S:C.value}),v=(l=(s=u.rowHeaderPaths)===null||s===void 0?void 0:s.filter(C=>!C.virtual))===null||l===void 0?void 0:l.map((C,w)=>{var S;return C.indicatorKey&&(c={position:"row",index:w}),(S=C.indicatorKey)!==null&&S!==void 0?S:C.value}),g=this.dataset.getAggregator(v,h,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,c),{fieldFormat:f}=this.internalProps.layoutMap.getBody(e,t);return g.formatValue?g.formatValue(e,t,this):typeof f=="function"?f(g==null?void 0:g.value(),e,t,this):(d=g==null?void 0:g.value())!==null&&d!==void 0?d:""}if(this.flatDataToObjects){const u=this.internalProps.layoutMap.getCellHeaderPaths(e,t),c=u.colHeaderPaths.map(f=>{var C;return(C=f.indicatorKey)!==null&&C!==void 0?C:f.value}),h=u.rowHeaderPaths.map(f=>{var C;return(C=f.indicatorKey)!==null&&C!==void 0?C:f.value}),v=this.flatDataToObjects.getTreeNode(h,c,this.internalProps.layoutMap.getBody(e,t).indicatorKey),{fieldFormat:g}=this.internalProps.layoutMap.getBody(e,t);return typeof g=="function"?g(v==null?void 0:v.value,e,t,this):(a=v==null?void 0:v.value)!==null&&a!==void 0?a:""}}getCellOriginValue(e,t){var i,o,r;const n=this;if(n.internalProps.layoutMap.isHeader(e,t)){const{title:s}=n.internalProps.layoutMap.getHeader(e,t);return typeof s=="function"?s():s}if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(t),l=this.getBodyIndexByCol(e);return(i=this.records[s])===null||i===void 0?void 0:i[l]}if(this.dataset){let s;const l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),d=(o=l.colHeaderPaths)===null||o===void 0?void 0:o.filter(c=>!c.virtual).map((c,h)=>{var v;return c.indicatorKey&&(s={position:"col",index:h}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),a=(r=l.rowHeaderPaths)===null||r===void 0?void 0:r.filter(c=>!c.virtual).map((c,h)=>{var v;return c.indicatorKey&&(s={position:"row",index:h}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),u=this.dataset.getAggregator(a,d,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,s);return u.value?u.value():void 0}if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=s.colHeaderPaths.map(u=>{var c;return(c=u.indicatorKey)!==null&&c!==void 0?c:u.value}),d=s.rowHeaderPaths.map(u=>{var c;return(c=u.indicatorKey)!==null&&c!==void 0?c:u.value}),a=this.flatDataToObjects.getTreeNode(d,l,this.internalProps.layoutMap.getBody(e,t).indicatorKey);return a==null?void 0:a.value}}getCellRawValue(e,t){var i,o,r;const n=this;if(n.internalProps.layoutMap.isHeader(e,t)){const{title:s}=n.internalProps.layoutMap.getHeader(e,t);return typeof s=="function"?s():s}if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(t),l=this.getBodyIndexByCol(e);return(i=this.records[s])===null||i===void 0?void 0:i[l]}if(this.dataset){let s;const l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),d=(o=l.colHeaderPaths)===null||o===void 0?void 0:o.filter(c=>!c.virtual).map((c,h)=>{var v;return c.indicatorKey&&(s={position:"col",index:h}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),a=(r=l.rowHeaderPaths)===null||r===void 0?void 0:r.filter(c=>!c.virtual).map((c,h)=>{var v;return c.indicatorKey&&(s={position:"row",index:h}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),u=this.dataset.getAggregator(a,d,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,s);return u.value?u.value():void 0}if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=s.colHeaderPaths.map(u=>{var c;return(c=u.indicatorKey)!==null&&c!==void 0?c:u.value}),d=s.rowHeaderPaths.map(u=>{var c;return(c=u.indicatorKey)!==null&&c!==void 0?c:u.value}),a=this.flatDataToObjects.getTreeNode(d,l,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1);return a==null?void 0:a.value}}getCellOriginRecord(e,t){var i,o,r;if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray){const n=this.getBodyIndexByRow(t),s=this.getBodyIndexByCol(e);return(i=this.records[n])===null||i===void 0?void 0:i[s]}if(this.dataset){let n;const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=(o=s.colHeaderPaths)===null||o===void 0?void 0:o.filter(a=>!a.virtual).map((a,u)=>{var c;return a.indicatorKey&&(n={position:"col",index:u}),(c=a.indicatorKey)!==null&&c!==void 0?c:a.value}),d=(r=s.rowHeaderPaths)===null||r===void 0?void 0:r.filter(a=>!a.virtual).map((a,u)=>{var c;return a.indicatorKey&&(n={position:"row",index:u}),(c=a.indicatorKey)!==null&&c!==void 0?c:a.value});return this.dataset.getAggregator(d,l,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,n).records}if(this.flatDataToObjects){const n=this.internalProps.layoutMap.getCellHeaderPaths(e,t),s=n.colHeaderPaths.map(a=>{var u;return(u=a.indicatorKey)!==null&&u!==void 0?u:a.value}),l=n.rowHeaderPaths.map(a=>{var u;return(u=a.indicatorKey)!==null&&u!==void 0?u:a.value}),d=this.flatDataToObjects.getTreeNode(l,s,this.internalProps.layoutMap.getBody(e,t).indicatorKey);return d==null?void 0:d.record}}}getCellRawRecord(e,t){var i,o,r;if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray){const n=this.getBodyIndexByRow(t),s=this.getBodyIndexByCol(e);return(i=this.records[n])===null||i===void 0?void 0:i[s]}if(this.dataset){let n;const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=(o=s.colHeaderPaths)===null||o===void 0?void 0:o.filter(a=>!a.virtual).map((a,u)=>{var c;return a.indicatorKey&&(n={position:"col",index:u}),(c=a.indicatorKey)!==null&&c!==void 0?c:a.value}),d=(r=s.rowHeaderPaths)===null||r===void 0?void 0:r.filter(a=>!a.virtual).map((a,u)=>{var c;return a.indicatorKey&&(n={position:"row",index:u}),(c=a.indicatorKey)!==null&&c!==void 0?c:a.value});return this.dataset.getAggregator(d,l,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,n).records}if(this.flatDataToObjects){const n=this.internalProps.layoutMap.getCellHeaderPaths(e,t),s=n.colHeaderPaths.map(a=>{var u;return(u=a.indicatorKey)!==null&&u!==void 0?u:a.value}),l=n.rowHeaderPaths.map(a=>{var u;return(u=a.indicatorKey)!==null&&u!==void 0?u:a.value}),d=this.flatDataToObjects.getTreeNode(l,s,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1);return d==null?void 0:d.record}}}updateSortRules(e,t,i){this.internalProps.dataConfig?this.internalProps.dataConfig.sortRules=e:this.internalProps.dataConfig={sortRules:e},this.dataset.updateSortRules(e),this._changePivotSortStateBySortRules();const{layoutMap:o}=this.internalProps;o.resetHeaderTree(),this.scenegraph.clearCells(),lt(t)&&lt(i)?(this.isRowHeader(t,i)?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):this.isCornerHeader(t,i)?o.cornerSetting.titleOnDimension==="column"?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):o.cornerSetting.titleOnDimension==="row"&&this.internalProps._heightResizedRowMap.clear():this.isColumnHeader(t,i)&&this.internalProps._heightResizedRowMap.clear(),this.refreshRowColCount()):this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(!0),this.render()}_changePivotSortStateBySortRules(){var e,t,i,o;this.pivotSortState=[];const r=(t=(e=this.internalProps.dataConfig)===null||e===void 0?void 0:e.sortRules)!==null&&t!==void 0?t:[];for(let n=0;n<r.length;n++){const s=r[n],l=[];if(s.sortByIndicator&&s.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])){for(let a=0;a<s.query.length;a++)l.push({dimensionKey:this.dataset.indicatorsAsCol?this.dataset.columns[a]:this.dataset.rows[a],value:s.query[a]});l.push({indicatorKey:s.sortByIndicator,value:(o=(i=this.internalProps.layoutMap.getIndicatorInfo(s.sortByIndicator))===null||i===void 0?void 0:i.title)!==null&&o!==void 0?o:s.sortByIndicator})}else l.push({dimensionKey:s.sortField,isPivotCorner:!0,value:s.sortField});const d=s.sortType?s.sortType.toUpperCase():"ASC";this.pivotSortState.push({dimensions:l,order:Xe[d]})}}_parseColumnWidthConfig(e){for(let t=0;t<(e==null?void 0:e.length);t++){const i=e[t],o=i.dimensions,r=i.width,n=this.getCellAddressByHeaderPaths(o);n&&!this.internalProps._widthResizedColMap.has(n.col)&&(this._setColWidth(n.col,r),this.internalProps._widthResizedColMap.add(n.col))}}updatePivotSortState(e){this.pivotSortState=e}sort(e,t,i){var o;let r;if(this.isCornerHeader(e,t)){const l=this.getHeaderDefine(e,t);r=[];const d={isPivotCorner:!0,dimensionKey:l.value,value:l.value};r.push(d)}else r=this.isColumnHeader(e,t)?this.getCellHeaderPaths(e,t).colHeaderPaths:this.getCellHeaderPaths(e,t).rowHeaderPaths;const n=r[r.length-1].indicatorKey,s=this.getHeaderDefine(e,t);if(s.sort){if(this.dataset.sortRules){const l={};for(let d=this.dataset.sortRules.length-1;d>=0;d--){const a=this.dataset.sortRules[d];s.dimensionKey&&a.sortField===s.dimensionKey?(l[a.sortField]=a,this.dataset.sortRules.splice(d,1)):n&&a.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])&&this.dataset.sortRules.splice(d,1)}n?this.dataset.sortRules.push({sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:Xe[i],sortByIndicator:n,query:r.reduce((d,a)=>(a.dimensionKey&&d.push(a.value),d),[])}):this.dataset.sortRules.push(Object.assign((o=l[s.dimensionKey])!==null&&o!==void 0?o:{},{sortField:s.dimensionKey,sortType:Xe[i]}))}else this.dataset.sortRules=n?[{sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:Xe[i],sortByIndicator:n,query:r.reduce((l,d)=>(d.dimensionKey&&l.push(d.value),l),[])}]:[{sortField:s.dimensionKey,sortType:Xe[i]}];this.updateSortRules(this.dataset.sortRules,e,t)}}getPivotSortState(e,t){if(!this.pivotSortState)return;const i=this.getCellRange(e,t);for(let o=0;o<this.pivotSortState.length;o++){const r=this.pivotSortState[o],n=r.dimensions,s=this.getCellAddressByHeaderPaths(n),l=r.order;if(s&&Ut(i,s.col,s.row))return l}}_moveHeaderPosition(e,t){const i=this.getCellRange(e.col,e.row),o=this.getCellRange(t.col,t.row),r=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(r){if(r.moveType==="column"){if(this.internalProps.recordsIsTwoDimensionalArray)for(let n=0;n<this.internalProps.records.length;n++){const s=this.internalProps.records[n].splice(r.sourceIndex-this.rowHeaderLevelCount,r.sourceSize);s.unshift(r.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[n],s)}this.colWidthsMap.exchangeOrder(i.start.col,i.end.col-i.start.col+1,o.start.col,o.end.col-o.start.col+1,r.targetIndex),this.setMinMaxLimitWidth()}else if(r.moveType==="row"){if(this.internalProps.recordsIsTwoDimensionalArray){const n=this.internalProps.records.splice(r.sourceIndex-this.columnHeaderLevelCount,r.sourceSize);n.unshift(r.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,n)}r.targetIndex>r.sourceIndex?this.rowHeightsMap.exchangeOrder(r.sourceIndex,r.sourceSize,r.targetIndex+r.sourceSize-r.targetSize,r.targetSize,r.targetIndex):this.rowHeightsMap.exchangeOrder(r.sourceIndex,r.sourceSize,r.targetIndex,r.targetSize,r.targetIndex)}return r}return null}toggleHierarchyState(e,t){const i=this.getHierarchyState(e,t);if(i===Qe.expand)this._refreshHierarchyState(e,t),this.fireListeners(Ct.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:Qe.collapse});else if(i===Qe.collapse){const o=this.internalProps.layoutMap.getHeadNode(e,t);Array.isArray(o.children)&&this._refreshHierarchyState(e,t),this.fireListeners(Ct.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:Qe.expand,originData:o})}}_refreshHierarchyState(e,t,i){let o=!1,r=!1;this.stateManager.updateHoverIcon(e,t,void 0,void 0);const n=this.internalProps.layoutMap.checkHasChart();n&&(this.autoFillWidth&&(o=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(r=this.getAllRowsHeight()<=this.tableNoFrameHeight));const s=this.internalProps.layoutMap.toggleHierarchyState(e,t);i&&i(),this.refreshRowColCount(),this.clearCellStyleCache(),this.scenegraph.updateHierarchyIcon(e,t),this.scenegraph.updateRow(s.removeCellPositions,s.addCellPositions,s.updateCellPositions),n&&(this.autoFillWidth&&!o&&(o=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!r&&(r=this.getAllRowsHeight()<=this.tableNoFrameHeight),(this.widthMode==="adaptive"||o||this.heightMode==="adaptive"||r)&&this.scenegraph.updateChartSizeForResizeColWidth(-1))}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){let t;return t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var i;return(i=this._getHeaderLayoutMap(e,t))===null||i===void 0?void 0:i.hierarchyState}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}_hasHierarchyTreeHeader(){return this.internalProps.layoutMap.rowHierarchyType==="tree"}getMenuInfo(e,t,i){const o=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:o[o.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}setRecords(e){var t,i,o,r,n;const s={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=e,this.internalProps.recordsIsTwoDimensionalArray=!1,((t=e==null?void 0:e[0])===null||t===void 0?void 0:t.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0);const l=this.options,d=this.internalProps;if(((i=this.options.customConfig)===null||i===void 0?void 0:i.enableDataAnalysis)===!1)this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new yt({rows:d.layoutMap.fullRowDimensionKeys,columns:d.layoutMap.colDimensionKeys,indicators:d.layoutMap.indicatorKeys,indicatorsAsCol:d.layoutMap.indicatorsAsCol,indicatorDimensionKey:d.layoutMap.indicatorDimensionKey},e));else{let a,u;this.dataset.setRecords(e),a=l.columnTree?d.layoutMap.columnDimensionTree:new ce((o=this.dataset.colHeaderTree)!==null&&o!==void 0?o:[],this.layoutNodeId),u=l.rowTree?d.layoutMap.rowDimensionTree:new ce((r=this.dataset.rowHeaderTree)!==null&&r!==void 0?r:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(n=this.options.rowExpandLevel)!==null&&n!==void 0?n:1:void 0),d.layoutMap=new Ee(this,this.dataset,a,u),this.pivotSortState=[],l.pivotSortState&&(this.pivotSortState=l.pivotSortState)}if(this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(s.col,s.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder(),this.options.emptyTip)if(this.internalProps.emptyTip)this.internalProps.emptyTip.resetVisible();else{const a=Le.getComponent("emptyTip");this.internalProps.emptyTip=new a(this.options.emptyTip,this),this.internalProps.emptyTip.resetVisible()}}startEditCell(e,t,i){var o;if(M(e)&&M(t))this.eventManager.isDraging=!1,this.selectCell(e,t),this.editorManager.startEditCell(e,t,i);else if(!((o=this.stateManager.select)===null||o===void 0)&&o.cellPos){const{col:r,row:n}=this.stateManager.select.cellPos;M(r)&&M(n)&&this.editorManager.startEditCell(r,n,i)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(e,t){var i,o,r;let n;if(this.isCornerHeader(e,t)){const s=this.getHeaderDefine(e,t);n=(i=s==null?void 0:s.headerEditor)!==null&&i!==void 0?i:this.options.headerEditor}else if(this.isHeader(e,t)){const s=this.getHeaderDefine(e,t);n=(o=s==null?void 0:s.headerEditor)!==null&&o!==void 0?o:this.options.headerEditor}else{const s=this.getBodyColumnDefine(e,t);n=(r=s==null?void 0:s.editor)!==null&&r!==void 0?r:this.options.editor}return typeof n=="function"&&(n=n({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),typeof n=="string"?ki(n):n}isHasEditorDefine(e,t){var i;const o=this.getBodyColumnDefine(e,t);let r=(i=o==null?void 0:o.editor)!==null&&i!==void 0?i:this.options.editor;return typeof r=="function"&&(r=r({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),M(r)}changeCellValue(e,t,i,o=!1){if(o&&this.isHasEditorDefine(e,t)||o===!1){let r=i;const n=this.getCellOriginValue(e,t),s=this.getCellRawValue(e,t);typeof s=="number"&&Ot(i)&&(r=parseFloat(i)),this._changeCellValueToDataSet(e,t,n,r);const l=this.getCellRange(e,t);for(let d=l.start.col;d<=l.end.col;d++)for(let a=l.start.row;a<=l.end.row;a++)this.scenegraph.updateCellContent(d,a);if(this.widthMode==="adaptive"||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)this.internalProps._widthResizedColMap.size===0&&this.scenegraph.recalculateColWidths();else if(!this.internalProps._widthResizedColMap.has(e)){const d=this.getColWidth(e),a=xt(e,0,this.rowCount-1,this,!1);a!==d&&this.scenegraph.updateColWidth(e,a-d)}if(this.heightMode==="adaptive"||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.internalProps._heightResizedRowMap.size===0&&this.scenegraph.recalculateRowHeights();else if(this.heightMode==="autoHeight"&&!this.internalProps._heightResizedRowMap.has(t)){const d=this.getRowHeight(t),a=Mt(t,0,this.colCount-1,this);this.scenegraph.updateRowHeight(t,a-d)}this.fireListeners(st.CHANGE_CELL_VALUE,{col:e,row:t,rawValue:s,currentValue:n,changedValue:r}),this.scenegraph.updateNextFrame()}}changeCellValues(e,t,i,o=!1){let r=e,n=t;const s=[],l=[];for(let u=0;u<i.length&&!(t+u>this.rowCount-1);u++){const c=i[u],h=[],v=[];s.push(h),l.push(v);for(let g=0;g<c.length&&!(e+g>this.colCount-1);g++){const f=this.getCellRawValue(e+g,t+u);h.push(f);const C=this.getCellOriginValue(e+g,t+u);v.push(C)}}for(let u=0;u<i.length&&!(t+u>this.rowCount-1);u++){n=t+u;const c=i[u];let h=e;for(let v=0;v<c.length&&!(e+v>this.colCount-1);v++)if(h=e+v,o&&this.isHasEditorDefine(e+v,t+u)||o===!1){const g=c[v];let f=g;const C=l[u][v],w=s[u][v];typeof w=="number"&&Ot(g)&&(f=parseFloat(g)),this._changeCellValueToDataSet(e+v,t+u,C,f),this.fireListeners(st.CHANGE_CELL_VALUE,{col:e+v,row:t+u,rawValue:w,currentValue:C,changedValue:this.getCellOriginValue(e+v,t+u)})}r=Math.max(r,h)}const d=this.getCellRange(e,t),a=this.getCellRange(r,n);for(let u=d.start.col;u<=a.end.col;u++)for(let c=d.start.row;c<=a.end.row;c++)this.scenegraph.updateCellContent(u,c);if(this.widthMode==="adaptive"||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)this.internalProps._widthResizedColMap.size===0&&this.scenegraph.recalculateColWidths();else for(let u=e;u<=a.end.col;u++)if(!this.internalProps._widthResizedColMap.has(u)){const c=this.getColWidth(u),h=xt(u,0,this.rowCount-1,this,!1);h!==c&&this.scenegraph.updateColWidth(u,h-c)}if(this.heightMode==="adaptive"||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.scenegraph.recalculateRowHeights();else if(this.heightMode==="autoHeight"){const u=[],c=[];for(let h=t;h<=a.end.row;h++)if(this.rowHeightsMap.get(h)){const v=this.getRowHeight(h),g=Mt(h,0,this.colCount-1,this);u.push(h),c.push(g-v)}this.scenegraph.updateRowsHeight(u,c)}this.scenegraph.updateNextFrame()}_changeCellValueToDataSet(e,t,i,o){var r,n,s,l,d,a,u,c;if(this.internalProps.recordsIsTwoDimensionalArray){const h=this.getBodyIndexByRow(t),v=this.getBodyIndexByCol(e);this.records[h][v]=o}else if(this.dataset){const h=this.internalProps.layoutMap.getCellHeaderPaths(e,t);if(this.isCornerHeader(e,t))this.internalProps.layoutMap.changeCornerTitle(e,t,o);else if(this.isHeader(e,t))this.internalProps.layoutMap.changeTreeNodeTitle(e,t,o),!this.isCornerHeader(e,t)&&this.dataset.changeRecordFieldValue(!((r=h.colHeaderPaths)===null||r===void 0)&&r.length?(n=h.colHeaderPaths[h.colHeaderPaths.length-1].indicatorKey)!==null&&n!==void 0?n:h.colHeaderPaths[h.colHeaderPaths.length-1].dimensionKey:(s=h.rowHeaderPaths[h.rowHeaderPaths.length-1].indicatorKey)!==null&&s!==void 0?s:h.rowHeaderPaths[h.rowHeaderPaths.length-1].dimensionKey,i,o);else{const v=(l=h.colHeaderPaths)===null||l===void 0?void 0:l.filter(f=>!f.virtual).map(f=>{var C;return(C=f.indicatorKey)!==null&&C!==void 0?C:f.value}),g=(d=h.rowHeaderPaths)===null||d===void 0?void 0:d.filter(f=>!f.virtual).map(f=>{var C;return(C=f.indicatorKey)!==null&&C!==void 0?C:f.value});this.dataset.changeTreeNodeValue(this.internalProps.layoutMap.indicatorsAsCol?g:g.slice(0,-1),this.internalProps.layoutMap.indicatorsAsCol?v.slice(0,-1):v,this.internalProps.layoutMap.getIndicatorKey(e,t),o)}}else if(this.flatDataToObjects){const h=this.internalProps.layoutMap.getCellHeaderPaths(e,t);if(this.isHeader(e,t))this.internalProps.layoutMap.changeTreeNodeTitle(e,t,o),!this.isCornerHeader(e,t)&&this.flatDataToObjects.changeRecordFieldValue(!((a=h.colHeaderPaths)===null||a===void 0)&&a.length?(u=h.colHeaderPaths[h.colHeaderPaths.length-1].indicatorKey)!==null&&u!==void 0?u:h.colHeaderPaths[h.colHeaderPaths.length-1].dimensionKey:(c=h.rowHeaderPaths[h.rowHeaderPaths.length-1].indicatorKey)!==null&&c!==void 0?c:h.rowHeaderPaths[h.rowHeaderPaths.length-1].dimensionKey,i,o);else{const v=h.colHeaderPaths.map(f=>{var C;return(C=f.indicatorKey)!==null&&C!==void 0?C:f.value}),g=h.rowHeaderPaths.map(f=>{var C;return(C=f.indicatorKey)!==null&&C!==void 0?C:f.value});this.flatDataToObjects.changeTreeNodeValue(g,v,this.internalProps.layoutMap.getBody(e,t).indicatorKey,o)}}}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;const{columnsDefine:e,rowsDefine:t,indicatorsDefine:i}=this.internalProps.layoutMap;for(let o=0;o<e.length;o++){const r=e[o];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let o=0;o<t.length;o++){const r=t[o];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let o=0;o<i.length;o++){const r=i[o];if(typeof r!="string"&&(r.customLayout||r.headerCustomLayout||r.customRender||r.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}setTreeNodeChildren(e,t,i,o){this.flatDataToObjects?(this.internalProps.layoutMap.getHeadNode(i,o).children=e,this._refreshHierarchyState(i,o,()=>{this.flatDataToObjects.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey}),this.flatDataToObjects.addRecords(t)})):(this.internalProps.layoutMap.getHeadNode(i,o).children=e,this._refreshHierarchyState(i,o,()=>{this.dataset._rowTreeHasChanged(),this.dataset.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys}),this.dataset.addRecords(t)}))}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),this.renderWithRecreateCells()}getFilteredRecords(){var e;return(e=this.dataset)===null||e===void 0?void 0:e.filterRules}}qt(),Gt(),Qt(),Jt(),$t(),Yt(),Xt(),Zt(),ei(),ti(),ii(),oi(),ri(),si();class _t extends oo{}qt(),Gt(),Qt(),Jt(),$t(),Yt(),Xt(),Zt(),ei(),ti(),ii(),oi(),ri(),si();class wt extends Wt{constructor(e,t){var i,o,r,n,s,l,d,a,u,c,h,v,g,f,C,w,S,H;let m,p;ft.mode==="node"?(t=e,e=null):e instanceof HTMLElement||(t=e,e=e.container?e.container:null),super(e,t),this.layoutNodeId={seqId:0},this._selectedDataItemsInChart=[],this._selectedDimensionInChart=[],this._chartEventMap={},t.layout&&Object.assign(t,t.layout),this.internalProps.columns=ge(t.columns),this.internalProps.rows=ge(t.rows),this.internalProps.indicators=nt(t.indicators),this.internalProps.columnTree=!t.indicatorsAsCol||!((i=t.columns)===null||i===void 0)&&i.length||t.columnTree?ge(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||!((o=t.rows)===null||o===void 0)&&o.length||t.rowTree?ge(t.rowTree):[],this.internalProps.records=t.records,this.setCustomStateNameToSpec(),this.internalProps.columnResizeType=(r=t.columnResizeType)!==null&&r!==void 0?r:"column",this.internalProps.rowResizeType=(n=t.rowResizeType)!==null&&n!==void 0?n:"row",this.internalProps.dataConfig={isPivotChart:!0},this._axes=Oe(t.axes)?t.axes:[],t.columnTree&&(t.indicatorsAsCol!==!1&&(this.internalProps.columnTree=Ae(this.internalProps.columnTree,t.indicators)),m=new ce((s=this.internalProps.columnTree)!==null&&s!==void 0?s:[],this.layoutNodeId)),t.rowTree&&(t.indicatorsAsCol===!1&&(this.internalProps.rowTree=Ae(this.internalProps.rowTree,t.indicators)),p=new ce((l=this.internalProps.rowTree)!==null&&l!==void 0?l:[],this.layoutNodeId));const I=!((d=p==null?void 0:p.dimensionKeys)===null||d===void 0)&&d.count?p.dimensionKeys.valueArr():(u=(a=t.rows)===null||a===void 0?void 0:a.reduce((T,_)=>(typeof _=="string"?T.push(_):T.push(_.dimensionKey),T),[]))!==null&&u!==void 0?u:[],P=!((c=m==null?void 0:m.dimensionKeys)===null||c===void 0)&&c.count?m.dimensionKeys.valueArr():(v=(h=t.columns)===null||h===void 0?void 0:h.reduce((T,_)=>(typeof _=="string"?T.push(_):T.push(_.dimensionKey),T),[]))!==null&&v!==void 0?v:[],y=(f=(g=t.indicators)===null||g===void 0?void 0:g.reduce((T,_)=>(typeof _=="string"?T.push(_):T.push(_.indicatorKey),T),[]))!==null&&f!==void 0?f:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(P,I),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new at(this.internalProps.dataConfig,I,P,y,this.internalProps.indicators,(C=t.indicatorsAsCol)===null||C===void 0||C,t.records,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&it(this.internalProps.indicators)){const T=_=>{_.forEach(b=>{var K;!((K=b.children)===null||K===void 0)&&K.length?T(b.children):b.children=[{dimensionKey:"axis",value:""}]})};!((w=this.dataset.rowHeaderTree)===null||w===void 0)&&w.length?T(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(t.columnTree||t.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Ae(this.dataset.colHeaderTree,t.indicators)),t.rowTree||t.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Ae(this.dataset.rowHeaderTree,t.indicators)),m=new ce((S=this.dataset.colHeaderTree)!==null&&S!==void 0?S:[],this.layoutNodeId),p=new ce((H=this.dataset.rowHeaderTree)!==null&&H!==void 0?H:[],this.layoutNodeId),this.internalProps.layoutMap=new Ee(this,this.dataset,m,p),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(),t.title){const T=Le.getComponent("title");this.internalProps.title=new T(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)this.internalProps.emptyTip.resetVisible();else{const T=Le.getComponent("emptyTip");this.internalProps.emptyTip=new T(this.options.emptyTip,this),this.internalProps.emptyTip.resetVisible()}setTimeout(()=>{this.fireListeners(st.INITIALIZED,null)},0)}static get EVENT_TYPE(){return ji}get pivotChartAxes(){return this._axes}get recordsCount(){var e;return(e=this.records)===null||e===void 0?void 0:e.length}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!0}_canResizeColumn(e,t){const i=super._canResizeColumn(e,t);if(i&&!this.internalProps.layoutMap.indicatorsAsCol){const o=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(o!=null&&o.disableColumnResize)return!1}return i}updateOption(e){var t,i,o,r,n,s,l,d,a,u,c,h,v,g,f,C,w,S,H,m;const p=this.internalProps;let I,P;super.updateOption(e),this.layoutNodeId={seqId:0},this.internalProps.columns=ge(e.columns),this.internalProps.rows=ge(e.rows),this.internalProps.indicators=!((t=e.indicators)===null||t===void 0)&&t.length?nt(e.indicators):[],this.internalProps.columnTree=!e.indicatorsAsCol||!((i=e.columns)===null||i===void 0)&&i.length||e.columnTree?ge(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||!((o=e.rows)===null||o===void 0)&&o.length||e.rowTree?ge(e.rowTree):[],e.records&&(this.internalProps.records=e.records),this.setCustomStateNameToSpec(),this._selectedDataItemsInChart=[],p.columnResizeType=(r=e.columnResizeType)!==null&&r!==void 0?r:"column",p.rowResizeType=(n=e.rowResizeType)!==null&&n!==void 0?n:"row",p.dataConfig={isPivotChart:!0},this._axes=Oe(e.axes)?e.axes:[],e.columnTree&&(e.indicatorsAsCol!==!1&&(this.internalProps.columnTree=Ae(this.internalProps.columnTree,e.indicators)),I=new ce((s=this.internalProps.columnTree)!==null&&s!==void 0?s:[],this.layoutNodeId)),e.rowTree&&(e.indicatorsAsCol===!1&&(this.internalProps.rowTree=Ae(this.internalProps.rowTree,e.indicators)),P=new ce((l=this.internalProps.rowTree)!==null&&l!==void 0?l:[],this.layoutNodeId));const y=!((d=P==null?void 0:P.dimensionKeys)===null||d===void 0)&&d.count?P.dimensionKeys.valueArr():(u=(a=e.rows)===null||a===void 0?void 0:a.reduce((b,K)=>(typeof K=="string"?b.push(K):b.push(K.dimensionKey),b),[]))!==null&&u!==void 0?u:[],T=!((c=I==null?void 0:I.dimensionKeys)===null||c===void 0)&&c.count?I.dimensionKeys.valueArr():(v=(h=e.columns)===null||h===void 0?void 0:h.reduce((b,K)=>(typeof K=="string"?b.push(K):b.push(K.dimensionKey),b),[]))!==null&&v!==void 0?v:[],_=(f=(g=e.indicators)===null||g===void 0?void 0:g.reduce((b,K)=>(typeof K=="string"?b.push(K):b.push(K.indicatorKey),b),[]))!==null&&f!==void 0?f:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(T,y),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new at(this.internalProps.dataConfig,y,T,_,this.internalProps.indicators,(C=e.indicatorsAsCol)===null||C===void 0||C,(w=e.records)!==null&&w!==void 0?w:this.internalProps.records,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&it(this.internalProps.indicators)){const b=K=>{K.forEach(j=>{var G;!((G=j.children)===null||G===void 0)&&G.length?b(j.children):j.children=[{dimensionKey:"axis",value:""}]})};!((S=this.dataset.rowHeaderTree)===null||S===void 0)&&S.length?b(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(e.columnTree||e.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Ae(this.dataset.colHeaderTree,e.indicators)),e.rowTree||e.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Ae(this.dataset.rowHeaderTree,e.indicators)),I=new ce((H=this.dataset.colHeaderTree)!==null&&H!==void 0?H:[],this.layoutNodeId),P=new ce((m=this.dataset.rowHeaderTree)!==null&&m!==void 0?m:[],this.layoutNodeId),p.layoutMap=new Ee(this,this.dataset,I,P),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,p.releaseList&&(p.releaseList.forEach(b=>{var K;return(K=b==null?void 0:b.release)===null||K===void 0?void 0:K.call(b)}),p.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),e.title){const b=Le.getComponent("title");this.internalProps.title=new b(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)this.internalProps.emptyTip.resetVisible();else{const b=Le.getComponent("emptyTip");this.internalProps.emptyTip=new b(this.options.emptyTip,this),this.internalProps.emptyTip.resetVisible()}return new Promise(b=>{setTimeout(b,0)})}updatePagination(){}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,i,o,r,n,s,l;const d=this,{layoutMap:a}=d.internalProps;a&&(d.colCount=(e=a.colCount)!==null&&e!==void 0?e:0,d.rowCount=(t=a.rowCount)!==null&&t!==void 0?t:0,d.internalProps.frozenColCount=(i=a.rowHeaderLevelCount)!==null&&i!==void 0?i:0,d.frozenRowCount=Math.max(a.headerLevelCount,(o=this.options.frozenRowCount)!==null&&o!==void 0?o:0),d.bottomFrozenRowCount!==((r=a==null?void 0:a.bottomFrozenRowCount)!==null&&r!==void 0?r:0)&&(d.bottomFrozenRowCount=(n=a==null?void 0:a.bottomFrozenRowCount)!==null&&n!==void 0?n:0),d.rightFrozenColCount!==((s=a==null?void 0:a.rightFrozenColCount)!==null&&s!==void 0?s:0)&&(d.rightFrozenColCount=(l=a==null?void 0:a.rightFrozenColCount)!==null&&l!==void 0?l:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}_getSortFuncFromHeaderOption(e,t,i){}syncHierarchyState(e,t){var i,o;e.value===t.value&&e.dimensionKey===t.dimensionKey&&(t.hierarchyState=(i=t.hierarchyState)!==null&&i!==void 0?i:t!=null&&t.children?e.hierarchyState:void 0,(o=t==null?void 0:t.children)===null||o===void 0||o.forEach((r,n)=>{var s;!((s=e==null?void 0:e.children)===null||s===void 0)&&s[n]&&r&&this.syncHierarchyState(e.children[n],r)}))}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByCol(e)}getCellValue(e,t,i){var o,r,n;if(!i){const u=this.getCustomMergeValue(e,t);if(u)return u}if(this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.layoutMap.isBottomFrozenRow(e,t)||this.internalProps.layoutMap.isRightFrozenColumn(e,t)){const h=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(e,t);let v;return h==null||h.forEach(g=>{const f=this.internalProps.layoutMap.getIndicatorInfo(g);f&&(v=f)}),(r=(o=v==null?void 0:v.title)!==null&&o!==void 0?o:v==null?void 0:v.indicatorKey)!==null&&r!==void 0?r:""}const{title:u,fieldFormat:c}=this.internalProps.layoutMap.getHeader(e,t);return typeof c=="function"?c(u,e,t,this):u}if(this.dataset){let u;const c=this.internalProps.layoutMap.getCellHeaderPaths(e,t),h=c.colHeaderPaths.map((f,C)=>{var w;return f.indicatorKey&&(u={position:"col",index:C}),(w=f.indicatorKey)!==null&&w!==void 0?w:f.value}),v=c.rowHeaderPaths.map((f,C)=>{var w;return f.indicatorKey&&(u={position:"row",index:C}),(w=f.indicatorKey)!==null&&w!==void 0?w:f.value}),g=this.dataset.getAggregator(v,h,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,u);return g.value?g.value():void 0}const{fieldFormat:s}=this.internalProps.layoutMap.getBody(e,t),l=this.getBodyIndexByRow(t),d=this.getBodyIndexByCol(e),a=(n=this.records[l])===null||n===void 0?void 0:n[d];return typeof s=="function"?s(a,e,t,this):a}getCellOriginValue(e,t){var i,o,r;const n=this;if(n.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.layoutMap.isBottomFrozenRow(e,t)||this.internalProps.layoutMap.isRightFrozenColumn(e,t)){const a=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(e,t);let u;return a==null||a.forEach(c=>{const h=this.internalProps.layoutMap.getIndicatorInfo(c);h&&(u=h)}),(o=(i=u==null?void 0:u.title)!==null&&i!==void 0?i:u==null?void 0:u.indicatorKey)!==null&&o!==void 0?o:""}const{title:d}=n.internalProps.layoutMap.getHeader(e,t);return typeof d=="function"?d():d}if(this.dataset){let d;const a=this.internalProps.layoutMap.getCellHeaderPaths(e,t),u=a.colHeaderPaths.map((v,g)=>{var f;return v.indicatorKey&&(d={position:"col",index:g}),(f=v.indicatorKey)!==null&&f!==void 0?f:v.value}),c=a.rowHeaderPaths.map((v,g)=>{var f;return v.indicatorKey&&(d={position:"row",index:g}),(f=v.indicatorKey)!==null&&f!==void 0?f:v.value}),h=this.dataset.getAggregator(c,u,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,d);return h.value?h.value():void 0}const s=this.getBodyIndexByRow(t),l=this.getBodyIndexByCol(e);return(r=this.records[s])===null||r===void 0?void 0:r[l]}getCellRawValue(e,t){return this.getCellOriginValue(e,t)}getCellOriginRecord(e,t){if(!this.internalProps.layoutMap.isHeader(e,t)&&this.dataset){let i;const o=this.internalProps.layoutMap.getCellHeaderPaths(e,t),r=o.colHeaderPaths.map((s,l)=>{var d;return s.indicatorKey&&(i={position:"col",index:l}),(d=s.indicatorKey)!==null&&d!==void 0?d:s.value}),n=o.rowHeaderPaths.map((s,l)=>{var d;return s.indicatorKey&&(i={position:"row",index:l}),(d=s.indicatorKey)!==null&&d!==void 0?d:s.value});return this.dataset.getAggregator(n,r,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,i).records}}getCellRawRecord(e,t){return this.getCellOriginRecord(e,t)}getPivotSortState(e,t){if(!this.pivotSortState)return;const i=this.getCellRange(e,t);for(let o=0;o<this.pivotSortState.length;o++){const{col:r,row:n,order:s}=this.pivotSortState[o];if(Ut(i,r,n))return s}}_moveHeaderPosition(e,t){var i,o,r,n;const s=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(s){if(s.moveType==="column"){if(((o=(i=this.options.records)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.constructor)===Array)for(let l=0;l<this.internalProps.records.length;l++){const d=this.internalProps.records[l].splice(s.sourceIndex-this.rowHeaderLevelCount,s.sourceSize);d.unshift(s.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[l],d)}this.colWidthsMap.adjustOrder(s.sourceIndex,s.targetIndex,s.sourceSize),this.setMinMaxLimitWidth()}else if(s.moveType==="row"){if(((n=(r=this.options.records)===null||r===void 0?void 0:r[0])===null||n===void 0?void 0:n.constructor)===Array){const l=this.internalProps.records.splice(s.sourceIndex-this.columnHeaderLevelCount,s.sourceSize);l.unshift(s.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,l)}this.rowHeightsMap.adjustOrder(s.sourceIndex,s.targetIndex,s.sourceSize)}return s}return null}toggleHierarchyState(e,t){}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){let t;return t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var i;return(i=this._getHeaderLayoutMap(e,t))===null||i===void 0?void 0:i.hierarchyState}_hasHierarchyTreeHeader(){return this.internalProps.layoutMap.rowHierarchyType==="tree"}getMenuInfo(e,t,i){const o=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:o[o.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}_generateCollectValuesConfig(e,t){var i,o,r,n,s,l,d,a,u,c,h,v,g,f,C,w,S;e=e.filter(p=>p!==Me),t=t.filter(p=>p!==Me);const H=this.internalProps.indicators,m={};for(let p=0,I=H==null?void 0:H.length;p<I;p++)if(typeof H[p]!="string"&&H[p].chartSpec){if(((i=H[p].chartSpec)===null||i===void 0?void 0:i.type)==="pie"||((o=H[p].chartSpec)===null||o===void 0?void 0:o.type)==="rose"||((r=H[p].chartSpec)===null||r===void 0?void 0:r.type)==="radar"||((n=H[p].chartSpec)===null||n===void 0?void 0:n.type)==="gauge"||((s=H[p].chartSpec)===null||s===void 0?void 0:s.type)==="wordCloud")continue;const P=H[p],y=P.chartSpec;if(this.options.indicatorsAsCol===!1)if((y==null?void 0:y.stack)!==!1&&((y==null?void 0:y.type)==="bar"||(y==null?void 0:y.type)==="area")&&(y.stack=!0),m[P.indicatorKey]={by:t,range:!0,sumBy:(y==null?void 0:y.stack)&&e.concat(y==null?void 0:y.xField)},y.series)y.series.forEach(T=>{var _,b,K,j,G,X,Z,W,$,se,ne,le,ae,de;const he=typeof T.xField=="string"?T.xField:T.xField[0];m[he]={by:e,type:T.direction!=="horizontal"?"xField":void 0,range:Ge(T,this._axes,T.direction==="horizontal",!0),sortBy:T.direction!=="horizontal"?(j=(K=(b=(_=T==null?void 0:T.data)===null||_===void 0?void 0:_.fields)===null||b===void 0?void 0:b[he])===null||K===void 0?void 0:K.domain)!==null&&j!==void 0?j:(Z=(X=(G=y==null?void 0:y.data)===null||G===void 0?void 0:G.fields)===null||X===void 0?void 0:X[he])===null||Z===void 0?void 0:Z.domain:void 0};const ue=T.yField;T.stack!==!1&&(T.type==="bar"||T.type==="area")&&(T.stack=!0),m[ue]={by:t,range:Ge(T,this._axes,T.direction==="horizontal",!1),sumBy:T.stack&&e.concat(T==null?void 0:T.xField),sortBy:T.direction==="horizontal"?(ne=(se=($=(W=T==null?void 0:T.data)===null||W===void 0?void 0:W.fields)===null||$===void 0?void 0:$[ue])===null||se===void 0?void 0:se.domain)!==null&&ne!==void 0?ne:(de=(ae=(le=y==null?void 0:y.data)===null||le===void 0?void 0:le.fields)===null||ae===void 0?void 0:ae[ue])===null||de===void 0?void 0:de.domain:void 0,extendRange:rt(y.markLine)}});else{const T=typeof y.xField=="string"?y.xField:y.xField[0];m[T]={by:e,type:y.direction!=="horizontal"?"xField":void 0,range:Ge(y,this._axes,y.direction==="horizontal",!0),sortBy:y.direction!=="horizontal"?(a=(d=(l=y==null?void 0:y.data)===null||l===void 0?void 0:l.fields)===null||d===void 0?void 0:d[T])===null||a===void 0?void 0:a.domain:void 0},(y==null?void 0:y.stack)!==!1&&((y==null?void 0:y.type)==="bar"||(y==null?void 0:y.type)==="area")&&(y.stack=!0);const _=y.yField;m[_]={by:t,range:y.direction!=="horizontal",sumBy:y.stack&&e.concat(y==null?void 0:y.xField),sortBy:y.direction==="horizontal"?(h=(c=(u=y==null?void 0:y.data)===null||u===void 0?void 0:u.fields)===null||c===void 0?void 0:c[_])===null||h===void 0?void 0:h.domain:void 0,extendRange:rt(y.markLine)}}else{const T=H[p];if((y==null?void 0:y.stack)!==!1&&((y==null?void 0:y.type)==="bar"||(y==null?void 0:y.type)==="area")&&(y.stack=!0),m[T.indicatorKey]={by:e,range:!0,sumBy:(y==null?void 0:y.stack)&&t.concat(y==null?void 0:y.yField)},y.series)y.series.forEach(_=>{var b,K,j,G,X,Z,W,$,se,ne,le,ae,de,he;const ue=typeof _.yField=="string"?_.yField:_.yField[0];m[ue]={by:t,type:_.direction==="horizontal"?"yField":void 0,range:Ge(_,this._axes,_.direction==="horizontal",!1),sortBy:_.direction==="horizontal"?(G=(j=(K=(b=_==null?void 0:_.data)===null||b===void 0?void 0:b.fields)===null||K===void 0?void 0:K[ue])===null||j===void 0?void 0:j.domain)!==null&&G!==void 0?G:(W=(Z=(X=y==null?void 0:y.data)===null||X===void 0?void 0:X.fields)===null||Z===void 0?void 0:Z[ue])===null||W===void 0?void 0:W.domain:void 0};const Ce=_.xField;_.stack!==!1&&(_.type==="bar"||_.type==="area")&&(_.stack=!0),m[Ce]={by:e,range:Ge(_,this._axes,_.direction==="horizontal",!0),sumBy:_.stack&&t.concat(_==null?void 0:_.yField),sortBy:_.direction!=="horizontal"?(le=(ne=(se=($=_==null?void 0:_.data)===null||$===void 0?void 0:$.fields)===null||se===void 0?void 0:se[Ce])===null||ne===void 0?void 0:ne.domain)!==null&&le!==void 0?le:(he=(de=(ae=y==null?void 0:y.data)===null||ae===void 0?void 0:ae.fields)===null||de===void 0?void 0:de[Ce])===null||he===void 0?void 0:he.domain:void 0,extendRange:rt(y.markLine)}});else{const _=typeof y.yField=="string"?y.yField:y.yField[0];m[_]={by:t,type:y.direction==="horizontal"?"yField":void 0,range:Ge(y,this._axes,y.direction==="horizontal",!1),sortBy:y.direction==="horizontal"?(f=(g=(v=y==null?void 0:y.data)===null||v===void 0?void 0:v.fields)===null||g===void 0?void 0:g[_])===null||f===void 0?void 0:f.domain:void 0},(y==null?void 0:y.stack)!==!1&&((y==null?void 0:y.type)==="bar"||(y==null?void 0:y.type)==="area")&&(y.stack=!0);const b=y.xField;m[b]={by:e,range:Ge(y,this._axes,y.direction==="horizontal",!0),sumBy:y.stack&&t.concat(y==null?void 0:y.yField),sortBy:y.direction!=="horizontal"?(S=(w=(C=y==null?void 0:y.data)===null||C===void 0?void 0:C.fields)===null||w===void 0?void 0:w[b])===null||S===void 0?void 0:S.domain:void 0,extendRange:rt(y.markLine)}}}}return m}_generateAggregationRules(){var e;const t=[];return(e=this.internalProps.indicators)===null||e===void 0||e.forEach(i=>{var o,r;if(typeof i=="string")t.push({indicatorKey:i,field:i,aggregationType:ie.RECORD});else if(!((o=i.chartSpec)===null||o===void 0)&&o.series){const n=[];(r=i.chartSpec)===null||r===void 0||r.series.forEach(s=>{const l=this.options.indicatorsAsCol===!1?s.yField:s.xField;n.indexOf(l)===-1&&n.push(l)}),t.push({indicatorKey:i.indicatorKey,field:n,aggregationType:ie.RECORD})}else{const n=this.options.indicatorsAsCol===!1?i.chartSpec.yField:i.chartSpec.xField;t.push({indicatorKey:i.indicatorKey,field:n??i.indicatorKey,aggregationType:ie.RECORD})}}),t}setCustomStateNameToSpec(){var e;const t=i=>{var o,r,n,s,l,d,a,u;!((r=(o=i.bar)===null||o===void 0?void 0:o.state)===null||r===void 0)&&r.selected&&(i.bar.state.vtable_selected=i.bar.state.selected,i.bar.state.vtable_selected_reverse=i.bar.state.selected_reverse,delete i.bar.state.selected,delete i.bar.state.selected_reverse),!((s=(n=i.point)===null||n===void 0?void 0:n.state)===null||s===void 0)&&s.selected&&(i.point.state.vtable_selected=i.point.state.selected,i.point.state.vtable_selected_reverse=i.point.state.selected_reverse,delete i.point.state.selected,delete i.point.state.selected_reverse),!((d=(l=i.line)===null||l===void 0?void 0:l.state)===null||d===void 0)&&d.selected&&(i.line.state.vtable_selected=i.line.state.selected,i.line.state.vtable_selected_reverse=i.line.state.selected_reverse,delete i.line.state.selected,delete i.line.state.selected_reverse),!((u=(a=i.area)===null||a===void 0?void 0:a.state)===null||u===void 0)&&u.selected&&(i.area.state.vtable_selected=i.area.state.selected,i.area.state.vtable_selected_reverse=i.area.state.selected_reverse,delete i.area.state.selected,delete i.area.state.selected_reverse)};(e=this.internalProps.indicators)===null||e===void 0||e.forEach(i=>{if(i.chartSpec){const o=i.chartSpec;o.series?o.series.forEach(r=>{t(r)}):t(o)}})}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),Et(this.scenegraph),Wi(this.scenegraph),this.render()}clearChartCacheImage(e,t){lt(e)&&lt(t)?Ui(e,t,this.scenegraph):Et(this.scenegraph)}getLegendSelected(){var e;const t=[];return(e=this.internalProps.legends)===null||e===void 0||e.forEach(i=>{const o=i.legendComponent._getSelectedLegends().map(r=>r.label);t.push(...o)}),t}setLegendSelected(e){var t;(t=this.internalProps.legends)===null||t===void 0||t.forEach(i=>{i.legendComponent.setSelected(e)})}getChartDatumPosition(e,t){const{chartInstance:i,bounds:o}=this.getChartInstance(t);if(i){const r=i.convertDatumToPosition(e);return r?{x:Math.round(r.x+o.x1),y:Math.round(r.y+o.y1)}:null}return null}getCellAddressByRecord(e){const t=[],i=[],o={},r=[];this.dataset.dataConfig.aggregationRules.forEach(n=>{if(typeof n.field=="string")o[n.field]=n.indicatorKey,r.push(n.field);else for(let s=0;s<n.field.length;s++)o[n.field[s]]=n.indicatorKey,r.push(n.field[s])});for(const n in e)this.dataset.rows.indexOf(n)>=0&&t.push({dimensionKey:n,value:e[n]}),this.dataset.columns.indexOf(n)>=0&&i.push({dimensionKey:n,value:e[n]}),r.indexOf(n)>=0&&(this.dataset.indicatorsAsCol?i.push({indicatorKey:o[n]}):t.push({indicatorKey:o[n]}));return this.getCellAddressByHeaderPaths({rowHeaderPaths:t,colHeaderPaths:i,cellLocation:"body"})}getChartInstance(e){var t,i,o,r,n;const s=this.getCellAddressByHeaderPaths(e);if(s){const l=this.getCellRelativeRect(s.col,s.row),d=this.scenegraph.getCell(s.col,s.row);let a;const u=(t=d==null?void 0:d.getChildren())===null||t===void 0?void 0:t[0];if(u.attribute.chartInstance){a=u.attribute.chartInstance;const{dataId:c,data:h,axes:v,spec:g}=u.attribute,f=u.getViewBox();if(v==null||v.forEach((C,w)=>{var S,H,m,p;C.type==="linear"?a.updateModelSpecSync({type:"axes",index:w},{min:(H=(S=C.range)===null||S===void 0?void 0:S.min)!==null&&H!==void 0?H:0,max:(p=(m=C.range)===null||m===void 0?void 0:m.max)!==null&&p!==void 0?p:0},!0):C.type==="band"&&a.updateModelSpec({type:"axes",index:w},{domain:C.domain.slice(0)},!0)}),a.updateViewBox({x1:f.x1-u.getRootNode().table.scrollLeft,x2:f.x2-u.getRootNode().table.scrollLeft,y1:f.y1-u.getRootNode().table.scrollTop,y2:f.y2-u.getRootNode().table.scrollTop},!1,!1),typeof c=="string")a.updateDataSync(c,h??[]);else{const C=[];for(const w in c){const S=c[w],H=g.series.find(m=>{var p;return((p=m==null?void 0:m.data)===null||p===void 0?void 0:p.id)===w});C.push({id:w,values:S?(i=h==null?void 0:h.filter(m=>m.hasOwnProperty(S)))!==null&&i!==void 0?i:[]:h??[],fields:(o=H==null?void 0:H.data)===null||o===void 0?void 0:o.fields}),a.updateFullDataSync||a.updateDataSync(w,S?(r=h==null?void 0:h.filter(m=>m.hasOwnProperty(S)))!==null&&r!==void 0?r:[]:h??[])}(n=a.updateFullDataSync)===null||n===void 0||n.call(a,C)}this.renderAsync()}return{chartInstance:a,bounds:l.bounds}}return{}}_getDimensionSortArray(){var e,t;if(!((t=(e=this.options)===null||e===void 0?void 0:e.axes)===null||t===void 0)&&t.length){const i=this.options.indicatorsAsCol?"left":"bottom",o=this.options.axes.find(r=>r.orient===i);if(o&&Oe(o.domain))return o.domain}}setRecords(e){var t,i;const o={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=e;const r=this.options,n=this.internalProps;let s,l;this.dataset.setRecords(e),s=r.columnTree?n.layoutMap.columnDimensionTree:new ce((t=this.dataset.colHeaderTree)!==null&&t!==void 0?t:[],this.layoutNodeId),l=r.rowTree?n.layoutMap.rowDimensionTree:new ce((i=this.dataset.rowHeaderTree)!==null&&i!==void 0?i:[],this.layoutNodeId),n.layoutMap=new Ee(this,this.dataset,s,l),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(o.col,o.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder()}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;const{columnsDefine:e,rowsDefine:t,indicatorsDefine:i}=this.internalProps.layoutMap;for(let o=0;o<e.length;o++){const r=e[o];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let o=0;o<t.length;o++){const r=t[o];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let o=0;o<i.length;o++){const r=i[o];if(typeof r!="string"&&(r.customLayout||r.headerCustomLayout||r.customRender||r.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}}let ro=class extends qi{constructor(e){var t,i,o,r,n,s,l,d,a,u;e.src&&(e.image=e.src),e.shape==="circle"&&(e.cornerRadius=e.width/2);const c=Oe(e.boundsPadding),h=[(i=(t=e.marginTop)!==null&&t!==void 0?t:c?e.boundsPadding[0]:e.boundsPadding)!==null&&i!==void 0?i:0,(r=(o=e.marginRight)!==null&&o!==void 0?o:c?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(l=(n=e.marginBottom)!==null&&n!==void 0?n:c?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&l!==void 0?l:0,(u=(d=e.marginLeft)!==null&&d!==void 0?d:c?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&u!==void 0?u:0];e.boundsPadding=h,super(e)}},so=class extends Gi{constructor(e){var t,i,o,r,n,s,l,d,a,u,c;e.textBaseline||(e.textBaseline="top");const h=Oe(e.boundsPadding),v=[(i=(t=e.marginTop)!==null&&t!==void 0?t:h?e.boundsPadding[0]:e.boundsPadding)!==null&&i!==void 0?i:0,(r=(o=e.marginRight)!==null&&o!==void 0?o:h?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(l=(n=e.marginBottom)!==null&&n!==void 0?n:h?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&l!==void 0?l:0,(u=(d=e.marginLeft)!==null&&d!==void 0?d:h?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&u!==void 0?u:0];e.boundsPadding=v,e.fill=(c=e.fill)!==null&&c!==void 0?c:"#000",super(e)}getSize(e){this.AABBBounds.width()}},no=class extends Qi{constructor(e){var t,i,o,r,n,s,l,d,a,u;const c=Oe(e.boundsPadding),h=[(i=(t=e.marginTop)!==null&&t!==void 0?t:c?e.boundsPadding[0]:e.boundsPadding)!==null&&i!==void 0?i:0,(r=(o=e.marginRight)!==null&&o!==void 0?o:c?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(l=(n=e.marginBottom)!==null&&n!==void 0?n:c?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&l!==void 0?l:0,(u=(d=e.marginLeft)!==null&&d!==void 0?d:c?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&u!==void 0?u:0];e.boundsPadding=h,super(e)}getSize(e){this.AABBBounds.width()}},lo=class extends Ji{constructor(e){var t,i,o,r,n,s,l,d,a,u;const c=Oe(e.boundsPadding),h=[(i=(t=e.marginTop)!==null&&t!==void 0?t:c?e.boundsPadding[0]:e.boundsPadding)!==null&&i!==void 0?i:0,(r=(o=e.marginRight)!==null&&o!==void 0?o:c?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(l=(n=e.marginBottom)!==null&&n!==void 0?n:c?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&l!==void 0?l:0,(u=(d=e.marginLeft)!==null&&d!==void 0?d:c?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&u!==void 0?u:0];e.boundsPadding=h,super(e)}};function dt(D){return D.flatMap(e=>Array.isArray(e.children)?dt(e.children):e)}function ni(D){return D.replace(/-([a-z])/g,e=>e[1].toUpperCase())}function Rt(D){const e={};for(const t in D)if(D.hasOwnProperty(t)){const i=ni(t);e[i]=D[t]}return e}function ao(D,e){return D.startsWith("on")&&Zi(e[D])}function ho(D){const e={Group:lo,Image:ro,Text:so,Tag:no,Radio:Yi,CheckBox:$i};function t(r){if(!r)return null;const{type:n,children:s}=r,l=Rt(r.props),d=(n==null?void 0:n.symbol)||(n==null?void 0:n.name),a=e[d];if(!a)return null;const u=new a(Object.assign({},l));return o(u,l),i(s).forEach(h=>{const v=t(h);v?u.add(v):h.type===Symbol.for("v-fgt")&&h.children.forEach(g=>{const f=t(g);f&&u.add(f)})}),u}function i(r){var n;return((n=r==null?void 0:r.default)===null||n===void 0?void 0:n.call(r))||r||[]}function o(r,n){Object.keys(n).forEach(s=>{if(ao(s,n)){let l;s.startsWith("on")?l=s.slice(2).toLowerCase():l=ni(s.slice(2)).toLowerCase(),r.addEventListener(l,n[s])}})}return{rootComponent:t(D)}}function uo(D){return e=>{const{table:t,row:i,col:o,rect:r}=e,n=t.getCellOriginRecord(o,i),{height:s,width:l}=r??t.getCellRect(o,i),d=D.customLayout({table:t,row:i,col:o,rect:r,record:n,height:s,width:l})[0],{rootComponent:a}=ho(d);return{rootContainer:a,renderDefault:!1}}}function li(D){const e={columns:[],columnHeaderTitle:[],rows:[],rowHeaderTitle:[],indicators:[],corner:{},tooltip:{},menu:{}},t={PivotColumnDimension:"columns",PivotColumnHeaderTitle:"columnHeaderTitle",PivotRowDimension:"rows",PivotRowHeaderTitle:"rowHeaderTitle",PivotCorner:"corner",PivotIndicator:"indicators",Tooltip:"tooltip",Menu:"menu"};return D.forEach(i=>{var o,r;i.props=Rt(i.props);const n=((o=i.type)===null||o===void 0?void 0:o.symbol)||((r=i.type)===null||r===void 0?void 0:r.name),s=t[n];s&&(Array.isArray(e[s])?i.props.hasOwnProperty("objectHandler")?e[s].push(i.props.objectHandler):e[s].push(i.props):e[s]=i.props)}),e}function co(D){const e={columns:[],tooltip:{},menu:{}},t={ListColumn:"columns",Tooltip:"tooltip",Menu:"menu"};return D.forEach(i=>{var o,r;i.props=Rt(i.props);const n=((o=i.type)===null||o===void 0?void 0:o.symbol)||((r=i.type)===null||r===void 0?void 0:r.name),s=t[n];s&&(s==="columns"&&i.children&&(i.props.customLayout=uo(i.children)),Array.isArray(e[s])?e[s].push(i.props):e[s]=i.props)}),e}const E=Object.assign(Object.assign(Object.assign({},mt.EVENT_TYPE),_t.EVENT_TYPE),wt.EVENT_TYPE),ai={onClickCell:E.CLICK_CELL,onDblClickCell:E.DBLCLICK_CELL,onMouseDownCell:E.MOUSEDOWN_CELL,onMouseUpCell:E.MOUSEUP_CELL,onSelectedCell:E.SELECTED_CELL,onKeyDown:E.KEYDOWN,onMouseEnterTable:E.MOUSEENTER_TABLE,onMouseLeaveTable:E.MOUSELEAVE_TABLE,onMouseDownTable:E.MOUSEDOWN_TABLE,onMouseMoveCell:E.MOUSEMOVE_CELL,onMouseEnterCell:E.MOUSEENTER_CELL,onMouseLeaveCell:E.MOUSELEAVE_CELL,onContextMenuCell:E.CONTEXTMENU_CELL,onResizeColumn:E.RESIZE_COLUMN,onResizeColumnEnd:E.RESIZE_COLUMN_END,onChangeHeaderPosition:E.CHANGE_HEADER_POSITION,onSortClick:E.SORT_CLICK,onFreezeClick:E.FREEZE_CLICK,onScroll:E.SCROLL,onDropdownMenuClick:E.DROPDOWN_MENU_CLICK,onMouseOverChartSymbol:E.MOUSEOVER_CHART_SYMBOL,onDragSelectEnd:E.DRAG_SELECT_END,onDropdownIconClick:E.DROPDOWN_ICON_CLICK,onDropdownMenuClear:E.DROPDOWN_MENU_CLEAR,onTreeHierarchyStateChange:E.TREE_HIERARCHY_STATE_CHANGE,onShowMenu:E.SHOW_MENU,onHideMenu:E.HIDE_MENU,onIconClick:E.ICON_CLICK,onLegendItemClick:E.LEGEND_ITEM_CLICK,onLegendItemHover:E.LEGEND_ITEM_HOVER,onLegendItemUnHover:E.LEGEND_ITEM_UNHOVER,onLegendChange:E.LEGEND_CHANGE,onMouseEnterAxis:E.MOUSEENTER_AXIS,onMouseLeaveAxis:E.MOUSELEAVE_AXIS,onCheckboxStateChange:E.CHECKBOX_STATE_CHANGE,onRadioStateChange:E.RADIO_STATE_CHANGE,onAfterRender:E.AFTER_RENDER,onInitialized:E.INITIALIZED,onPivotSortClick:E.PIVOT_SORT_CLICK,onDrillMenuClick:E.DRILLMENU_CLICK,onVChartEventType:E.VCHART_EVENT_TYPE,onChangCellValue:E.CHANGE_CELL_VALUE,onMousedownFillHandle:E.MOUSEDOWN_FILL_HANDLE,onDragFillHandleEnd:E.DRAG_FILL_HANDLE_END,onDblclickFillHandle:E.DBLCLICK_FILL_HANDLE,onScrollVerticalEnd:E.SCROLL_VERTICAL_END,onScrollHorizontalEnd:E.SCROLL_HORIZONTAL_END},zt=Object.keys(ai);var Dt=ot({__name:"base-table",props:{type:{type:String,required:!1},options:{type:null,required:!1},records:{type:Array,required:!1},width:{type:[Number,String],required:!1,default:"100%"},height:{type:[Number,String],required:!1,default:"100%"},onReady:{type:Function,required:!1},onError:{type:Function,required:!1},onClickCell:{type:null,required:!1},onDblClickCell:{type:null,required:!1},onMouseDownCell:{type:null,required:!1},onMouseUpCell:{type:null,required:!1},onSelectedCell:{type:null,required:!1},onKeyDown:{type:null,required:!1},onMouseEnterTable:{type:null,required:!1},onMouseLeaveTable:{type:null,required:!1},onMouseDownTable:{type:null,required:!1},onMouseMoveCell:{type:null,required:!1},onMouseEnterCell:{type:null,required:!1},onMouseLeaveCell:{type:null,required:!1},onContextMenuCell:{type:null,required:!1},onResizeColumn:{type:null,required:!1},onResizeColumnEnd:{type:null,required:!1},onChangeHeaderPosition:{type:null,required:!1},onSortClick:{type:null,required:!1},onFreezeClick:{type:null,required:!1},onScroll:{type:null,required:!1},onDropdownMenuClick:{type:null,required:!1},onMouseOverChartSymbol:{type:null,required:!1},onDragSelectEnd:{type:null,required:!1},onDropdownIconClick:{type:null,required:!1},onDropdownMenuClear:{type:null,required:!1},onTreeHierarchyStateChange:{type:null,required:!1},onShowMenu:{type:null,required:!1},onHideMenu:{type:null,required:!1},onIconClick:{type:null,required:!1},onLegendItemClick:{type:null,required:!1},onLegendItemHover:{type:null,required:!1},onLegendItemUnHover:{type:null,required:!1},onLegendChange:{type:null,required:!1},onMouseEnterAxis:{type:null,required:!1},onMouseLeaveAxis:{type:null,required:!1},onCheckboxStateChange:{type:null,required:!1},onRadioStateChange:{type:null,required:!1},onAfterRender:{type:null,required:!1},onInitialized:{type:null,required:!1},onPivotSortClick:{type:null,required:!1},onDrillMenuClick:{type:null,required:!1},onVChartEventType:{type:null,required:!1},onChangCellValue:{type:null,required:!1},onMousedownFillHandle:{type:null,required:!1},onDragFillHandleEnd:{type:null,required:!1},onDblclickFillHandle:{type:null,required:!1},onScrollVerticalEnd:{type:null,required:!1},onScrollHorizontalEnd:{type:null,required:!1}},emits:zt,setup(D,{expose:e,emit:t}){const i=D,o=Re(null),r=Pt(null);e({vTableInstance:r});const n=De(()=>typeof i.width=="number"?`${i.width}px`:i.width),s=De(()=>typeof i.height=="number"?`${i.height}px`:i.height),l=t,d=h=>{zt.forEach(v=>{const g=f=>{l(v,f)};h.on(ai[v],g)})},a=(h,v)=>{r.value=new h(o.value,v)},u=()=>{var h,v;if(!o.value)return;r.value&&r.value.release();const g=()=>i.records!==void 0&&i.records!==null&&i.records.length>0?i.records:i.options.records;try{switch(i.type){case"list":a(mt,Object.assign(Object.assign({},i.options),{records:g()}));break;case"pivot":a(_t,Object.assign(Object.assign({},i.options),{records:g()}));break;case"chart":a(wt,Object.assign(Object.assign({},i.options),{records:g()}));break}d(r.value),(h=i.onReady)===null||h===void 0||h.call(i,r.value,!0)}catch(f){(v=i.onError)===null||v===void 0||v.call(i,f)}},c=h=>{var v;if(r.value)try{switch(i.type){case"list":r.value instanceof mt&&r.value.updateOption(h);break;case"pivot":r.value instanceof _t&&r.value.updateOption(h);break;case"chart":r.value instanceof wt&&r.value.updateOption(h);break}}catch(g){(v=i.onError)===null||v===void 0||v.call(i,g)}};return jt(u),pi(()=>{var h;return(h=r.value)===null||h===void 0?void 0:h.release()}),Ft(()=>i.options,h=>{r.value?c(h):u()}),Ft(()=>i.records,(h,v)=>{r.value?c(Object.assign(Object.assign({},i.options),{records:h})):u()},{deep:!0}),(h,v)=>(Ke(),Ne("div",{ref_key:"vTableContainer",ref:o,style:tt([{width:n.value,height:s.value},{position:"relative"}])},null,4))}}),pt=ot({__name:"list-table",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(D,{expose:e}){const t=D,i=Re(null),o=St(),r=De(()=>{var n;const s=dt(((n=o.default)===null||n===void 0?void 0:n.call(o))||[]),l=co(s);return Object.assign(Object.assign({},t.options),{columns:l.columns.length?l.columns:t.options.columns,tooltip:l.tooltip||t.options.tooltip,menu:l.menu||t.options.menu})});return e({vTableInstance:De(()=>{var n;return((n=i.value)===null||n===void 0?void 0:n.vTableInstance)||null})}),(n,s)=>(Ke(),Ne(Ye,null,[L(Dt,It({type:"list",options:r.value,records:n.records,width:n.width,height:n.height,ref_key:"baseTableRef",ref:i},n.$attrs),null,16,["options","records","width","height"]),bt(n.$slots,"default")],64))}}),vo=ot({__name:"pivot-table",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(D,{expose:e}){const t=D,i=Pt(null),o=St(),r=De(()=>{var n;const s=dt(((n=o.default)===null||n===void 0?void 0:n.call(o))||[]),l=li(s);return Object.assign(Object.assign({},t.options),{columns:l.columns.length?l.columns:t.options.columns,columnHeaderTitle:l.columnHeaderTitle.length?l.columnHeaderTitle:t.options.columnHeaderTitle,rows:l.rows.length?l.rows:t.options.rows,rowHeaderTitle:l.rowHeaderTitle.length?l.rowHeaderTitle:t.options.rowHeaderTitle,indicators:l.indicators.length?l.indicators:t.options.indicators,corner:t.options.corner||l.corner,tooltip:t.options.tooltip||l.tooltip,menu:t.options.menu||l.menu})});return e({vTableInstance:De(()=>{var n;return((n=i.value)===null||n===void 0?void 0:n.vTableInstance)||null})}),(n,s)=>(Ke(),Ne(Ye,null,[L(Dt,It({type:"pivot",options:r.value,records:n.records,width:n.width,height:n.height,ref_key:"baseTableRef",ref:i},n.$attrs),null,16,["options","records","width","height"]),bt(n.$slots,"default")],64))}}),go=ot({__name:"pivot-chart",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(D,{expose:e}){const t=D,i=Pt(null),o=St(),r=De(()=>{var n;const s=dt(((n=o.default)===null||n===void 0?void 0:n.call(o))||[]),l=li(s);return Object.assign(Object.assign({},t.options),{columns:l.columns.length?l.columns:t.options.columns,columnHeaderTitle:l.columnHeaderTitle.length?l.columnHeaderTitle:t.options.columnHeaderTitle,rows:l.rows.length?l.rows:t.options.rows,rowHeaderTitle:l.rowHeaderTitle.length?l.rowHeaderTitle:t.options.rowHeaderTitle,indicators:l.indicators.length?l.indicators:t.options.indicators,corner:t.options.corner||l.corner,tooltip:t.options.tooltip||l.tooltip,menu:t.options.menu||l.menu})});return e({vTableInstance:De(()=>{var n;return((n=i.value)===null||n===void 0?void 0:n.vTableInstance)||null})}),(n,s)=>(Ke(),Ne(Ye,null,[L(Dt,It({type:"chart",options:r.value,records:n.records,width:n.width,height:n.height,ref_key:"baseTableRef",ref:i},n.$attrs),null,16,["options","records","width","height"]),bt(n.$slots,"default")],64))}});const Co=(D,e)=>{Xi(D,e)};function Y(D){return null}Y.symbol="ListColumn";function di(D){return null}di.symbol="PivotColumnDimension";function hi(D){return null}hi.symbol="PivotRowDimension";function ui(D){return null}ui.symbol="PivotIndicator";function ci(D){return null}ci.symbol="PivotCorner";function vi(D){return null}vi.symbol="Menu";function $e(){return null}$e.symbol="Group";function Ht(){return null}Ht.symbol="Image";function Tt(){return null}Tt.symbol="Text";function gi(D){return null}gi.symbol="Tag";const kt=[{"Row ID":"7981","Order ID":"CA-2015-103800","Order Date":"2015/1/3","Ship Date":"2015/1/7","Ship Mode":"Standard Class","Customer ID":"DP-13000","Customer Name":"Darren Powers",Segment:"Consumer",Country:"United States",City:"Houston",State:"Texas","Postal Code":"77095",Region:"Central","Product ID":"OFF-PA-10000174",Category:"Office Supplies","Sub-Category":"Paper","Product Name":'Message Book, Wirebound, Four 5 1/2" X 4" Forms/Pg., 200 Dupl. Sets/Book',Sales:"16.448",Quantity:"2",Discount:"0.2",Profit:"5.5512"},{"Row ID":"740","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-LA-10003223",Category:"Office Supplies","Sub-Category":"Labels","Product Name":"Avery 508",Sales:"11.784",Quantity:"3",Discount:"0.2",Profit:"4.2717"},{"Row ID":"741","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-ST-10002743",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"SAFCO Boltless Steel Shelving",Sales:"272.736",Quantity:"3",Discount:"0.2",Profit:"-64.7748"},{"Row ID":"742","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-BI-10004094",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"GBC Standard Plastic Binding Systems Combs",Sales:"3.54",Quantity:"2",Discount:"0.8",Profit:"-5.487"},{"Row ID":"1760","Order ID":"CA-2015-141817","Order Date":"2015/1/5","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"MB-18085","Customer Name":"Mick Brown",Segment:"Consumer",Country:"United States",City:"Philadelphia",State:"Pennsylvania","Postal Code":"19143",Region:"East","Product ID":"OFF-AR-10003478",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Avery Hi-Liter EverBold Pen Style Fluorescent Highlighters, 4/Pack",Sales:"19.536",Quantity:"3",Discount:"0.2",Profit:"4.884"},{"Row ID":"5328","Order ID":"CA-2015-130813","Order Date":"2015/1/6","Ship Date":"2015/1/8","Ship Mode":"Second Class","Customer ID":"LS-17230","Customer Name":"Lycoris Saunders",Segment:"Consumer",Country:"United States",City:"Los Angeles",State:"California","Postal Code":"90049",Region:"West","Product ID":"OFF-PA-10002005",Category:"Office Supplies","Sub-Category":"Paper","Product Name":"Xerox 225",Sales:"19.44",Quantity:"3",Discount:"0",Profit:"9.3312"},{"Row ID":"7181","Order ID":"CA-2015-106054","Order Date":"2015/1/6","Ship Date":"2015/1/7","Ship Mode":"First Class","Customer ID":"JO-15145","Customer Name":"Jack O'Briant",Segment:"Corporate",Country:"United States",City:"Athens",State:"Georgia","Postal Code":"30605",Region:"South","Product ID":"OFF-AR-10002399",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Dixon Prang Watercolor Pencils, 10-Color Set with Brush",Sales:"12.78",Quantity:"3",Discount:"0",Profit:"5.2398"},{"Row ID":"7475","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"FUR-CH-10004063",Category:"Furniture","Sub-Category":"Chairs","Product Name":"Global Deluxe High-Back Manager's Chair",Sales:"2573.82",Quantity:"9",Discount:"0",Profit:"746.4078"},{"Row ID":"7476","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-BI-10004632",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"Ibico Hi-Tech Manual Binding System",Sales:"609.98",Quantity:"2",Discount:"0",Profit:"274.491"},{"Row ID":"7477","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-AR-10001662",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Rogers Handheld Barrel Pencil Sharpener",Sales:"5.48",Quantity:"2",Discount:"0",Profit:"1.4796"},{"Row ID":"7478","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"TEC-PH-10004977",Category:"Technology","Sub-Category":"Phones","Product Name":"GE 30524EE4",Sales:"391.98",Quantity:"2",Discount:"0",Profit:"113.6742"},{"Row ID":"7479","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"TEC-PH-10004539",Category:"Technology","Sub-Category":"Phones","Product Name":"Wireless Extenders zBoost YX545 SOHO Signal Booster",Sales:"755.96",Quantity:"4",Discount:"0",Profit:"204.1092"},{"Row ID":"7480","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-FA-10001883",Category:"Office Supplies","Sub-Category":"Fasteners","Product Name":"Alliance Super-Size Bands, Assorted Sizes",Sales:"31.12",Quantity:"4",Discount:"0",Profit:"0.3112"},{"Row ID":"7481","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-PA-10000955",Category:"Office Supplies","Sub-Category":"Paper","Product Name":"Southworth 25% Cotton Granite Paper & Envelopes",Sales:"6.54",Quantity:"1",Discount:"0",Profit:"3.0084"},{"Row ID":"7661","Order ID":"CA-2015-105417","Order Date":"2015/1/7","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"VS-21820","Customer Name":"Vivek Sundaresam",Segment:"Consumer",Country:"United States",City:"Huntsville",State:"Texas","Postal Code":"77340",Region:"Central","Product ID":"FUR-FU-10004864",Category:"Furniture","Sub-Category":"Furnishings","Product Name":'Howard Miller 14-1/2" Diameter Chrome Round Wall Clock',Sales:"76.728",Quantity:"3",Discount:"0.6",Profit:"-53.7096"},{"Row ID":"7662","Order ID":"CA-2015-105417","Order Date":"2015/1/7","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"VS-21820","Customer Name":"Vivek Sundaresam",Segment:"Consumer",Country:"United States",City:"Huntsville",State:"Texas","Postal Code":"77340",Region:"Central","Product ID":"OFF-BI-10003708",Category:"Office Supplies","Sub-Category":"Binders","Product Name":'Acco Four Pocket Poly Ring Binder with Label Holder, Smoke, 1"',Sales:"10.43",Quantity:"7",Discount:"0.8",Profit:"-18.2525"},{"Row ID":"593","Order ID":"CA-2015-135405","Order Date":"2015/1/9","Ship Date":"2015/1/13","Ship Mode":"Standard Class","Customer ID":"MS-17830","Customer Name":"Melanie Seite",Segment:"Consumer",Country:"United States",City:"Laredo",State:"Texas","Postal Code":"78041",Region:"Central","Product ID":"OFF-AR-10004078",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Newell 312",Sales:"9.344",Quantity:"2",Discount:"0.2",Profit:"1.168"},{"Row ID":"594","Order ID":"CA-2015-135405","Order Date":"2015/1/9","Ship Date":"2015/1/13","Ship Mode":"Standard Class","Customer ID":"MS-17830","Customer Name":"Melanie Seite",Segment:"Consumer",Country:"United States",City:"Laredo",State:"Texas","Postal Code":"78041",Region:"Central","Product ID":"TEC-AC-10001266",Category:"Technology","Sub-Category":"Accessories","Product Name":"Memorex Micro Travel Drive 8 GB",Sales:"31.2",Quantity:"3",Discount:"0.2",Profit:"9.75"},{"Row ID":"866","Order ID":"CA-2015-149020","Order Date":"2015/1/10","Ship Date":"2015/1/15","Ship Mode":"Standard Class","Customer ID":"AJ-10780","Customer Name":"Anthony Jacobs",Segment:"Corporate",Country:"United States",City:"Springfield",State:"Virginia","Postal Code":"22153",Region:"South","Product ID":"OFF-LA-10004272",Category:"Office Supplies","Sub-Category":"Labels","Product Name":"Avery 482",Sales:"2.89",Quantity:"1",Discount:"0",Profit:"1.3583"},{"Row ID":"867","Order ID":"CA-2015-149020","Order Date":"2015/1/10","Ship Date":"2015/1/15","Ship Mode":"Standard Class","Customer ID":"AJ-10780","Customer Name":"Anthony Jacobs",Segment:"Corporate",Country:"United States",City:"Springfield",State:"Virginia","Postal Code":"22153",Region:"South","Product ID":"FUR-FU-10000965",Category:"Furniture","Sub-Category":"Furnishings","Product Name":'Howard Miller 11-1/2" Diameter Ridgewood Wall Clock',Sales:"51.94",Quantity:"1",Discount:"0",Profit:"21.2954"},{"Row ID":"717","Order ID":"CA-2015-130092","Order Date":"2015/1/11","Ship Date":"2015/1/14","Ship Mode":"First Class","Customer ID":"SV-20365","Customer Name":"Seth Vernon",Segment:"Consumer",Country:"United States",City:"Dover",State:"Delaware","Postal Code":"19901",Region:"East","Product ID":"FUR-FU-10000010",Category:"Furniture","Sub-Category":"Furnishings","Product Name":"DAX Value U-Channel Document Frames, Easel Back",Sales:"9.94",Quantity:"2",Discount:"0",Profit:"3.0814"},{"Row ID":"764","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-EN-10001990",Category:"Office Supplies","Sub-Category":"Envelopes","Product Name":"Staple envelope",Sales:"11.36",Quantity:"2",Discount:"0",Profit:"5.3392"},{"Row ID":"765","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-EN-10001532",Category:"Office Supplies","Sub-Category":"Envelopes","Product Name":"Brown Kraft Recycled Envelopes",Sales:"50.94",Quantity:"3",Discount:"0",Profit:"25.47"},{"Row ID":"766","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"TEC-AC-10003174",Category:"Technology","Sub-Category":"Accessories","Product Name":"Plantronics S12 Corded Telephone Headset System",Sales:"646.74",Quantity:"6",Discount:"0",Profit:"258.696"},{"Row ID":"767","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-BI-10004187",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"3-ring staple pack",Sales:"5.64",Quantity:"3",Discount:"0",Profit:"2.7072"},{"Row ID":"768","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-ST-10000025",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"Fellowes Stor/Drawer Steel Plus Storage Drawers",Sales:"572.58",Quantity:"6",Discount:"0",Profit:"34.3548"},{"Row ID":"2979","Order ID":"CA-2015-109232","Order Date":"2015/1/13","Ship Date":"2015/1/16","Ship Mode":"Second Class","Customer ID":"ND-18370","Customer Name":"Natalie DeCherney",Segment:"Consumer",Country:"United States",City:"Mount Pleasant",State:"South Carolina","Postal Code":"29464",Region:"South","Product ID":"FUR-CH-10000422",Category:"Furniture","Sub-Category":"Chairs","Product Name":"Global Highback Leather Tilter in Burgundy",Sales:"545.94",Quantity:"6",Discount:"0",Profit:"87.3504"},{"Row ID":"4938","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"OFF-ST-10000078",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"Tennsco 6- and 18-Compartment Lockers",Sales:"1325.85",Quantity:"5",Discount:"0",Profit:"238.653"},{"Row ID":"4939","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"FUR-BO-10003034",Category:"Furniture","Sub-Category":"Bookcases","Product Name":"O'Sullivan Elevations Bookcase, Cherry Finish",Sales:"333.999",Quantity:"3",Discount:"0.15",Profit:"3.9294"},{"Row ID":"4940","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"OFF-AR-10003514",Category:"Office Supplies","Sub-Category":"Art","Product Name":"4009 Highlighters by Sanford",Sales:"19.9",Quantity:"5",Discount:"0",Profit:"6.567"}],yo=[{bloggerId:1,bloggerName:"Virtual Anchor Xiaohua",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/flower.jpg",introduction:"Hi everyone, I am Xiaohua, the virtual host. I am a little fairy who likes games, animation and food. I hope to share happy moments with you through live broadcast.",fansCount:400,worksCount:10,viewCount:5,city:"Dream City",tags:["game","anime","food"]},{bloggerId:2,bloggerName:"Virtual anchor little wolf",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/wolf.jpg",introduction:"Hello everyone, I am the virtual anchor Little Wolf. I like music, travel and photography, and I hope to explore the beauty of the world with you through live broadcast.",fansCount:800,worksCount:20,viewCount:15,city:"City of Music",tags:["music","travel","photography"]},{bloggerId:3,bloggerName:"Virtual anchor bunny",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/rabbit.jpg",introduction:"Hello everyone, I am the virtual anchor Xiaotu. I like painting, handicrafts and beauty makeup. I hope to share creativity and fashion with you through live broadcast.",fansCount:600,worksCount:15,viewCount:10,city:"City of Art",tags:["painting","handmade","beauty makeup"]},{bloggerId:4,bloggerName:"Virtual anchor kitten",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/cat.jpg",introduction:"Hello everyone, I am the virtual host Kitty. I am a lazy cat who likes dancing, fitness and cooking. I hope to live a healthy and happy life with everyone through the live broadcast.",fansCount:1e3,worksCount:30,viewCount:20,city:"Health City",tags:["dance","fitness","cooking"]},{bloggerId:5,bloggerName:"Virtual anchor Bear",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bear.jpg",introduction:"Hello everyone, I am the virtual host Xiaoxiong. A little wise man who likes movies, reading and philosophy, I hope to explore the meaning of life with you through live broadcast.",fansCount:1200,worksCount:25,viewCount:18,city:"City of Wisdom",tags:["Movie","Literature"]},{bloggerId:6,bloggerName:"Virtual anchor bird",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bird.jpeg",introduction:"Hello everyone, I am the virtual anchor Xiaoniao. I like singing, acting and variety shows. I hope to be happy with everyone through the live broadcast.",fansCount:900,worksCount:12,viewCount:8,city:"Happy City",tags:["music","performance","variety"]}],po=[{dimensionKey:"Region",title:"Region",headerStyle:{textStick:!0}},"Category"],fo=[{dimensionKey:"Order Year",title:"Order Year",headerStyle:{textStick:!0}},"Ship Mode"],mo=[{indicatorKey:"Quantity",title:"Quantity",width:"auto",cellType:"chart",chartModule:"vchart",chartSpec:{stack:!0,type:"bar",data:{id:"data",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Accessories","Phones","Copiers","Machines"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},xField:["Sub-Category"],yField:"Quantity",seriesField:"Segment-Indicator",axes:[{orient:"left",visible:!0,label:{visible:!0}},{orient:"bottom",visible:!0}],bar:{state:{selected:{fill:"yellow"},selected_reverse:{opacity:.2}}},scales:[{id:"color",type:"ordinal",domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"],range:["#2E62F1","#4DC36A","#FF8406","#FFCC00","#4F44CF","#5AC8FA","#003A8C","#B08AE2","#FF6341","#98DD62","#07A199","#87DBDD"]}]},style:{padding:1}},{indicatorKey:"Sales",title:"Sales & Profit",cellType:"chart",chartModule:"vchart",chartSpec:{type:"common",series:[{type:"bar",data:{id:"data1",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Accessories","Phones","Copiers","Machines"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},stack:!0,xField:["Sub-Category"],yField:"Sales",seriesField:"Segment-Indicator",bar:{state:{selected:{fill:"yellow"},selected_reverse:{opacity:.2}}}},{type:"line",data:{id:"data2",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Phones","Accessories","Machines","Copiers"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},stack:!1,xField:["Sub-Category"],yField:"Profit",seriesField:"Segment-Indicator",line:{state:{selected:{lineWidth:3},selected_reverse:{lineWidth:1}}},point:{state:{selected:{fill:"yellow"},selected_reverse:{fill:"#ddd"}}}}],scales:[{id:"color",type:"ordinal",domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"],range:["#2E62F1","#4DC36A","#FF8406","#FFCC00","#4F44CF","#5AC8FA","#003A8C","#B08AE2","#FF6341","#98DD62","#07A199","#87DBDD"]}]},style:{padding:1}}],_o={class:"h-full"},Ao=ot({name:"plugin_tables_vtable",__name:"index",setup(D){Co("vchart",yi);const e=["#3370ff","#34c724","#ff9f1a","#ff4050","#1f2329"],t=fi(),i=Re(null),o=De(()=>({theme:t.darkMode?Ze:et})),r=Re(kt),n=Re(null),s=De(()=>({groupBy:["Category","Sub-Category"],theme:(t.darkMode?Ze:et).extends({groupTitleStyle:{fontWeight:"bold",bgColor:I=>{const{col:P,row:y,table:T}=I,_=T.getGroupTitleLevel(P,y);return _!==void 0?e[_%e.length]:"white"}}})})),l=Re(kt),d=Re(null),a=De(()=>({tooltip:{isShowOverflowTextTooltip:!0},dataConfig:{sortRules:[{sortField:"Category",sortBy:["Office Supplies","Technology","Furniture"]}]},widthMode:"standard",theme:t.darkMode?Ze:et,emptyTip:{text:"no data records"}})),u=Re([{indicatorKey:"Quantity",title:"Quantity",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},style:{padding:[16,28,16,28],color(p){return p.dataValue>=0?"black":"red"}}},{indicatorKey:"Sales",title:"Sales",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},format:p=>`$${Number(p).toFixed(2)}`,style:{padding:[16,28,16,28],color(p){return p.dataValue>=0?"black":"red"}}},{indicatorKey:"Profit",title:"Profit",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},format:p=>`$${Number(p).toFixed(2)}`,style:{padding:[16,28,16,28],color(p){return p.dataValue>=0?"black":"red"}}}]),c=Re([{dimensionKey:"City",title:"City",headerStyle:{textStick:!0},width:"auto"}]),h=Re([]),v=Re(null),g=De(()=>({rows:fo,columns:po,indicators:mo,indicatorsAsCol:!1,defaultRowHeight:200,defaultHeaderRowHeight:50,defaultColWidth:280,defaultHeaderColWidth:100,indicatorTitle:"指标",autoWrapText:!0,corner:{titleOnDimension:"row",headerStyle:{autoWrapText:!0}},legends:{orient:"bottom",type:"discrete",data:[{label:"Consumer-Quantity",shape:{fill:"#2E62F1",symbolType:"circle"}},{label:"Consumer-Quantity",shape:{fill:"#4DC36A",symbolType:"square"}},{label:"Home Office-Quantity",shape:{fill:"#FF8406",symbolType:"square"}},{label:"Consumer-Sales",shape:{fill:"#FFCC00",symbolType:"square"}},{label:"Consumer-Sales",shape:{fill:"#4F44CF",symbolType:"square"}},{label:"Home Office-Sales",shape:{fill:"#5AC8FA",symbolType:"square"}},{label:"Consumer-Profit",shape:{fill:"#003A8C",symbolType:"square"}},{label:"Consumer-Profit",shape:{fill:"#B08AE2",symbolType:"square"}},{label:"Home Office-Profit",shape:{fill:"#FF6341",symbolType:"square"}}]},theme:(t.darkMode?Ze:et).extends({bodyStyle:{borderColor:"gray",borderLineWidth:[1,0,0,1]},headerStyle:{borderColor:"gray",borderLineWidth:[0,0,1,1],hover:{cellBgColor:"#CCE0FF"}},rowHeaderStyle:{borderColor:"gray",borderLineWidth:[1,1,0,0],hover:{cellBgColor:"#CCE0FF"}},cornerHeaderStyle:{borderColor:"gray",borderLineWidth:[0,1,1,0],hover:{cellBgColor:""}},cornerRightTopCellStyle:{borderColor:"gray",borderLineWidth:[0,0,1,1],hover:{cellBgColor:""}},cornerLeftBottomCellStyle:{borderColor:"gray",borderLineWidth:[1,1,0,0],hover:{cellBgColor:""}},cornerRightBottomCellStyle:{borderColor:"gray",borderLineWidth:[1,0,0,1],hover:{cellBgColor:""}},rightFrozenStyle:{borderColor:"gray",borderLineWidth:[1,0,1,1],hover:{cellBgColor:""}},bottomFrozenStyle:{borderColor:"gray",borderLineWidth:[1,1,0,1],hover:{cellBgColor:""}},selectionStyle:{cellBgColor:"",cellBorderColor:""},frameStyle:{borderLineWidth:0}}),emptyTip:{text:"no data records"}})),f=Re({}),C=p=>{var I;(I=v==null?void 0:v.value)==null||I.vTableInstance.updateFilterRules([{filterKey:"Segment-Indicator",filteredValues:p.value}])},w=Re(null),S=De(()=>({defaultRowHeight:80,theme:t.darkMode?Ze:et})),H=Re(yo),m=Re({fontFamily:"Arial",fontSize:12,fontWeight:"bold"});return jt(()=>{fetch("https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/North_American_Superstore_Pivot_data.json").then(p=>p.json()).then(p=>{h.value=p}),fetch("https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/North_American_Superstore_Pivot_Chart_data.json").then(p=>p.json()).then(p=>{f.value=p})}),(p,I)=>{const P=mi,y=Ci,T=_i;return Ke(),Ne("div",_o,[L(T,{vertical:"",size:16},{default:me(()=>[L(P,{title:"List Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:me(()=>[L(O(pt),{ref_key:"listTableRef",ref:i,options:o.value,records:r.value,height:"400px"},{default:me(()=>[L(O(Y),{field:"Order ID",title:"Order ID",width:"auto"}),L(O(Y),{field:"Customer ID",title:"Customer ID",width:"auto"}),L(O(Y),{field:"Product Name",title:"Product Name",width:"auto"}),L(O(Y),{field:"Category",title:"Category",width:"auto"}),L(O(Y),{field:"Sub-Category",title:"Sub-Category",width:"auto"}),L(O(Y),{field:"Region",title:"Region",width:"auto"}),L(O(Y),{field:"City",title:"City",width:"auto"}),L(O(Y),{field:"Order Date",title:"Order Date",width:"auto"}),L(O(Y),{field:"Quantity",title:"Quantity",width:"auto"}),L(O(Y),{field:"Sales",title:"Sales",width:"auto"}),L(O(Y),{field:"Profit",title:"Profit",width:"auto"})]),_:1},8,["options","records"])]),_:1}),L(P,{title:"Group Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:me(()=>[L(O(pt),{ref_key:"groupTableRef",ref:n,options:s.value,records:l.value,height:"400px"},{default:me(()=>[L(O(Y),{field:"Order ID",title:"Order ID",width:"auto"}),L(O(Y),{field:"Customer ID",title:"Customer ID",width:"auto"}),L(O(Y),{field:"Product Name",title:"Product Name",width:"auto"}),L(O(Y),{field:"Category",title:"Category",width:"auto"}),L(O(Y),{field:"Sub-Category",title:"Sub-Category",width:"auto"}),L(O(Y),{field:"Region",title:"Region",width:"auto"}),L(O(Y),{field:"City",title:"City",width:"auto"}),L(O(Y),{field:"Order Date",title:"Order Date",width:"auto"}),L(O(Y),{field:"Quantity",title:"Quantity",width:"auto"}),L(O(Y),{field:"Sales",title:"Sales",width:"auto"}),L(O(Y),{field:"Profit",title:"Profit",width:"auto"})]),_:1},8,["options","records"])]),_:1}),L(P,{title:"Pivot Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:me(()=>[L(O(vo),{ref_key:"pivotTableRef",ref:d,options:a.value,records:h.value,height:"400px"},{default:me(()=>[L(O(di),{title:"Category","dimension-key":"Category","header-style":{textStick:!0},width:"auto"}),(Ke(!0),Ne(Ye,null,ht(c.value,(_,b)=>(Ke(),ut(O(hi),{key:b,"dimension-key":_.dimensionKey,title:_.title,"header-style":_.headerStyle,width:_.width},null,8,["dimension-key","title","header-style","width"]))),128)),(Ke(!0),Ne(Ye,null,ht(u.value,(_,b)=>(Ke(),ut(O(ui),{key:b,"indicator-key":_.indicatorKey,title:_.title,width:_.width,"show-sort":_.showSort,"header-style":_.headerStyle,format:_.format,style:tt(_.style)},null,8,["indicator-key","title","width","show-sort","header-style","format","style"]))),128)),L(O(ci),{"title-on-dimension":"row"}),L(O(vi),{"menu-type":"html","context-menu-items":["copy","paste","delete","..."]})]),_:1},8,["options","records"])]),_:1}),L(P,{title:"Pivot Chart",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:me(()=>[L(O(go),{ref_key:"pivotChartRef",ref:v,options:g.value,records:f.value,height:"800px",onOnLegendItemClick:C},null,8,["options","records"])]),_:1}),L(P,{title:"Custom Component",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:me(()=>[L(O(pt),{ref_key:"customLayoutListTableRef",ref:w,options:S.value,records:H.value,height:"400px"},{default:me(()=>[L(O(Y),{field:"bloggerId",title:"Order Number",width:"100"}),L(O(Y),{field:"bloggerName",title:"Anchor Nickname",width:330},{customLayout:me(({record:_,height:b,width:K})=>[L(O($e),{height:b,width:K,display:"flex","flex-direction":"row","flex-wrap":"nowrap"},{default:me(()=>[L(O($e),{height:b,width:60,display:"flex","flex-direction":"column","align-items":"center","justify-content":"space-around",fill:"red",opacity:.1},{default:me(()=>[L(O(Ht),{id:"icon0",width:50,height:50,image:_.bloggerAvatar,"corner-radius":25},null,8,["image"])]),_:2},1032,["height"]),L(O($e),{height:b,width:K-60,display:"flex","flex-direction":"column","flex-wrap":"nowrap"},{default:me(()=>[L(O($e),{height:b/2,width:K-60,display:"flex","flex-wrap":"wrap","align-items":"center",fill:"orange",opacity:.1},{default:me(()=>[L(O(Tt),{text:_.bloggerName,"font-size":13,"font-family":"sans-serif",fill:"black","bounds-padding":[0,0,0,10]},null,8,["text"]),L(O(Ht),{id:"location",image:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/location.svg",width:15,height:15,"bounds-padding":[0,0,0,10],cursor:"pointer"}),L(O(Tt),{text:_.city,"font-size":11,"font-family":"sans-serif",fill:"#6f7070"},null,8,["text"])]),_:2},1032,["height","width"]),L(O($e),{height:b/2,width:K-60,display:"flex","align-items":"center",fill:"yellow",opacity:.1},{default:me(()=>[(Ke(!0),Ne(Ye,null,ht(_==null?void 0:_.tags,j=>(Ke(),ut(O(gi),{key:j,text:j,"text-style":{fontSize:10,fontFamily:"sans-serif",fill:"rgb(51, 101, 238)"},panel:{visible:!0,fill:"#f4f4f2",cornerRadius:5},space:5,"bounds-padding":[0,0,0,5]},null,8,["text"]))),128))]),_:2},1032,["height","width"])]),_:2},1032,["height","width"])]),_:2},1032,["height","width"])]),_:1}),L(O(Y),{field:"fansCount",title:"Fans Count",width:"120","field-format":_=>_.fansCount+"w",style:tt(m.value)},null,8,["field-format","style"]),L(O(Y),{field:"worksCount",title:"Works Count",style:tt(m.value),width:"135"},null,8,["style"]),L(O(Y),{field:"viewCount",title:"View Count",width:"120","field-format":_=>_.viewCount+"w",style:tt(m.value)},null,8,["field-format","style"])]),_:1},8,["options","records"])]),_:1}),L(P,{bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:me(()=>[L(y,{label:"More VTable Demos: ",link:"https://www.visactor.com/vtable/example"})]),_:1})]),_:1})])}}});export{Ao as default};
