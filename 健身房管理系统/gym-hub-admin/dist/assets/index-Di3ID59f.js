import{_ as se,N as re}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BvwCvuJW.js";import{d as V,at as A,m as E,au as J,n as Q,q as W,a as X,r as y,av as ue,c as Y,o as G,w as a,f as e,aK as ie,z as Z,az as ee,aA as te,v as ae,ax as le,x as ne,B as z,g as $,t as j,h as s,$ as w,aL as ce,L as oe,E as pe,ar as de,b as me,aC as M,aD as _e}from"./index-BAq2SbaD.js";import{f as L}from"./sku-DCZXQNbE.js";import{a as fe,b as ve,c as K,d as he}from"./orderDetail-CXOQ_ZcE.js";import{u as ke,a as ge}from"./table-DmjEK7tG.js";import{_ as be,a as ye,b as we,c as Ne}from"./round-refresh-DNCv4Ss6.js";import{_ as xe}from"./DataTable-D6rjIJFQ.js";import"./RadioGroup-BGb2VClf.js";import"./Pagination-PYMt0YJG.js";const De=V({name:"OrderDetailOperateModal",__name:"orderDetail-operate-modal",props:A({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:A(["submitted"],["update:visible"]),setup(h,{emit:C}){E();const m=h,I=C,k=J(h,"visible"),{formRef:D,validate:u,restoreValidation:O}=Q(),{defaultRequiredRule:g}=W(),R=X(()=>({add:"新增",edit:"编辑"})[m.operateType]),l=y(N());function N(){return{id:null,orderNo:null,skuId:null,number:null,price:null}}const T={id:g,orderNo:g,skuId:g,number:g,price:g};function c(){l.value=N(),m.operateType==="edit"&&m.rowData&&Object.assign(l.value,m.rowData),l.value.url&&(p.value=[{id:"1",name:"我是react.png",status:"finished",url:l.value.url}],l.value.url)}function r(){k.value=!1}async function f(){var v;if(await u(),l.value.id){const{error:n,data:d}=await fe(l.value.id,l.value);if(n)return}else{const{error:n,data:d}=await ve(l.value);if(n)return}(v=window.$message)==null||v.success(w("common.updateSuccess")),r(),I("submitted")}ue(k,()=>{k.value?(c(),O(),U()):p.value=[]});const p=y([]),S=y([]);async function U(){const{error:v,data:n}=await L();if(n){S.value=[];for(const d of n)S.value.push({label:d.name,value:d.id})}}return(v,n)=>{const d=ae,x=te,B=le,q=ee,P=Z,o=ie,t=z,i=ne,F=ce;return G(),Y(F,{show:k.value,"onUpdate:show":n[4]||(n[4]=_=>k.value=_),title:R.value,preset:"card",class:"w-800px"},{footer:a(()=>[e(i,{justify:"end",size:16},{default:a(()=>[e(t,{onClick:r},{default:a(()=>[$(j(s(w)("common.cancel")),1)]),_:1}),e(t,{type:"primary",onClick:f},{default:a(()=>[$(j(s(w)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(o,{class:"h-480px pr-20px"},{default:a(()=>[e(P,{ref_key:"formRef",ref:D,model:l.value,rules:T,"label-placement":"left","label-width":100},{default:a(()=>[e(q,{responsive:"screen","item-responsive":""},{default:a(()=>[e(x,{span:"24 m:24",label:"订单编号：",path:"orderNo"},{default:a(()=>[e(d,{value:l.value.orderNo,"onUpdate:value":n[0]||(n[0]=_=>l.value.orderNo=_),placeholder:"请输入订单编号"},null,8,["value"])]),_:1}),e(x,{span:"24 m:24",label:"skuId：",path:"skuId",class:"pr-24px"},{default:a(()=>[e(B,{value:l.value.skuId,"onUpdate:value":n[1]||(n[1]=_=>l.value.skuId=_),options:S.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(x,{span:"24 m:24",label:"数量：",path:"number"},{default:a(()=>[e(d,{value:l.value.number,"onUpdate:value":n[2]||(n[2]=_=>l.value.number=_),placeholder:"请输入数量"},null,8,["value"])]),_:1}),e(x,{span:"24 m:24",label:"购买价格：",path:"price"},{default:a(()=>[e(d,{value:l.value.price,"onUpdate:value":n[3]||(n[3]=_=>l.value.price=_),placeholder:"请输入购买价格"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),Se=V({name:"OrderDetailSearch",__name:"orderDetail-search",props:{model:{required:!0},modelModifiers:{}},emits:A(["reset","search"],["update:model"]),setup(h,{emit:C}){E();const m=C,{formRef:I,validate:k,restoreValidation:D}=Q(),u=J(h,"model"),O=X(()=>{const{patternRules:c}=W();return{userEmail:c.email,userPhone:c.phone}});async function g(){await D(),m("reset")}async function R(){await k(),m("search")}const l=y([]);async function N(){const{error:c,data:r}=await L();if(r){l.value=[];for(const f of r)l.value.push({label:f.name,value:f.id})}}function T(){N()}return T(),(c,r)=>{const f=ae,p=te,S=le,U=we,v=z,n=Ne,d=ne,x=ee,B=Z,q=ye,P=be,o=oe;return G(),Y(o,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(P,{"default-expanded-names":["orderDetail-search"]},{default:a(()=>[e(q,{title:"搜索",name:"orderDetail-search"},{default:a(()=>[e(B,{ref_key:"formRef",ref:I,model:u.value,rules:O.value,"label-placement":"left","label-width":80},{default:a(()=>[e(x,{responsive:"screen","item-responsive":""},{default:a(()=>[e(p,{span:"24 s:12 m:6",label:"订单编号：",path:"qp_orderNo_like",class:"pr-24px"},{default:a(()=>[e(f,{value:u.value.qp_orderNo_like,"onUpdate:value":r[0]||(r[0]=t=>u.value.qp_orderNo_like=t),placeholder:"请输入"},null,8,["value"])]),_:1}),e(p,{span:"24 s:12 m:6",label:"skuId：",path:"qp_skuId_eq",class:"pr-24px"},{default:a(()=>[e(S,{value:u.value.qp_skuId_eq,"onUpdate:value":r[1]||(r[1]=t=>u.value.qp_skuId_eq=t),options:l.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(p,{span:"24 s:12 m:6",label:"数量：",path:"qp_number_like",class:"pr-24px"},{default:a(()=>[e(f,{value:u.value.qp_number_like,"onUpdate:value":r[2]||(r[2]=t=>u.value.qp_number_like=t),placeholder:"请输入"},null,8,["value"])]),_:1}),e(p,{span:"24 s:12 m:6",label:"购买价格：",path:"qp_price_like",class:"pr-24px"},{default:a(()=>[e(f,{value:u.value.qp_price_like,"onUpdate:value":r[3]||(r[3]=t=>u.value.qp_price_like=t),placeholder:"请输入"},null,8,["value"])]),_:1}),e(p,{span:"24 m:6",class:"pr-24px"},{default:a(()=>[e(d,{class:"w-full",justify:"start"},{default:a(()=>[e(v,{onClick:g},{icon:a(()=>[e(U,{class:"text-icon"})]),default:a(()=>[$(" "+j(s(w)("common.reset")),1)]),_:1}),e(v,{type:"primary",ghost:"",onClick:R},{icon:a(()=>[e(n,{class:"text-icon"})]),default:a(()=>[$(" "+j(s(w)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}}),qe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function H(h){return typeof h=="function"||Object.prototype.toString.call(h)==="[object Object]"&&!_e(h)}const ze=V({name:"orderdetail",__name:"index",setup(h){const C=pe(),{bool:m,setTrue:I}=de();E(),y(null);const{columns:k,columnChecks:D,data:u,loading:O,pagination:g,getData:R,getDataByPage:l,searchParams:N,resetSearchParams:T}=ke({apiFn:he,apiParams:{currentPage:1,pageSize:10,qp_orderNo_like:null,qp_skuId_eq:null,qp_number_like:null,qp_price_like:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:"序号",align:"center"},{key:"orderNo",title:"订单编号",align:"center"},{key:"skuId",title:"skuId",align:"center",render:o=>{if(o.skuId){let t=[];for(const i of q.value)i.value===o.skuId&&t.push(i.label);return t.join("、")}return""}},{key:"number",title:"数量",align:"center"},{key:"price",title:"购买价格",align:"center"},{key:"modifyUser",title:"修改人",align:"center"},{key:"modifyTime",title:"修改时间",width:154,align:"center",render:o=>o.modifyTime?o.modifyTime.replace("T"," "):""},{key:"operate",title:w("common.operate"),align:"center",width:230,render:o=>{let t;return e("div",{class:"flex-center justify-center gap-8px"},[e(z,{type:"primary",ghost:!0,size:"small",onClick:()=>d(o)},H(t=w("common.edit"))?t:{default:()=>[t]}),e(re,{onPositiveClick:()=>v(o.id)},{default:()=>w("common.confirmDelete"),trigger:()=>{let i;return e(z,{type:"error",ghost:!0,size:"small"},H(i=w("common.delete"))?i:{default:()=>[i]})}})])}}]}),{checkedRowKeys:c,onBatchDeleted:r,onDeleted:f}=ge(u,R),p=y("add");function S(){p.value="add",I()}async function U(){const{error:o,data:t}=await K(c.value);console.log(c.value),r()}async function v(o){const{error:t,data:i}=await K(o);console.log(o),f()}const n=y(null);function d(o){p.value="edit",n.value={...o},I()}const x=y([]);function B(){P()}const q=y([]);async function P(){const{error:o,data:t}=await L();if(t){q.value=[];for(const i of t)q.value.push({label:i.name,value:i.id})}}return B(),(o,t)=>{const i=se,F=xe,_=oe;return G(),me("div",qe,[e(Se,{model:s(N),"onUpdate:model":t[0]||(t[0]=b=>M(N)?N.value=b:null),onReset:s(T),onSearch:s(l)},null,8,["model","onReset","onSearch"]),e(_,{title:"数据列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[e(i,{columns:s(D),"onUpdate:columns":t[1]||(t[1]=b=>M(D)?D.value=b:null),"disabled-delete":s(c).length===0,loading:s(O),onAdd:S,onDelete:U,onRefresh:s(R)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:a(()=>[e(F,{"checked-row-keys":s(c),"onUpdate:checkedRowKeys":t[2]||(t[2]=b=>M(c)?c.value=b:null),columns:s(k),data:s(u),size:"small","flex-height":!s(C).isMobile,"scroll-x":1088,loading:s(O),"row-key":b=>b.id,remote:"",pagination:s(g),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(De,{visible:s(m),"onUpdate:visible":t[3]||(t[3]=b=>M(m)?m.value=b:null),"operate-type":p.value,"row-data":n.value,"all-pages":x.value,onSubmitted:s(l)},null,8,["visible","operate-type","row-data","all-pages","onSubmitted"])]),_:1})])}}});export{ze as default};
