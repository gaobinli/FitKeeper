import{_ as pe,N as ce}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BvwCvuJW.js";import{aI as F,aJ as de,d as G,at as V,m as H,au as Y,n as Z,q as ee,a as te,r as f,av as me,c as ne,o as W,w as n,f as e,aK as _e,z as ae,az as oe,aA as le,ax as se,x as re,B as $,g as j,t as z,h as i,$ as w,aL as fe,v as ve,L as ue,E as ke,ar as he,b as ge,aC as P,aD as ye}from"./index-BAq2SbaD.js";import{f as K}from"./sku-DCZXQNbE.js";import{f as J}from"./user-CToCrV-S.js";import{u as be,a as we}from"./table-DmjEK7tG.js";import{W as xe}from"./WangEditor-BCwDbreK.js";import{_ as ie}from"./Rate-pIVGMApm.js";import{_ as Ae,a as Se,b as Ie,c as Ne}from"./round-refresh-DNCv4Ss6.js";import{_ as qe}from"./DataTable-D6rjIJFQ.js";import"./wangEditor-CAqzKAJM.js";import"./RadioGroup-BGb2VClf.js";import"./Pagination-PYMt0YJG.js";function De(p){return F({url:de("/skuAppraise",p),method:"get"})}function Oe(p){return F({url:"/skuAppraise",method:"post",data:p})}function Ue(p,I){return F({url:"/skuAppraise/"+p,method:"patch",data:I})}function Q(p){return F({url:"/skuAppraise/"+p,method:"delete"})}const Re=G({name:"SkuAppraiseOperateModal",__name:"skuAppraise-operate-modal",props:V({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:V(["submitted"],["update:visible"]),setup(p,{emit:I}){H();const v=p,O=I,g=Y(p,"visible"),{formRef:N,validate:m,restoreValidation:U}=Z(),{defaultRequiredRule:k}=ee(),R=te(()=>({add:"新增",edit:"编辑"})[v.operateType]),o=f(x());function x(){return{id:null,skuId:null,userId:null,content:null,experienceAppraise:null,skuAppraise:null,orderNo:null}}const q={id:k,skuId:k,userId:k,content:k,experienceAppraise:k,skuAppraise:k,orderNo:k};function h(){o.value=x(),v.operateType==="edit"&&v.rowData&&Object.assign(o.value,v.rowData),o.value.url&&(r.value=[{id:"1",name:"我是react.png",status:"finished",url:o.value.url}],o.value.url)}function T(){g.value=!1}async function y(){var _;if(await m(),o.value.id){const{error:l,data:c}=await Ue(o.value.id,o.value);if(l)return}else{const{error:l,data:c}=await Oe(o.value);if(l)return}(_=window.$message)==null||_.success(w("common.updateSuccess")),T(),O("submitted")}me(g,()=>{g.value?(h(),U(),A(),C()):r.value=[]});const r=f([]),d=f([]);async function A(){const{error:_,data:l}=await K();if(l){d.value=[];for(const c of l)d.value.push({label:c.name,value:c.id})}}const D=f([]);async function C(){const{error:_,data:l}=await J();if(l){D.value=[];for(const c of l)D.value.push({label:c.name,value:c.id})}}const B=_=>{o.value.content=_};return(_,l)=>{const c=se,b=le,S=ie,M=oe,a=ae,t=_e,s=$,E=re,L=fe;return W(),ne(L,{show:g.value,"onUpdate:show":l[4]||(l[4]=u=>g.value=u),title:R.value,preset:"card",class:"w-800px"},{footer:n(()=>[e(E,{justify:"end",size:16},{default:n(()=>[e(s,{onClick:T},{default:n(()=>[j(z(i(w)("common.cancel")),1)]),_:1}),e(s,{type:"primary",onClick:y},{default:n(()=>[j(z(i(w)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[e(t,{class:"h-480px pr-20px"},{default:n(()=>[e(a,{ref_key:"formRef",ref:N,model:o.value,rules:q,"label-placement":"left","label-width":100},{default:n(()=>[e(M,{responsive:"screen","item-responsive":""},{default:n(()=>[e(b,{span:"24 m:24",label:"课程：",path:"skuId",class:"pr-24px"},{default:n(()=>[e(c,{value:o.value.skuId,"onUpdate:value":l[0]||(l[0]=u=>o.value.skuId=u),options:d.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(b,{span:"24 m:24",label:"用户：",path:"userId",class:"pr-24px"},{default:n(()=>[e(c,{value:o.value.userId,"onUpdate:value":l[1]||(l[1]=u=>o.value.userId=u),options:D.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(b,{span:"24 m:24",label:"学习体验评分：",path:"experienceAppraise"},{default:n(()=>[e(S,{value:o.value.experienceAppraise,"onUpdate:value":l[2]||(l[2]=u=>o.value.experienceAppraise=u),placeholder:"请输入学习体验评分"},null,8,["value"])]),_:1}),e(b,{span:"24 m:24",label:"课程评分：",path:"skuAppraise"},{default:n(()=>[e(S,{value:o.value.skuAppraise,"onUpdate:value":l[3]||(l[3]=u=>o.value.skuAppraise=u),placeholder:"请输入课程评分"},null,8,["value"])]),_:1}),e(b,{span:"24 m:24",label:"评价内容：",path:"content"},{default:n(()=>[e(xe,{contentHtml:o.value.content,onGetWangEditorValue:B},null,8,["contentHtml"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),Te=G({name:"SkuAppraiseSearch",__name:"skuAppraise-search",props:{model:{required:!0},modelModifiers:{}},emits:V(["reset","search"],["update:model"]),setup(p,{emit:I}){H();const v=I,{formRef:O,validate:g,restoreValidation:N}=Z(),m=Y(p,"model"),U=te(()=>{const{patternRules:y}=ee();return{userEmail:y.email,userPhone:y.phone}});async function k(){await N(),v("reset")}async function R(){await g(),v("search")}const o=f([]);async function x(){const{error:y,data:r}=await K();if(r){o.value=[];for(const d of r)o.value.push({label:d.name,value:d.id})}}const q=f([]);async function h(){const{error:y,data:r}=await J();if(r){q.value=[];for(const d of r)q.value.push({label:d.name,value:d.id})}}function T(){x(),h()}return T(),(y,r)=>{const d=se,A=le,D=ve,C=Ie,B=$,_=Ne,l=re,c=oe,b=ae,S=Se,M=Ae,a=ue;return W(),ne(a,{bordered:!1,size:"small",class:"card-wrapper"},{default:n(()=>[e(M,{"default-expanded-names":["skuAppraise-search"]},{default:n(()=>[e(S,{title:"搜索",name:"skuAppraise-search"},{default:n(()=>[e(b,{ref_key:"formRef",ref:O,model:m.value,rules:U.value,"label-placement":"left","label-width":80},{default:n(()=>[e(c,{responsive:"screen","item-responsive":""},{default:n(()=>[e(A,{span:"24 s:12 m:6",label:"课程：",path:"qp_skuId_eq",class:"pr-24px"},{default:n(()=>[e(d,{value:m.value.qp_skuId_eq,"onUpdate:value":r[0]||(r[0]=t=>m.value.qp_skuId_eq=t),options:o.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(A,{span:"24 s:12 m:6",label:"用户：",path:"qp_userId_eq",class:"pr-24px"},{default:n(()=>[e(d,{value:m.value.qp_userId_eq,"onUpdate:value":r[1]||(r[1]=t=>m.value.qp_userId_eq=t),options:q.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(A,{span:"24 s:12 m:6",label:"评价内容：",path:"qp_content_like",class:"pr-24px"},{default:n(()=>[e(D,{value:m.value.qp_content_like,"onUpdate:value":r[2]||(r[2]=t=>m.value.qp_content_like=t),placeholder:"请输入"},null,8,["value"])]),_:1}),e(A,{span:"24 m:6",class:"pr-24px"},{default:n(()=>[e(l,{class:"w-full",justify:"start"},{default:n(()=>[e(B,{onClick:k},{icon:n(()=>[e(C,{class:"text-icon"})]),default:n(()=>[j(" "+z(i(w)("common.reset")),1)]),_:1}),e(B,{type:"primary",ghost:"",onClick:R},{icon:n(()=>[e(_,{class:"text-icon"})]),default:n(()=>[j(" "+z(i(w)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}}),Ce={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function X(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!ye(p)}const We=G({name:"skuappraise",__name:"index",setup(p){const I=ke(),{bool:v,setTrue:O}=he();H(),f(null);const{columns:g,columnChecks:N,data:m,loading:U,pagination:k,getData:R,getDataByPage:o,searchParams:x,resetSearchParams:q}=be({apiFn:De,apiParams:{currentPage:1,pageSize:10,qp_skuId_eq:null,qp_userId_eq:null,qp_content_like:null,qp_experienceAppraise_like:null,qp_skuAppraise_like:null,qp_orderNo_like:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:"序号",align:"center"},{key:"skuId",title:"美食",align:"center",render:a=>{if(a.skuId){let t=[];for(const s of c.value)s.value===a.skuId&&t.push(s.label);return t.join("、")}return""}},{key:"userId",title:"用户",align:"center",render:a=>{if(a.userId){let t=[];for(const s of S.value)s.value===a.userId&&t.push(s.label);return t.join("、")}return""}},{key:"content",title:"评价内容",align:"center",render:a=>e("span",{innerHTML:a.content},null)},{key:"skuAppraise",title:"美食评分",align:"center",render:a=>e(ie,{readonly:!0,"default-value":a.skuAppraise},null)},{key:"modifyUser",title:"修改人",align:"center"},{key:"modifyTime",title:"修改时间",width:154,align:"center",render:a=>a.modifyTime?a.modifyTime.replace("T"," "):""},{key:"operate",title:w("common.operate"),align:"center",width:230,render:a=>{let t;return e("div",{class:"flex-center justify-center gap-8px"},[e($,{type:"primary",ghost:!0,size:"small",onClick:()=>B(a)},X(t=w("common.edit"))?t:{default:()=>[t]}),e(ce,{onPositiveClick:()=>D(a.id)},{default:()=>w("common.confirmDelete"),trigger:()=>{let s;return e($,{type:"error",ghost:!0,size:"small"},X(s=w("common.delete"))?s:{default:()=>[s]})}})])}}]}),{checkedRowKeys:h,onBatchDeleted:T,onDeleted:y}=we(m,R),r=f("add");function d(){r.value="add",O()}async function A(){const{error:a,data:t}=await Q(h.value);console.log(h.value),T()}async function D(a){const{error:t,data:s}=await Q(a);console.log(a),y()}const C=f(null);function B(a){r.value="edit",C.value={...a},O()}const _=f([]);function l(){b(),M()}const c=f([]);async function b(){const{error:a,data:t}=await K();if(t){c.value=[];for(const s of t)c.value.push({label:s.name,value:s.id})}}const S=f([]);async function M(){const{error:a,data:t}=await J();if(t){S.value=[];for(const s of t)S.value.push({label:s.name,value:s.id})}}return l(),(a,t)=>{const s=pe,E=qe,L=ue;return W(),ge("div",Ce,[e(Te,{model:i(x),"onUpdate:model":t[0]||(t[0]=u=>P(x)?x.value=u:null),onReset:i(q),onSearch:i(o)},null,8,["model","onReset","onSearch"]),e(L,{title:"数据列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":n(()=>[e(s,{columns:i(N),"onUpdate:columns":t[1]||(t[1]=u=>P(N)?N.value=u:null),"disabled-delete":i(h).length===0,loading:i(U),onAdd:d,onDelete:A,onRefresh:i(R)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:n(()=>[e(E,{"checked-row-keys":i(h),"onUpdate:checkedRowKeys":t[2]||(t[2]=u=>P(h)?h.value=u:null),columns:i(g),data:i(m),size:"small","flex-height":!i(I).isMobile,"scroll-x":1088,loading:i(U),"row-key":u=>u.id,remote:"",pagination:i(k),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Re,{visible:i(v),"onUpdate:visible":t[3]||(t[3]=u=>P(v)?v.value=u:null),"operate-type":r.value,"row-data":C.value,"all-pages":_.value,onSubmitted:i(o)},null,8,["visible","operate-type","row-data","all-pages","onSubmitted"])]),_:1})])}}});export{We as default};
