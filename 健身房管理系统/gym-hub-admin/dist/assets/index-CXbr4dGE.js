import{_ as yt}from"./web-site-link.vue_vue_type_script_setup_true_lang-C943zWtg.js";import{G as O,c as Q,S as tt,T as ee,a as et,b as mt,I as He,C as it,L as ft,i as _t,B as kt,d as St,e as Lt,P as Bt,v as Fe,f as xt,g as Tt,h as Ct,D as Pe,j as at,k as wt}from"./index-CAM7bcOv.js";import{i as J}from"./symlog-scale-BFgIQWoy.js";import{d as Ot,F as Dt,d3 as Oe,av as zt,i as Wt,aF as At,c as Pt,o as Mt,w as We,f as Ae,L as Ft,e as Je,x as Ht}from"./index-BAq2SbaD.js";import"./index-BgyTeVoR.js";var T;(function(a){a.default="default",a.grabing="grabing",a.scrolling="scrolling"})(T||(T={}));var R;(function(a){a.FinishToStart="finish_to_start",a.StartToStart="start_to_start",a.FinishToFinish="finish_to_finish",a.StartToFinish="start_to_finish"})(R||(R={}));const H={SCROLL:"scroll",CHANGE_DATE_RANGE:"change_date_range",CLICK_TASK_BAR:"click_task_bar",MOUSEENTER_TASK_BAR:"mouseenter_task_bar",MOUSELEAVE_TASK_BAR:"mouseleave_task_bar",CREATE_TASK_SCHEDULE:"create_task_schedule",CREATE_DEPENDENCY_LINK:"create_dependency_link"};class Rt{constructor(e){var t,i,n,s,r,l,o;this._scene=e,this.vertical=!!e._gantt.parsedOptions.grid.verticalLine,this.horizontal=!!e._gantt.parsedOptions.grid.horizontalLine,this.gridStyle=e._gantt.parsedOptions.grid,this.scrollLeft=0,this.scrollTop=0,this.x=0,this.y=e._gantt.getAllHeaderRowsHeight(),this.width=e.tableGroup.attribute.width,this.height=e.tableGroup.attribute.height-e.timelineHeader.group.attribute.height,this.timelineDates=e._gantt.parsedOptions.reverseSortedTimelineScales[0].timelineDates,this.colWidthPerDay=e._gantt.parsedOptions.colWidthPerDay,this.rowHeight=e._gantt.parsedOptions.rowHeight,this.rowCount=e._gantt.itemCount,this.allGridWidth=e._gantt._getAllColsWidth(),this.allGridHeight=e._gantt.getAllTaskBarsHeight(),this.group=new O({x:this.x,y:this.y,width:this.width,height:this.height,clip:!0,fill:(t=this.gridStyle)===null||t===void 0?void 0:t.backgroundColor}),this.group.name="grid-container",e.tableGroup.addChild(this.group),this.createVerticalLines(),this.createHorizontalLines();const d=(n=(i=e._gantt.parsedOptions.horizontalSplitLine)===null||i===void 0?void 0:i.lineWidth)!==null&&n!==void 0?n:(s=e._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||s===void 0?void 0:s.lineWidth,h=(1&d?-.5:0)+d/2,c=Q({pickable:!1,stroke:(l=(r=e._gantt.parsedOptions.horizontalSplitLine)===null||r===void 0?void 0:r.lineColor)!==null&&l!==void 0?l:(o=e._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||o===void 0?void 0:o.lineColor,lineWidth:d+(1&d?1:0),points:[{x:0,y:h},{x:e._gantt._getAllColsWidth(),y:h}]});c.name="timeLine-header-bottom-line",this.group.addChild(c)}createVerticalLines(){var e,t,i;if(this.vertical){this.verticalLineGroup=new O({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.verticalLineGroup.name="grid-vertical",this.group.appendChild(this.verticalLineGroup);let n=0;1&((e=this.gridStyle)===null||e===void 0?void 0:e.verticalLine.lineWidth)&&(n=.5);for(let s=0;s<this.timelineDates.length-1;s++){const r=this.timelineDates[s];n+=Math.floor(this.colWidthPerDay*r.days);const l=Q({pickable:!1,stroke:(t=this.gridStyle)===null||t===void 0?void 0:t.verticalLine.lineColor,lineWidth:(i=this.gridStyle)===null||i===void 0?void 0:i.verticalLine.lineWidth,points:[{x:n,y:0},{x:n,y:this.allGridHeight}]});this.verticalLineGroup.appendChild(l)}}}createHorizontalLines(){var e,t,i;if(this.horizontal){this.horizontalLineGroup=new O({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.horizontalLineGroup.name="grid-horizontal",this.group.appendChild(this.horizontalLineGroup);let n=0;1&((e=this.gridStyle)===null||e===void 0?void 0:e.horizontalLine.lineWidth)&&(n+=.5);for(let s=0;s<this.rowCount-1;s++){n+=Math.floor(this.rowHeight);const r=Q({pickable:!1,stroke:(t=this.gridStyle)===null||t===void 0?void 0:t.horizontalLine.lineColor,lineWidth:(i=this.gridStyle)===null||i===void 0?void 0:i.horizontalLine.lineWidth,points:[{x:0,y:n},{x:this.allGridWidth,y:n}]});this.horizontalLineGroup.appendChild(r)}}}refresh(){var e,t;this.width=this._scene.tableGroup.attribute.width,this.height=this._scene.tableGroup.attribute.height-this._scene.timelineHeader.group.attribute.height,this.group.setAttributes({width:this.width,height:this.height,y:this._scene._gantt.getAllHeaderRowsHeight()}),this.rowCount=this._scene._gantt.itemCount,this.allGridWidth=this._scene._gantt._getAllColsWidth(),this.allGridHeight=this._scene._gantt.getAllTaskBarsHeight(),(e=this.verticalLineGroup)===null||e===void 0||e.parent.removeChild(this.verticalLineGroup),(t=this.horizontalLineGroup)===null||t===void 0||t.parent.removeChild(this.horizontalLineGroup),this.createVerticalLines(),this.createHorizontalLines()}setX(e){var t,i;(t=this.verticalLineGroup)===null||t===void 0||t.setAttribute("x",e),(i=this.horizontalLineGroup)===null||i===void 0||i.setAttribute("x",e)}setY(e){var t,i;(t=this.verticalLineGroup)===null||t===void 0||t.setAttribute("y",e),(i=this.horizontalLineGroup)===null||i===void 0||i.setAttribute("y",e)}resize(){this.width=this._scene.tableGroup.attribute.width,this.height=this._scene.tableGroup.attribute.height-this._scene.timelineHeader.group.attribute.height,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}}class z{static get mode(){return z._mode||(z._mode=It()),z._mode}static set mode(e){z._mode=e}static RegisterCreateCanvas(e){z.CreateCanvas=e}static RegisterLoadImage(e){z.LoadImage=e}static GetCreateCanvasFunc(){return z.CreateCanvas?z.CreateCanvas:z.mode==="worker"?(e=200,t=200)=>new OffscreenCanvas(e,t):void 0}static RegisterRequestAnimationFrame(e){z.RequestAnimationFrame=e()}static GetRequestAnimationFrame(){if(z.RequestAnimationFrame)return z.RequestAnimationFrame}static RegisterCancelAnimationFrame(e){z.CancelAnimationFrame=e()}static GetCancelAnimationFrame(){if(z.CancelAnimationFrame)return z.CancelAnimationFrame}}function It(){let a="browser";try{window.type==="node"?a="node":typeof window>"u"||window.performance?typeof window>"u"&&(a="node"):a="miniApp"}catch{a="node"}return a}z.dpr=0;class Et{constructor(e){this._gantt=e,this.createScrollBar(e.tableNoFrameWidth,e.tableNoFrameHeight-e.getAllHeaderRowsHeight())}createScrollBar(e,t){var i,n;const s=this._gantt.parsedOptions.scrollStyle.scrollRailColor,r=this._gantt.parsedOptions.scrollStyle.scrollSliderColor,l=this._gantt.parsedOptions.scrollStyle.scrollSliderCornerRadius,o=this._gantt.parsedOptions.scrollStyle.width;let d;d=J(l)?{cornerRadius:l,fill:r}:{fill:r},(i=this._gantt.parsedOptions.scrollStyle)===null||i===void 0||i.visible,(n=this._gantt.parsedOptions.scrollStyle)===null||n===void 0||n.hoverOn,this.hScrollBar=new tt({direction:"horizontal",x:2*-e,y:2*-t,width:e,height:o,padding:0,railStyle:{fill:s},sliderStyle:d,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new tt({direction:"vertical",x:2*-e,y:2*-t,width:o,height:t,padding:0,railStyle:{fill:s},sliderStyle:d,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}refresh(){}hideVerticalScrollBar(){const e=this._gantt.parsedOptions.scrollStyle.visible;e!=="focus"&&e!=="scrolling"||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this._gantt.scenegraph.updateNextFrame())}showVerticalScrollBar(e){const t=this._gantt.parsedOptions.scrollStyle.visible;t!=="focus"&&t!=="scrolling"||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this._gantt.scenegraph.updateNextFrame(),e&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{this.hideVerticalScrollBar()},1e3)))}hideHorizontalScrollBar(){const e=this._gantt.parsedOptions.scrollStyle.visible;e!=="focus"&&e!=="scrolling"||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this._gantt.scenegraph.updateNextFrame())}showHorizontalScrollBar(e){const t=this._gantt.parsedOptions.scrollStyle.visible;t!=="focus"&&t!=="scrolling"||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this._gantt.scenegraph.updateNextFrame(),e&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{this.hideHorizontalScrollBar()},1e3)))}updateVerticalScrollBarPos(e){const t=this.vScrollBar.attribute.range,i=t[1]-t[0],n=e*(1-i);this.vScrollBar.setAttribute("range",[n,n+i]);const s=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:s.x1,y:s.y1}}updateHorizontalScrollBarPos(e){const t=this.hScrollBar.attribute.range,i=t[1]-t[0],n=e*(1-i);this.hScrollBar.setAttribute("range",[n,n+i]);const s=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:s.x1,y:s.y1}}updateScrollBar(){const e=this._gantt.stateManager.scroll.horizontalBarPos,t=this._gantt.stateManager.scroll.verticalBarPos,i=this._gantt.parsedOptions.scrollStyle,n=i==null?void 0:i.width,s=i==null?void 0:i.visible,r=Math.ceil(this._gantt.scenegraph.tableGroup.attribute.width),l=Math.ceil(this._gantt.scenegraph.tableGroup.attribute.height),o=this._gantt.getAllRowsHeight(),d=this._gantt._getAllColsWidth(),h=this._gantt.getAllHeaderRowsHeight();if(d>r){const c=Math.min(l,o),u=Math.max(.05,r/d),g=i.hoverOn;let p=0;p=i.barToSide?this._gantt.tableNoFrameHeight-(g?n:-this._gantt.scenegraph.tableGroup.attribute.y)+this._gantt.tableY:c-(g?n:-this._gantt.scenegraph.tableGroup.attribute.y)+this._gantt.tableY,this.hScrollBar.setAttributes({x:this._gantt.scenegraph.tableGroup.attribute.x,y:p,width:r,range:[0,u],visible:s==="always"});const m=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:m.x1,y:m.y1},s==="always"&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:2*-this._gantt.tableNoFrameWidth,y:2*-this._gantt.tableNoFrameHeight,width:0,visible:!1});if(o>l){const c=Math.min(r,d)+this._gantt.scenegraph.tableGroup.attribute.x,u=Math.max(.05,(l-h)/(o-h));let g=0;const p=this._gantt.parsedOptions.scrollStyle.hoverOn;g=this._gantt.parsedOptions.scrollStyle.barToSide?this._gantt.tableNoFrameWidth-(p?n:-this._gantt.scenegraph.tableGroup.attribute.x):c-(p?n:-this._gantt.scenegraph.tableGroup.attribute.x),this.vScrollBar.setAttributes({x:g,y:h+(p?0:this._gantt.scenegraph.tableGroup.attribute.y)+this._gantt.tableY,height:l-h,range:[0,u],visible:s==="always"});const m=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:m.x1,y:m.y1},s==="always"&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:2*-this._gantt.tableNoFrameWidth,y:2*-this._gantt.tableNoFrameHeight,height:0,visible:!1});this._gantt.stateManager.setScrollLeft(e),this._gantt.stateManager.setScrollTop(t)}}function nt(a,e){let t=null;return function(...i){t||(a.apply(this,i),t=setTimeout(()=>{t=null},e))}}function we(a,e){const t=a.getFullYear().toString(),i=(a.getMonth()+1).toString().padStart(2,"0"),n=a.getDate().toString().padStart(2,"0");return e=(e=(e=e.replace("yyyy",t)).replace("mm",i)).replace("dd",n)}function Nt(a,e){const t=e.indexOf("yyyy"),i=e.indexOf("mm"),n=e.indexOf("dd"),s=i<t?i<n?0:1:i<n?1:2,r=n<t?n<i?0:1:n<i?1:2,l=parseInt(a[t<i?t<n?0:1:i<n?1:2],10),o=parseInt(a[s],10)-1,d=parseInt(a[r],10);if(isNaN(l)||l<1||isNaN(o)||o<0||o>11)return!1;const h=[31,jt(l)?29:28,31,30,31,30,31,31,30,31,30,31];return!(isNaN(d)||d<1||d>h[o])}function jt(a){return a%4==0&&a%100!=0||a%400==0}function Gt(a){const e=["yyyy-mm-dd","dd-mm-yyyy","mm/dd/yyyy","yyyy/mm/dd","dd/mm/yyyy","yyyy.mm.dd","dd.mm.yyyy","mm.dd.yyyy"];a=a.replace(/\s+/g,"");for(let t=0;t<e.length;t++){const i=e[t],n=a.split(Xt(i)),s=Nt(n,i);if(n.length===3&&s)return i}return null}function Xt(a){const e=a.match(/[^\w]/g);if(e){const t=e.map(i=>"\\"+i).join("|");return new RegExp(t,"g")}return/[^\w]/}function Yt(a,e){return a.replace(/\{([^}]+)\}/g,(t,i)=>{const n=i.split(".");let s=e;for(const r of n){if(!s.hasOwnProperty(r)){s=t;break}s=s[r]}return s})}function ct(a){return Array.isArray(a)?a.length===3?[a[0],a[1],a[2],a[1]]:a.length===2?[a[0],a[1],a[0],a[1]]:a.length===1?[a[0],a[0],a[0],a[0]]:[a[0],a[1],a[2],a[3]]:[a,a,a,a]}function Vt(a){const e=new Date(a.getFullYear(),0,1);return Math.ceil(((a.getTime()+1-e.getTime())/864e5+1)/7)}function Kt(a,e="long"){const t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=new Date(a);return e==="short"?t[i.getDay()].substr(0,3):e==="long"?t[i.getDay()]:'Invalid format specified. Please use "short" or "long".'}function $t(a,e){const t=Object.getOwnPropertyDescriptor(a,e);return!!t&&(!!t.set||t.writable===!0)}function C(a){let e;return e=a?new Date(a):new Date,e.setHours(0,0,0,0),e}function qt(a,e,t,i=!0){let{deltaX:n,deltaY:s}=a;a.shiftKey&&a.deltaY&&(n=s,s=0);const[r,l]=Ut(n,s,{horizontal:1,vertical:1});r&&(e.setScrollLeft(e.scroll.horizontalBarPos+r),t.scenegraph.scrollbarComponent.showHorizontalScrollBar(!0)),l&&(e.setScrollTop(e.scroll.verticalBarPos+l),t.scenegraph.scrollbarComponent.showVerticalScrollBar(!0)),i&&e.resetInteractionState(),a.cancelable&&(e._gantt.parsedOptions.overscrollBehavior==="none"||Math.abs(s)>=Math.abs(n)&&s!==0&&Zt(s,e)||Math.abs(s)<=Math.abs(n)&&n!==0&&Jt(n,e))&&a.preventDefault()}function Ut(a,e,t){var i,n;const s=Math.abs(a/e),r=s<=.5?0:a,l=s>2?0:e;return[Math.ceil(r*((i=t.horizontal)!==null&&i!==void 0?i:0)),Math.ceil(l*((n=t.vertical)!==null&&n!==void 0?n:0))]}function Zt(a,e){return e._gantt.getAllRowsHeight()-e._gantt.scenegraph.height!=0&&!Qt(a,e)&&!ei(a,e)}function Jt(a,e){return e._gantt._getAllColsWidth()-e._gantt.scenegraph.width!=0&&!ti(a,e)&&!ii(a,e)}function Qt(a,e){return e._gantt.getAllRowsHeight()-e._gantt.scenegraph.height!==0&&a<=0&&e.scroll.verticalBarPos<1}function ei(a,e){const t=e._gantt.getAllRowsHeight()-e._gantt.scenegraph.height;return t!==0&&a>=0&&Math.abs(e.scroll.verticalBarPos-t)<1}function ti(a,e){return e._gantt._getAllColsWidth()-e._gantt.scenegraph.width!==0&&a<=0&&e.scroll.horizontalBarPos<1}function ii(a,e){const t=e._gantt._getAllColsWidth()-e._gantt.scenegraph.width;return t!==0&&a>=0&&Math.abs(e.scroll.horizontalBarPos-t)<1}function ai(a){const e=a._gantt,t=e.stateManager,i=e.scenegraph;i.scrollbarComponent.vScrollBar.addEventListener("pointerover",r=>{i.scrollbarComponent.showVerticalScrollBar()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerover",r=>{i.scrollbarComponent.showHorizontalScrollBar()}),i.scrollbarComponent.vScrollBar.addEventListener("pointerout",r=>{t.interactionState!==T.scrolling&&i.scrollbarComponent.hideVerticalScrollBar()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerout",r=>{t.interactionState!==T.scrolling&&i.scrollbarComponent.hideHorizontalScrollBar()}),i.scrollbarComponent.vScrollBar.addEventListener("pointermove",r=>{r.stopPropagation()}),i.scrollbarComponent.vScrollBar.addEventListener("scrollDown",r=>{i._gantt.eventManager.isDown=!0}),i.scrollbarComponent.vScrollBar.addEventListener("pointerup",()=>{i._gantt.eventManager.isDraging=!1,t.interactionState===T.scrolling&&t.updateInteractionState(T.default)}),i.scrollbarComponent.vScrollBar.addEventListener("pointerupoutside",()=>{t.interactionState===T.scrolling&&t.updateInteractionState(T.default)}),i.scrollbarComponent.vScrollBar.addEventListener("scrollUp",r=>{i._gantt.eventManager.isDraging=!1}),i.scrollbarComponent.hScrollBar.addEventListener("pointermove",r=>{r.stopPropagation()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerdown",r=>{r.stopPropagation()}),i.scrollbarComponent.hScrollBar.addEventListener("scrollDown",r=>{i._gantt.eventManager.isDown=!0,t.interactionState!==T.scrolling&&t.updateInteractionState(T.scrolling)}),i.scrollbarComponent.hScrollBar.addEventListener("pointerup",()=>{t.interactionState===T.scrolling&&t.updateInteractionState(T.default)}),i.scrollbarComponent.hScrollBar.addEventListener("pointerupoutside",()=>{t.interactionState===T.scrolling&&t.updateInteractionState(T.default)}),i.scrollbarComponent.hScrollBar.addEventListener("scrollUp",r=>{i._gantt.eventManager.isDraging=!1});const n=nt(t.updateVerticalScrollBar,20),s=nt(t.updateHorizontalScrollBar,20);i.scrollbarComponent.vScrollBar.addEventListener("scrollDrag",r=>{i._gantt.eventManager.isDown&&(i._gantt.eventManager.isDraging=!0),t.interactionState!==T.scrolling&&t.updateInteractionState(T.scrolling);const l=r.detail.value[0]/(1-r.detail.value[1]+r.detail.value[0]);n(l,r)}),i.scrollbarComponent.hScrollBar.addEventListener("scrollDrag",r=>{i._gantt.eventManager.isDown&&(i._gantt.eventManager.isDraging=!0),t.fastScrolling=!0,t.interactionState!==T.scrolling&&t.updateInteractionState(T.scrolling);const l=r.detail.value[0]/(1-r.detail.value[1]+r.detail.value[0]);s(l)})}const ni=typeof window>"u"||window.window===void 0,Me=864e5;function G(a,e){const t=a-e.headerHeight,i=e.stateManager.scroll.verticalBarPos+t;return Math.floor(i/e.parsedOptions.rowHeight)}function si(a,e){const t=a+e.stateManager.scroll.horizontalBarPos;return Math.floor(t/e.parsedOptions.timelineColWidth)}function ri(a){var e,t,i,n,s;return a?a===!0?[{date:C().toLocaleDateString(),scrollToMarkLine:!0,position:"left",style:{lineColor:"red",lineWidth:1}}]:Array.isArray(a)?a.map((r,l)=>{var o,d,h,c;return{date:r.date,scrollToMarkLine:r.scrollToMarkLine,position:(o=r.position)!==null&&o!==void 0?o:"left",style:{lineColor:((d=r.style)===null||d===void 0?void 0:d.lineColor)||"red",lineWidth:((h=r.style)===null||h===void 0?void 0:h.lineWidth)||1,lineDash:(c=r.style)===null||c===void 0?void 0:c.lineDash}}}):[{date:a.date,scrollToMarkLine:(e=a.scrollToMarkLine)===null||e===void 0||e,position:(t=a.position)!==null&&t!==void 0?t:"left",style:{lineColor:((i=a.style)===null||i===void 0?void 0:i.lineColor)||"red",lineWidth:((n=a.style)===null||n===void 0?void 0:n.lineWidth)||1,lineDash:(s=a.style)===null||s===void 0?void 0:s.lineDash}}]:[]}function oi(a){var e;return a!=null&&a.hoverOn||a!=null&&a.horizontalVisible&&(a==null?void 0:a.horizontalVisible)==="none"||!(a!=null&&a.horizontalVisible)&&(a==null?void 0:a.visible)==="none"?0:(e=a==null?void 0:a.width)!==null&&e!==void 0?e:7}function li(a){var e;return a!=null&&a.hoverOn||a!=null&&a.verticalVisible&&(a==null?void 0:a.verticalVisible)==="none"||!(a!=null&&a.verticalVisible)&&(a==null?void 0:a.visible)==="none"?0:(e=a==null?void 0:a.width)!==null&&e!==void 0?e:7}function st(a){var e,t,i,n,s,r,l,o,d,h,c,u,g,p,m,v,f,y,k,D,_,L,S,x,W,M,I,F,A,P,E,N,j,Y,X,V,U,Z,$,K,ie,ae,ne,se,re,oe,le,de,he,ce,pe,ge,ue,ve,be,ye,me,fe,_e,ke,Se,Le,Be,xe,Te,B,ze,w,Ie,Ee,Ne,je,Ge,Xe,Ye,Ve,Ke,$e,qe,Ue,Ze;const b=a.options;a.parsedOptions.pixelRatio=(e=b==null?void 0:b.pixelRatio)!==null&&e!==void 0?e:1,a.parsedOptions.rowHeight=(t=b==null?void 0:b.rowHeight)!==null&&t!==void 0?t:40,a.parsedOptions.timelineColWidth=(n=(i=b==null?void 0:b.timelineHeader)===null||i===void 0?void 0:i.colWidth)!==null&&n!==void 0?n:60,a.parsedOptions.startDateField=(r=(s=b.taskBar)===null||s===void 0?void 0:s.startDateField)!==null&&r!==void 0?r:"startDate",a.parsedOptions.endDateField=(o=(l=b.taskBar)===null||l===void 0?void 0:l.endDateField)!==null&&o!==void 0?o:"endDate",a.parsedOptions.progressField=(h=(d=b.taskBar)===null||d===void 0?void 0:d.progressField)!==null&&h!==void 0?h:"progress",a.parsedOptions.minDate=b!=null&&b.minDate?C(b==null?void 0:b.minDate):void 0,a.parsedOptions.maxDate=b!=null&&b.maxDate?C(b==null?void 0:b.maxDate):void 0,a.parsedOptions._minDateTime=(c=a.parsedOptions.minDate)===null||c===void 0?void 0:c.getTime(),a.parsedOptions._maxDateTime=(u=a.parsedOptions.maxDate)===null||u===void 0?void 0:u.getTime(),a.parsedOptions.overscrollBehavior=(g=b==null?void 0:b.overscrollBehavior)!==null&&g!==void 0?g:"auto",a.parsedOptions.underlayBackgroundColor=(p=b==null?void 0:b.underlayBackgroundColor)!==null&&p!==void 0?p:"#FFF",a.parsedOptions.scrollStyle=Object.assign({},{scrollRailColor:"rgba(100, 100, 100, 0.2)",scrollSliderColor:"rgba(100, 100, 100, 0.5)",scrollSliderCornerRadius:4,width:10,visible:"always",hoverOn:!0,barToSide:!1},b==null?void 0:b.scrollStyle),a.parsedOptions.timelineHeaderHorizontalLineStyle=(m=b==null?void 0:b.timelineHeader)===null||m===void 0?void 0:m.horizontalLine,a.parsedOptions.timelineHeaderVerticalLineStyle=(v=b==null?void 0:b.timelineHeader)===null||v===void 0?void 0:v.verticalLine,a.parsedOptions.timelineHeaderBackgroundColor=(f=b==null?void 0:b.timelineHeader)===null||f===void 0?void 0:f.backgroundColor,a.parsedOptions.timeLineHeaderRowHeights=[],a.parsedOptions.timelineHeaderStyles=[];for(let q=0;(y=q<a.parsedOptions.sortedTimelineScales.length)!==null&&y!==void 0&&y;q++){const bt=a.parsedOptions.sortedTimelineScales[q].style;a.parsedOptions.timelineHeaderStyles.push(Object.assign({fontSize:20,fontWeight:"bold",textAlign:"center",textBaseline:"middle",color:"#000",backgroundColor:"#fff"},bt)),a.parsedOptions.timeLineHeaderRowHeights.push((D=(k=a.parsedOptions.sortedTimelineScales[q].rowHeight)!==null&&k!==void 0?k:b==null?void 0:b.headerRowHeight)!==null&&D!==void 0?D:40)}a.parsedOptions.grid=Object.assign({},b==null?void 0:b.grid),a.parsedOptions.taskBarStyle=Object.assign({},{barColor:"blue",completedBarColor:"gray",width:3*a.parsedOptions.rowHeight/4,cornerRadius:3,borderWidth:1,borderColor:"red",fontFamily:"Arial",fontSize:14},(_=b==null?void 0:b.taskBar)===null||_===void 0?void 0:_.barStyle),a.parsedOptions.dateFormat=b==null?void 0:b.dateFormat,a.parsedOptions.taskBarHoverStyle=Object.assign({barOverlayColor:"rgba(99, 144, 0, 0.4)"},(L=b==null?void 0:b.taskBar)===null||L===void 0?void 0:L.hoverBarStyle),a.parsedOptions.taskBarSelectable=(x=(S=b==null?void 0:b.taskBar)===null||S===void 0?void 0:S.selectable)===null||x===void 0||x,a.parsedOptions.taskBarSelectedStyle=Object.assign({shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:a.parsedOptions.taskBarStyle.barColor,borderColor:a.parsedOptions.taskBarStyle.barColor,borderLineWidth:1},(W=b==null?void 0:b.taskBar)===null||W===void 0?void 0:W.selectedBarStyle),a.parsedOptions.taskBarLabelText=(I=(M=b==null?void 0:b.taskBar)===null||M===void 0?void 0:M.labelText)!==null&&I!==void 0?I:"",a.parsedOptions.taskBarMoveable=(A=(F=b==null?void 0:b.taskBar)===null||F===void 0?void 0:F.moveable)===null||A===void 0||A,a.parsedOptions.taskBarResizable=(E=(P=b==null?void 0:b.taskBar)===null||P===void 0?void 0:P.resizable)===null||E===void 0||E,a.parsedOptions.taskBarLabelStyle={fontFamily:(Y=(j=(N=b==null?void 0:b.taskBar)===null||N===void 0?void 0:N.labelTextStyle)===null||j===void 0?void 0:j.fontFamily)!==null&&Y!==void 0?Y:"Arial",fontSize:(U=(V=(X=b==null?void 0:b.taskBar)===null||X===void 0?void 0:X.labelTextStyle)===null||V===void 0?void 0:V.fontSize)!==null&&U!==void 0?U:a.parsedOptions.rowHeight/2,color:(K=($=(Z=b==null?void 0:b.taskBar)===null||Z===void 0?void 0:Z.labelTextStyle)===null||$===void 0?void 0:$.color)!==null&&K!==void 0?K:"#F01",textAlign:(ne=(ae=(ie=b==null?void 0:b.taskBar)===null||ie===void 0?void 0:ie.labelTextStyle)===null||ae===void 0?void 0:ae.textAlign)!==null&&ne!==void 0?ne:"left",textBaseline:(oe=(re=(se=b==null?void 0:b.taskBar)===null||se===void 0?void 0:se.labelTextStyle)===null||re===void 0?void 0:re.textBaseline)!==null&&oe!==void 0?oe:"middle",padding:(he=(de=(le=b==null?void 0:b.taskBar)===null||le===void 0?void 0:le.labelTextStyle)===null||de===void 0?void 0:de.padding)!==null&&he!==void 0?he:[0,0,0,10],textOverflow:(pe=(ce=b==null?void 0:b.taskBar)===null||ce===void 0?void 0:ce.labelTextStyle)===null||pe===void 0?void 0:pe.textOverflow},a.parsedOptions.taskBarCustomLayout=(ge=b==null?void 0:b.taskBar)===null||ge===void 0?void 0:ge.customLayout,a.parsedOptions.taskBarCreatable=(ve=(ue=b==null?void 0:b.taskBar)===null||ue===void 0?void 0:ue.scheduleCreatable)===null||ve===void 0||ve,a.parsedOptions.taskBarCreationButtonStyle=Object.assign({lineColor:"rgb(99, 144, 0)",lineWidth:1,lineDash:[5,5],cornerRadius:4,backgroundColor:"#FFF"},(ye=(be=b==null?void 0:b.taskBar)===null||be===void 0?void 0:be.scheduleCreation)===null||ye===void 0?void 0:ye.buttonStyle),a.parsedOptions.taskBarCreationCustomLayout=(fe=(me=b==null?void 0:b.taskBar)===null||me===void 0?void 0:me.scheduleCreation)===null||fe===void 0?void 0:fe.customLayout,a.parsedOptions.outerFrameStyle=Object.assign({borderColor:"#e1e4e8",borderLineWidth:1,cornerRadius:4},(_e=b.frame)===null||_e===void 0?void 0:_e.outerFrameStyle),a.parsedOptions.markLine=ri(b==null?void 0:b.markLine),(Se=(ke=a.parsedOptions.markLine)===null||ke===void 0?void 0:ke.length)!==null&&Se!==void 0&&Se&&(!((Le=a.parsedOptions.markLine)===null||Le===void 0)&&Le.every(q=>q.scrollToMarkLine===void 0)&&(a.parsedOptions.markLine[0].scrollToMarkLine=!0),!((Be=a.parsedOptions.markLine)===null||Be===void 0)&&Be.find(q=>q.scrollToMarkLine)&&(a.parsedOptions.scrollToMarkLineDate=C((xe=a.parsedOptions.markLine)===null||xe===void 0?void 0:xe.find(q=>q.scrollToMarkLine).date))),a.parsedOptions.verticalSplitLineHighlight=(Te=b.frame)===null||Te===void 0?void 0:Te.verticalSplitLineHighlight,a.parsedOptions.verticalSplitLine=Object.assign({lineColor:(B=a.parsedOptions.outerFrameStyle)===null||B===void 0?void 0:B.borderColor,lineWidth:(ze=a.parsedOptions.outerFrameStyle)===null||ze===void 0?void 0:ze.borderLineWidth},(w=b.frame)===null||w===void 0?void 0:w.verticalSplitLine),a.parsedOptions.horizontalSplitLine=(Ie=b.frame)===null||Ie===void 0?void 0:Ie.horizontalSplitLine,a.parsedOptions.verticalSplitLineMoveable=(Ee=b.frame)===null||Ee===void 0?void 0:Ee.verticalSplitLineMoveable,a.parsedOptions.taskKeyField=(Ne=b.taskKeyField)!==null&&Ne!==void 0?Ne:"id",a.parsedOptions.dependencyLinks=(je=b.dependency)===null||je===void 0?void 0:je.links,a.parsedOptions.dependencyLinkCreatable=(Xe=(Ge=b.dependency)===null||Ge===void 0?void 0:Ge.linkCreatable)!==null&&Xe!==void 0&&Xe,a.parsedOptions.dependencyLinkSelectable=(Ve=(Ye=b.dependency)===null||Ye===void 0?void 0:Ye.linkSelectable)===null||Ve===void 0||Ve,a.parsedOptions.dependencyLinkLineStyle=Object.assign({lineColor:"red",lineWidth:1},(Ke=b.dependency)===null||Ke===void 0?void 0:Ke.linkLineStyle),a.parsedOptions.dependencyLinkSelectedLineStyle=Object.assign({shadowBlur:4,shadowOffset:0,shadowColor:a.parsedOptions.dependencyLinkLineStyle.lineColor,lineColor:a.parsedOptions.dependencyLinkLineStyle.lineColor,lineWidth:a.parsedOptions.dependencyLinkLineStyle.lineWidth},($e=b==null?void 0:b.dependency)===null||$e===void 0?void 0:$e.linkSelectedLineStyle),a.parsedOptions.dependencyLinkLineCreatePointStyle=Object.assign({strokeColor:"red",fillColor:"white",radius:5,strokeWidth:1},(qe=b==null?void 0:b.dependency)===null||qe===void 0?void 0:qe.linkCreatePointStyle),a.parsedOptions.dependencyLinkLineCreatingPointStyle=Object.assign({strokeColor:"red",fillColor:"red",radius:5,strokeWidth:1},(Ue=b==null?void 0:b.dependency)===null||Ue===void 0?void 0:Ue.linkCreatingPointStyle),a.parsedOptions.dependencyLinkLineCreatingStyle=Object.assign({lineColor:"red",lineWidth:1,lineDash:[5,5]},(Ze=b==null?void 0:b.dependency)===null||Ze===void 0?void 0:Ze.linkCreatingLineStyle)}function di(a,e,t){var i;const{unit:n,step:s,format:r}=t,l=[];for(;a<=e;)if(n==="day"){const o=C(a.getTime()+24*s*60*60*1e3),d=C(a),h={days:s,startDate:d,endDate:o,title:(r==null?void 0:r({dateIndex:a.getDate(),startDate:d,endDate:o}))||a.getDate().toString(),dateIndex:a.getDate()};l.push(h),a.setDate(a.getDate()+s)}else if(n==="month"){const o=a.getFullYear(),d=a.getMonth()+1,h=new Date(o,d+s-1,0);h.getTime()>e.getTime()&&h.setDate(e.getDate());const c=a,u=(r==null?void 0:r({dateIndex:d,startDate:c,endDate:h}))||d.toString(),g={days:Math.ceil(Math.abs(h.getTime()-a.getTime())/864e5)+1,startDate:c,endDate:h,title:u,dateIndex:d};l.push(g),a=new Date(o,a.getMonth()+s,1)}else if(n==="quarter"){const o=a.getFullYear(),d=Math.floor(a.getMonth()/3+1),h=new Date(o,3*(d+s-1),0);h.getTime()>e.getTime()&&h.setDate(e.getDate());const c=a,u=(r==null?void 0:r({dateIndex:d,startDate:c,endDate:h}))||d.toString(),g={days:Math.ceil(Math.abs(h.getTime()-a.getTime())/864e5)+1,startDate:c,endDate:h,title:u,dateIndex:d};l.push(g),a=new Date(o,3*(d+s-1),1)}else if(n==="year"){const o=a.getFullYear(),d=new Date(o,11,31);d.getTime()>e.getTime()&&d.setDate(e.getDate());const h=a,c=(r==null?void 0:r({dateIndex:o,startDate:h,endDate:d}))||o.toString(),u={days:Math.ceil(Math.abs(d.getTime()-a.getTime())/864e5)+1,startDate:h,endDate:d,title:c,dateIndex:o};l.push(u),a=new Date(o+s,0,1)}else if(n==="week"){const o=(i=t.startOfWeek)!==null&&i!==void 0?i:"monday";let d=a.getDay();o==="monday"&&(d=d===0?6:d-1);const h=C(a),c=C(h.getTime()+24*(6-d)*60*60*1e3);c>e&&c.setDate(e.getDate());const u=Vt(h),g=(r==null?void 0:r({dateIndex:u,startDate:h,endDate:c}))||u.toString(),p={days:Math.ceil((c.getTime()-h.getTime())/864e5)+1,startDate:h,endDate:c,title:g,dateIndex:u};l.push(p),a.setDate(a.getDate()+(7-d))}return l}function pt(a,e,t,i,n){var s,r,l,o,d,h,c,u,g;let p=(s=a[3])!==null&&s!==void 0?s:10;e==="right"||e==="end"?p=i-0-((r=a[1])!==null&&r!==void 0?r:10):e==="center"&&(p=0+(i-0+((l=a[3])!==null&&l!==void 0?l:10)-((o=a[1])!==null&&o!==void 0?o:10))/2);let m=0+((d=a[0])!==null&&d!==void 0?d:10);return t==="bottom"||t==="alphabetic"||t==="ideographic"?m=n-0-((h=a[2])!==null&&h!==void 0?h:10):t==="middle"&&(m=0+(n-0-((c=a[0])!==null&&c!==void 0?c:10)-((u=a[2])!==null&&u!==void 0?u:10))/2+((g=a[0])!==null&&g!==void 0?g:10)),{x:p,y:m}}function hi(a){return typeof a=="string"&&(a=a.replace("%",""),a=parseFloat(a)),a<=1&&(a*=100),Math.round(a)}function ci(a){var e,t;if(a.taskListTableInstance){a.verticalSplitResizeLine=document.createElement("div"),a.verticalSplitResizeLine.style.position="absolute",a.verticalSplitResizeLine.style.top=a.tableY+"px",a.verticalSplitResizeLine.style.left=(a.taskTableWidth?a.taskTableWidth-7+a.parsedOptions.verticalSplitLine.lineWidth/2:0)+"px",a.verticalSplitResizeLine.style.width="14px",a.verticalSplitResizeLine.style.height=a.drawHeight+"px",a.verticalSplitResizeLine.style.backgroundColor="rgba(0,0,0,0)",a.verticalSplitResizeLine.style.zIndex="100",a.parsedOptions.verticalSplitLineMoveable&&(a.verticalSplitResizeLine.style.cursor="col-resize"),a.verticalSplitResizeLine.style.userSelect="none",a.verticalSplitResizeLine.style.opacity="1";const i=document.createElement("div");if(i.style.position="absolute",i.style.top="0px",i.style.left=(14-a.parsedOptions.verticalSplitLine.lineWidth)/2+"px",i.style.width=a.parsedOptions.verticalSplitLine.lineWidth+"px",i.style.height="100%",i.style.backgroundColor=a.parsedOptions.verticalSplitLine.lineColor,i.style.zIndex="100",i.style.userSelect="none",i.style.pointerEvents="none",i.style.transition="background-color 0.3s",a.verticalSplitResizeLine.appendChild(i),a.parsedOptions.verticalSplitLineHighlight){const n=document.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left=((e=14-a.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&e!==void 0?e:2)/2+"px",n.style.width=((t=a.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&t!==void 0?t:2)+"px",n.style.height="100%",n.style.backgroundColor=a.parsedOptions.verticalSplitLineHighlight.lineColor,n.style.zIndex="100",n.style.cursor="col-resize",n.style.userSelect="none",n.style.pointerEvents="none",n.style.opacity="0",n.style.transition="background-color 0.3s",a.verticalSplitResizeLine.appendChild(n)}a.container.appendChild(a.verticalSplitResizeLine)}}function rt(a){var e,t;if(a.verticalSplitResizeLine){a.verticalSplitResizeLine.style.position="absolute",a.verticalSplitResizeLine.style.top=a.tableY+"px",a.verticalSplitResizeLine.style.left=a.taskTableWidth?a.taskTableWidth-7+a.parsedOptions.verticalSplitLine.lineWidth/2+"px":"0px",a.verticalSplitResizeLine.style.width="14px",a.verticalSplitResizeLine.style.height=a.drawHeight+"px",a.verticalSplitResizeLine.style.backgroundColor="rgba(0,0,0,0)",a.verticalSplitResizeLine.style.zIndex="100",a.parsedOptions.verticalSplitLineMoveable&&(a.verticalSplitResizeLine.style.cursor="col-resize"),a.verticalSplitResizeLine.style.userSelect="none",a.verticalSplitResizeLine.style.opacity="1";const i=a.verticalSplitResizeLine.childNodes[0];if(i.style.position="absolute",i.style.top="0px",i.style.left=(14-a.parsedOptions.verticalSplitLine.lineWidth)/2+"px",i.style.width=a.parsedOptions.verticalSplitLine.lineWidth+"px",i.style.height="100%",i.style.backgroundColor=a.parsedOptions.verticalSplitLine.lineColor,i.style.zIndex="100",i.style.userSelect="none",i.style.pointerEvents="none",i.style.transition="background-color 0.3s",a.verticalSplitResizeLine.childNodes[1]){const n=a.verticalSplitResizeLine.childNodes[1];n.style.position="absolute",n.style.top="0px",n.style.left=((e=14-a.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&e!==void 0?e:2)/2+"px",n.style.width=((t=a.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&t!==void 0?t:2)+"px",n.style.height="100%",n.style.backgroundColor=a.parsedOptions.verticalSplitLineHighlight.lineColor,n.style.zIndex="100",n.style.cursor="col-resize",n.style.userSelect="none",n.style.pointerEvents="none",n.style.opacity="0",n.style.transition="background-color 0.3s"}}}function te(a,e,t){var i;for(let n=0;n<a.length;n++){if(Array.isArray(t)&&t.length===1&&a[n][e]===t[0]||a[n][e]===t)return{record:a[n],index:[n]};if(!((i=a[n].children)===null||i===void 0)&&i.length){if(Array.isArray(t)&&t[0]===a[n][e]){const s=te(a[n].children,e,t.slice(1));if(s)return s.index.unshift(n),s}else if(!Array.isArray(t)){const s=te(a[n].children,e,t);if(s)return s.index.unshift(n),s}}}}class pi{constructor(e){this._scene=e,this.initNodes()}initNodes(){var e,t,i,n,s,r,l,o,d;const{_scene:h}=this,c=new O({x:0,y:0,width:h._gantt._getAllColsWidth(),height:h._gantt.getAllHeaderRowsHeight(),clip:!0,pickable:!1});this.group=c,c.name="date-header-container",h.tableGroup.addChild(this.group);let u=0;for(let g=0;g<h._gantt.timeLineHeaderLevel;g++){const p=new O({x:0,y:u,width:h._gantt._getAllColsWidth(),height:h._gantt.parsedOptions.timeLineHeaderRowHeights[g],clip:!1});u+=p.attribute.height,p.name="row-header",c.addChild(p);const{unit:m,timelineDates:v,customLayout:f}=h._gantt.parsedOptions.sortedTimelineScales[g];let y=0;for(let k=0;k<v.length;k++){const{days:D,endDate:_,startDate:L,title:S,dateIndex:x}=v[k],W=new O({x:y,y:0,width:h._gantt.parsedOptions.colWidthPerDay*D,height:p.attribute.height,clip:!1,fill:h._gantt.parsedOptions.timelineHeaderBackgroundColor});let M;W.name="date-header-cell";let I=!0;const F=h._gantt.parsedOptions.colWidthPerDay*v[k].days,A=p.attribute.height;if(f){let P;typeof f=="function"?P=f({width:F,height:A,index:k,startDate:L,endDate:_,days:D,dateIndex:x,title:S,ganttInstance:this._scene._gantt}):P=f,P&&(M=P.rootContainer,I=(e=P.renderDefaultText)!==null&&e!==void 0&&e,M.name="task-bar-custom-render"),M&&W.appendChild(M)}if(I){const{padding:P,textAlign:E,textBaseline:N,textOverflow:j,fontSize:Y,fontWeight:X,color:V,strokeColor:U,textStick:Z}=h._gantt.parsedOptions.timelineHeaderStyles[g],$=pt(ct(P),E,N,F,A),K=new ee({x:$.x,y:$.y,maxLineWidth:F,heightLimit:A,pickable:!0,text:S.toLocaleString(),fontSize:Y,fontWeight:X,fill:V,stroke:U,lineWidth:2,textAlign:E,textBaseline:N,ellipsis:j==="clip"?"":j==="ellipsis"?"...":J(j)?j:void 0});K.attribute.textStick=Z,W.appendChild(K),K.name="date-header-cell-text"}if(p.addChild(W),k>0){const P=Q({pickable:!1,stroke:(t=h._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||t===void 0?void 0:t.lineColor,lineWidth:(i=h._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||i===void 0?void 0:i.lineWidth,points:[{x:1&((n=h._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||n===void 0?void 0:n.lineWidth)?.5:0,y:0},{x:1&((s=h._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||s===void 0?void 0:s.lineWidth)?.5:0,y:p.attribute.height}]});W.appendChild(P)}y+=F}if(g>0){const k=Q({pickable:!1,stroke:(r=h._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||r===void 0?void 0:r.lineColor,lineWidth:(l=h._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||l===void 0?void 0:l.lineWidth,points:[{x:0,y:1&((o=h._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||o===void 0?void 0:o.lineWidth)?.5:0},{x:h._gantt._getAllColsWidth(),y:1&((d=h._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||d===void 0?void 0:d.lineWidth)?.5:0}]});p.addChild(k)}}}setX(e){this.group.setAttribute("x",e)}setY(e){this.group.setAttribute("y",e)}resize(){var e,t,i,n;this.group.setAttribute("width",(t=(e=this.group.attribute)===null||e===void 0?void 0:e.width)!==null&&t!==void 0?t:0),this.group.setAttribute("height",(n=(i=this.group.attribute)===null||i===void 0?void 0:i.height)!==null&&n!==void 0?n:0)}refresh(){var e;(e=this.group)===null||e===void 0||e.parent.removeChild(this.group),this.initNodes()}}class gi extends O{constructor(e){super(e)}}const ot=`<svg width="100" height="200" xmlns="http://www.w3.org/2000/svg">
  <line x1="30" y1="10" x2="30" y2="190" stroke="black" stroke-width="4"/>
  <line x1="70" y1="10" x2="70" y2="190" stroke="black" stroke-width="4"/>
</svg>`,ui=10;class vi{constructor(e){this.selectedBorders=[],this._scene=e,this.width=e._gantt.tableNoFrameWidth,this.height=e._gantt.gridHeight,this.group=new O({x:0,y:e._gantt.getAllHeaderRowsHeight(),width:this.width,height:this.height,pickable:!1,clip:!0}),this.group.name="task-bar-container",e.tableGroup.addChild(this.group),this.initBars(),this.initHoverBarIcons()}initBars(){this.barContainer=new O({x:0,y:0,width:this._scene._gantt._getAllColsWidth(),height:this._scene._gantt.getAllTaskBarsHeight(),pickable:!1,clip:!0}),this.group.appendChild(this.barContainer);for(let e=0;e<this._scene._gantt.itemCount;e++){const t=this.initBar(e);t&&this.barContainer.appendChild(t)}}initBar(e){var t,i;const n=this._scene._gantt.parsedOptions.taskBarCustomLayout,{startDate:s,endDate:r,taskDays:l,progress:o,taskRecord:d}=this._scene._gantt.getTaskInfoByTaskListIndex(e);if(l<=0||!s||!r)return null;const h=this._scene._gantt.parsedOptions.colWidthPerDay*l,c=this._scene._gantt.parsedOptions.taskBarStyle.width,u=C(this._scene._gantt.parsedOptions.minDate),g=new gi({x:this._scene._gantt.parsedOptions.colWidthPerDay*Math.ceil(Math.abs(s.getTime()-u.getTime())/864e5),y:this._scene._gantt.parsedOptions.rowHeight*e+(this._scene._gantt.parsedOptions.rowHeight-c)/2,width:h,height:c,cornerRadius:this._scene._gantt.parsedOptions.taskBarStyle.cornerRadius,clip:!0});let p;g.name="task-bar",g.id=e;let m=!0,v=!0;if(n){let f;typeof n=="function"?f=n({width:h,height:c,index:e,startDate:s,endDate:r,taskDays:l,progress:o,taskRecord:d,ganttInstance:this._scene._gantt}):f=n,f&&(p=f.rootContainer,m=(t=f.renderDefaultBar)!==null&&t!==void 0&&t,v=(i=f.renderDefaultText)!==null&&i!==void 0&&i,p.name="task-bar-custom-render")}if(m){const f=et({x:0,y:0,width:h,height:c,fill:this._scene._gantt.parsedOptions.taskBarStyle.barColor,pickable:!1});f.name="task-bar-rect",g.appendChild(f),g.barRect=f;const y=et({x:0,y:0,width:h*o/100,height:c,fill:this._scene._gantt.parsedOptions.taskBarStyle.completedBarColor,pickable:!1});y.name="task-bar-progress-rect",g.appendChild(y),g.progressRect=y}if(p&&g.appendChild(p),v){const{textAlign:f,textBaseline:y,fontSize:k,fontFamily:D,textOverflow:_,color:L,padding:S}=this._scene._gantt.parsedOptions.taskBarLabelStyle,x=pt(ct(S),f,y,h,c),W=mt({x:x.x,y:x.y,fontSize:k,fill:L,fontFamily:D,text:Yt(this._scene._gantt.parsedOptions.taskBarLabelText,d),maxLineWidth:h-10,textBaseline:y,textAlign:f,ellipsis:_==="clip"?"":_==="ellipsis"?"...":J(_)?_:void 0,poptip:{position:"bottom",dx:(h-10)/4}});g.appendChild(W),g.textLabel=W}return g}updateTaskBarNode(e){const t=this.getTaskBarNodeByIndex(e);t&&this.barContainer.removeChild(t);const i=this.initBar(e);i&&this.barContainer.insertInto(i,e)}initHoverBarIcons(){var e,t;const i=new O({x:0,y:0,width:100,height:100,clip:!0,cursor:this._scene._gantt.parsedOptions.taskBarMoveable?"grab":"default",pickable:!1,cornerRadius:(t=(e=this._scene._gantt.parsedOptions.taskBarHoverStyle.cornerRadius)!==null&&e!==void 0?e:this._scene._gantt.parsedOptions.taskBarStyle.cornerRadius)!==null&&t!==void 0?t:0,fill:this._scene._gantt.parsedOptions.taskBarHoverStyle.barOverlayColor,visibleAll:!1});if(this.hoverBarGroup=i,i.name="task-bar-hover-shadow",this._scene._gantt.parsedOptions.taskBarResizable){const n=new He({x:0,y:0,width:10,height:20,image:ot,pickable:!0,cursor:"col-resize"});n.name="task-bar-hover-shadow-left-icon",this.hoverBarLeftIcon=n,i.appendChild(n);const s=new He({x:0,y:0,width:10,height:20,image:ot,pickable:!0,cursor:"col-resize"});s.name="task-bar-hover-shadow-right-icon",this.hoverBarRightIcon=s,i.appendChild(s)}}setX(e){this.barContainer.setAttribute("x",e)}setY(e){this.barContainer.setAttribute("y",e)}refresh(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttributes({height:this.height,width:this.width,y:this._scene._gantt.getAllHeaderRowsHeight()}),this.barContainer.removeAllChild(),this.group.removeChild(this.barContainer),this.initBars()}resize(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}showHoverBar(e,t,i,n,s){s&&s.name==="task-bar"&&s.appendChild(this.hoverBarGroup),this.hoverBarGroup.setAttribute("x",0),this.hoverBarGroup.setAttribute("y",0),this.hoverBarGroup.setAttribute("width",i),this.hoverBarGroup.setAttribute("height",n),this.hoverBarGroup.setAttribute("visibleAll",!0),this.hoverBarLeftIcon&&(this.hoverBarLeftIcon.setAttribute("x",0),this.hoverBarLeftIcon.setAttribute("y",Math.ceil(n/10)),this.hoverBarLeftIcon.setAttribute("width",10),this.hoverBarLeftIcon.setAttribute("height",n-2*Math.ceil(n/10)),this.hoverBarRightIcon.setAttribute("x",i-10),this.hoverBarRightIcon.setAttribute("y",Math.ceil(n/10)),this.hoverBarRightIcon.setAttribute("width",10),this.hoverBarRightIcon.setAttribute("height",n-2*Math.ceil(n/10)))}hideHoverBar(){this.hoverBarGroup.setAttribute("visibleAll",!1)}createSelectedBorder(e,t,i,n,s,r=!1){var l;const o=new O({x:e,y:t,width:i,height:n,lineWidth:this._scene._gantt.parsedOptions.taskBarSelectedStyle.borderLineWidth,pickable:!1,cornerRadius:(l=this._scene._gantt.parsedOptions.taskBarStyle.cornerRadius)!==null&&l!==void 0?l:0,fill:!1,stroke:this._scene._gantt.parsedOptions.taskBarSelectedStyle.borderColor,shadowColor:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowColor,shadowOffsetX:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowOffsetX,shadowOffsetY:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowOffsetY,shadowBlur:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowBlur,attachedToTaskBarNode:s});if(o.name="task-bar-select-border",this.barContainer.appendChild(o),this.selectedBorders.push(o),r){const d=new O({x:-10,y:0,width:10,height:n,pickable:!0}),h=new it({x:5,y:n/2,radius:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius,fill:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor,stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth,pickable:!1});d.appendChild(h),d.name="task-bar-link-point-left",o.appendChild(d);const c=new O({x:i,y:0,width:10,height:n,pickable:!0}),u=new it({x:5,y:n/2,radius:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius,fill:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor,stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth,pickable:!1,pickStrokeBuffer:10});c.appendChild(u),c.name="task-bar-link-point-right",o.appendChild(c)}}removeSelectedBorder(){this.selectedBorders.forEach(e=>{e.delete()}),this.selectedBorders=[]}removeSecondSelectedBorder(){this.selectedBorders.length===2&&this.selectedBorders.pop().delete()}updateCreatingDependencyLine(e,t,i,n){this.creatingDependencyLine&&(this.creatingDependencyLine.delete(),this.creatingDependencyLine=void 0);const s=new ft({points:[{x:e,y:t},{x:i,y:n}],stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineWidth,lineDash:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineDash,pickable:!1});this.creatingDependencyLine=s,this.selectedBorders[0].appendChild(s)}getTaskBarNodeByIndex(e){let t=this.barContainer.firstChild;if(!t)return null;for(let i=0;i<this.barContainer.childrenCount;i++){if(t.id===e)return t;t=t._next}return null}}class bi{constructor(e){this.markLineContainerWidth=20,this._scene=e,this.markLine=e._gantt.parsedOptions.markLine,this.height=Math.min(e._gantt.tableNoFrameHeight,e._gantt.drawHeight)-e._gantt.getAllHeaderRowsHeight(),this.group=new O({x:0,y:e._gantt.getAllHeaderRowsHeight(),width:e._gantt.tableNoFrameWidth,height:this.height,pickable:!1,clip:!0}),this.group.name="mark-line-container",e.tableGroup.addChild(this.group),this.markLIneContainer=new O({x:0,y:0,width:this._scene._gantt._getAllColsWidth(),height:this.height,pickable:!1,clip:!0}),this.group.appendChild(this.markLIneContainer),this.initMarkLines()}initMarkLines(){this.markLine.forEach(e=>{const t=e.style,i=C(e.date),n=C(this._scene._gantt.parsedOptions.minDate),s=this._scene._gantt.parsedOptions.colWidthPerDay*(Math.ceil((i.getTime()-n.getTime())/864e5)+(e.position==="right"?1:e.position==="middle"?.5:0)),r=new O({pickable:!1,x:s-this.markLineContainerWidth/2,y:0,width:this.markLineContainerWidth,height:this.height});r.name="mark-line",this.markLIneContainer.appendChild(r);const l=Q({pickable:!1,stroke:t.lineColor,lineWidth:t.lineWidth,lineDash:t.lineDash,points:[{x:this.markLineContainerWidth/2,y:0},{x:this.markLineContainerWidth/2,y:this.height}]});r.appendChild(l)})}refresh(){this.height=Math.min(this._scene._gantt.tableNoFrameHeight,this._scene._gantt.drawHeight)-this._scene._gantt.getAllHeaderRowsHeight(),this.markLIneContainer.removeAllChild(),this.group.setAttribute("height",this.height),this.markLIneContainer.setAttribute("height",this.height),this.initMarkLines()}setX(e){this.markLIneContainer.setAttribute("x",e)}}class yi{constructor(e){this._scene=e,this.createFrameBorder()}createFrameBorder(){var e,t,i,n,s,r;const l=this._scene.tableGroup,o=this._scene._gantt.parsedOptions.outerFrameStyle;if(!o)return;const{cornerRadius:d,borderColor:h,borderLineWidth:c,borderLineDash:u}=o,g={},p={pickable:!1};if(c&&(p.stroke=!0,p.fill=!1,p.stroke=h,p.lineWidth=c,u&&(p.lineDash=u),p.lineCap="butt"),d&&(this._scene._gantt.taskListTableInstance?(p.cornerRadius=[0,(e=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&e!==void 0?e:0,(t=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&t!==void 0?t:0,0],g.cornerRadius=[0,(i=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&i!==void 0?i:0,(n=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&n!==void 0?n:0,0]):(p.cornerRadius=(s=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&s!==void 0?s:0,g.cornerRadius=(r=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&r!==void 0?r:0)),l.setAttributes(g),p.stroke){p.x=this._scene._gantt.taskListTableInstance?-c/2:c/2,p.y=c/2,p.pickable=!1,p.width=l.attribute.width+c+(this._scene._gantt.taskListTableInstance?this._scene._gantt.parsedOptions.verticalSplitLine.lineWidth:0),p.height=l.attribute.height+c/2+c/2;const m=et(p);m.name="border-rect",l.parent.insertAfter(m,l),l.border=m,this.border=m}}resize(){const{cornerRadius:e,borderColor:t,borderLineWidth:i,borderLineDash:n}=this._scene._gantt.parsedOptions.outerFrameStyle;this.border.setAttributes({width:this._scene.tableGroup.attribute.width+i+(this._scene._gantt.taskListTableInstance?this._scene._gantt.parsedOptions.verticalSplitLine.lineWidth:0),height:this._scene._gantt.drawHeight+i})}}var mi=function(a,e,t,i){var n,s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(a,e,t,i);else for(var l=a.length-1;l>=0;l--)(n=a[l])&&(r=(s<3?n(r):s>3?n(e,t,r):n(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r};let Re=class{constructor(){this.time=kt.beforeFillStroke,this.useStyle=!0,this.order=0,this.supportedAppName="vtable"}drawShape(a,e,t,i,n,s,r,l,o,d,h,c,u){a.name==="date-header-cell"&&a.forEachChildren(g=>{var p;if(g.name==="date-header-cell-text"&&g.attribute.textStick===!0){const m=g;m.setAttribute("dx",0);const v=m.globalAABBBounds,f=m.stage.globalAABBBounds,y=m.parent.globalAABBBounds,k=f.intersect(y);f.intersect(y)&&(v.width()>=k.width()&&m.attribute.last_dx?m.setAttribute("dx",(p=m.attribute.last_dx)!==null&&p!==void 0?p:0):f.x1>=v.x1?(m.setAttribute("dx",f.x1-v.x1),m.setAttribute("last_dx",f.x1-v.x1)):f.x2<=v.x2&&(m.setAttribute("dx",f.x2-v.x2),m.setAttribute("last_dx",f.x1-v.x1)))}})}};Re=mi([_t()],Re);const fi=new St((a,e,t,i)=>{a(Re).toSelf().inSingletonScope(),a(Lt).toService(Re)});class _i{constructor(e){this._scene=e,this.createAddButton()}createAddButton(){var e;this._scene._gantt.parsedOptions.taskBarCreationCustomLayout?this.group=new O({x:0,y:0,width:100,height:100}):(this.group=new O({x:0,y:0,width:100,height:100,lineDash:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineDash,cursor:"pointer",lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,cornerRadius:(e=this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.cornerRadius)!==null&&e!==void 0?e:0,fill:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.backgroundColor}),this.lineVertical=Q({pickable:!1,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,points:[{x:50,y:0},{x:50,y:100}]}),this.group.appendChild(this.lineVertical),this.lineHorizontal=Q({pickable:!1,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,points:[{x:0,y:50},{x:100,y:50}]}),this.group.appendChild(this.lineHorizontal)),this.group.name="task-creation-button",this._scene.taskBar.group.addChild(this.group)}show(e,t,i,n){if(this._scene._gantt.parsedOptions.taskBarCreationCustomLayout)this.group.appendChild(this._scene._gantt.parsedOptions.taskBarCreationCustomLayout({width:i,height:n,ganttInstance:this._scene._gantt}).rootContainer);else{const s=Math.min(i,n)/6;this.lineHorizontal.setAttribute("points",[{x:(i-4*s)/2,y:n/2},{x:(i-4*s)/2+4*s,y:n/2}]),this.lineVertical.setAttribute("points",[{x:i/2,y:(n-4*s)/2},{x:i/2,y:(n-4*s)/2+4*s}])}this.group.setAttribute("x",e),this.group.setAttribute("y",t),this.group.setAttribute("width",i),this.group.setAttribute("height",n),this.group.setAttribute("visibleAll",!0)}hide(){this.group.setAttribute("visibleAll",!1),this._scene._gantt.parsedOptions.taskBarCreationCustomLayout&&this.group.removeAllChild()}}class ki{constructor(e){this._scene=e,this.width=e._gantt.tableNoFrameWidth,this.height=e._gantt.gridHeight,this.group=new O({x:0,y:e._gantt.getAllHeaderRowsHeight(),width:this.width,height:this.height,pickable:!1,clip:!0}),this.group.name="dependency-link-container",e.tableGroup.addChild(this.group),this.initLinkLines()}initLinkLines(){var e,t;this.linkLinesContainer=new O({x:0,y:0,width:this._scene._gantt._getAllColsWidth(),height:this._scene._gantt.getAllTaskBarsHeight(),pickable:!1,clip:!0}),this.group.appendChild(this.linkLinesContainer);for(let i=0;(t=i<((e=this._scene._gantt.parsedOptions.dependencyLinks)===null||e===void 0?void 0:e.length))!==null&&t!==void 0&&t;i++)this.initLinkLine(i)}initLinkLine(e){const{taskKeyField:t,dependencyLinks:i}=this._scene._gantt.parsedOptions,n=i[e],{linkedToTaskKey:s,linkedFromTaskKey:r,type:l}=n,o=te(this._scene._gantt.records,t,s);o.record.vtable_gantt_linkedTo||(o.record.vtable_gantt_linkedTo=[]),o.record.vtable_gantt_linkedTo.push(n);const d=te(this._scene._gantt.records,t,r);d.record.vtable_gantt_linkedFrom||(d.record.vtable_gantt_linkedFrom=[]),d.record.vtable_gantt_linkedFrom.push(n);const h=this._scene._gantt.getTaskShowIndexByRecordIndex(d.index),c=this._scene._gantt.getTaskShowIndexByRecordIndex(o.index),{startDate:u,endDate:g,taskDays:p}=this._scene._gantt.getTaskInfoByTaskListIndex(c),{startDate:m,endDate:v,taskDays:f}=this._scene._gantt.getTaskInfoByTaskListIndex(h);if(!f||!p)return;const y=C(this._scene._gantt.parsedOptions.minDate),{arrowPoints:k,linePoints:D}=Si(l,m,v,h,u,g,c,y,this._scene._gantt.parsedOptions.rowHeight,this._scene._gantt.parsedOptions.colWidthPerDay),_=this._scene._gantt.parsedOptions.dependencyLinkLineStyle,L=Q({pickable:!0,stroke:_.lineColor,lineWidth:_.lineWidth,lineDash:_.lineDash,points:D,pickStrokeBuffer:3,vtable_link:n});this.linkLinesContainer.appendChild(L),n.vtable_gantt_linkLineNode=L;const S=new Bt({fill:_.lineColor,points:k});this.linkLinesContainer.appendChild(S),n.vtable_gantt_linkArrowNode=S}setX(e){this.linkLinesContainer.setAttribute("x",e)}setY(e){this.linkLinesContainer.setAttribute("y",e)}refresh(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttributes({height:this.height,width:this.width,y:this._scene._gantt.getAllHeaderRowsHeight()}),this.linkLinesContainer.removeAllChild(),this.group.removeChild(this.linkLinesContainer),this.initLinkLines()}resize(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}createSelectedLinkLine(e){const t=e.vtable_gantt_linkLineNode,i=e.vtable_gantt_linkArrowNode,n=t.clone(),s=i.clone();n.setAttribute("stroke",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineColor),n.setAttribute("lineWidth",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineWidth),n.setAttribute("shadowColor",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowColor),n.setAttribute("shadowOffsetX",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowOffset),n.setAttribute("shadowOffsetY",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowOffset),n.setAttribute("shadowBlur",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowBlur),this.linkLinesContainer.appendChild(n),s.setAttribute("fill",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineColor),this.linkLinesContainer.appendChild(s),this.selectedEffectNodes=[n,s]}removeSelectedLinkLine(){var e;(e=this.selectedEffectNodes)===null||e===void 0||e.forEach(t=>{t.delete()}),this.selectedEffectNodes=[]}deleteLink(e){const t=e.vtable_gantt_linkLineNode,i=e.vtable_gantt_linkArrowNode;t.delete(),i.delete()}}function Si(a,e,t,i,n,s,r,l,o,d){let h,c,u=[],g=[];if(a===R.FinishToStart){h=t,c=n;const p=d*(Math.ceil(Math.abs(h.getTime()-l.getTime())/864e5)+1),m=d*Math.ceil(Math.abs(c.getTime()-l.getTime())/864e5);u=[{x:p,y:o*(i+.5)},{x:p+20,y:o*(i+.5)},{x:p+20,y:o*(i+(i>r?0:1))},{x:m-20,y:o*(i+(i>r?0:1))},{x:m-20,y:o*(r+.5)},{x:m,y:o*(r+.5)}],p+20<=m-20&&u.splice(2,3,{x:p+20,y:o*(r+.5)});const v=u[u.length-1];g=[{x:v.x,y:v.y},{x:v.x-10,y:v.y-5},{x:v.x-10,y:v.y+5},{x:v.x,y:v.y}]}else if(a===R.StartToFinish){h=e,c=s;const p=d*Math.ceil(Math.abs(h.getTime()-l.getTime())/864e5),m=d*(Math.ceil(Math.abs(c.getTime()-l.getTime())/864e5)+1);u=[{x:p,y:o*(i+.5)},{x:p-20,y:o*(i+.5)},{x:p-20,y:o*(i+(i>r?0:1))},{x:m+20,y:o*(i+(i>r?0:1))},{x:m+20,y:o*(r+.5)},{x:m,y:o*(r+.5)}],p-20>=m+20&&u.splice(2,3,{x:p-20,y:o*(r+.5)});const v=u[u.length-1];g=[{x:v.x,y:v.y},{x:v.x+10,y:v.y-5},{x:v.x+10,y:v.y+5},{x:v.x,y:v.y}]}else if(a===R.StartToStart){h=e,c=n;const p=d*Math.ceil(Math.abs(h.getTime()-l.getTime())/864e5),m=d*Math.ceil(Math.abs(c.getTime()-l.getTime())/864e5);u=[{x:p,y:o*(i+.5)},{x:Math.min(p,m)-20,y:o*(i+.5)},{x:Math.min(p,m)-20,y:o*(r+.5)},{x:m,y:o*(r+.5)}];const v=u[u.length-1];g=[{x:v.x,y:v.y},{x:v.x-10,y:v.y-5},{x:v.x-10,y:v.y+5},{x:v.x,y:v.y}]}else if(a===R.FinishToFinish){h=t,c=s;const p=d*(Math.ceil(Math.abs(h.getTime()-l.getTime())/864e5)+1),m=d*(Math.ceil(Math.abs(c.getTime()-l.getTime())/864e5)+1);u=[{x:p,y:o*(i+.5)},{x:Math.max(p,m)+20,y:o*(i+.5)},{x:Math.max(p,m)+20,y:o*(r+.5)},{x:m,y:o*(r+.5)}];const v=u[u.length-1];g=[{x:v.x,y:v.y},{x:v.x+10,y:v.y-5},{x:v.x+10,y:v.y+5},{x:v.x,y:v.y}]}return{linePoints:u,arrowPoints:g}}function lt(a,e,t,i,n,s,r,l,o,d,h,c){let u,g,p=[],m=[];if(a===R.FinishToStart){u=t,g=n;const v=h?h.attribute.x+h.attribute.width:d*(Math.ceil(Math.abs(u.getTime()-l.getTime())/864e5)+1),f=c?c.attribute.x:d*Math.ceil(Math.abs(g.getTime()-l.getTime())/864e5);p=[{x:v,y:o*(i+.5)},{x:v+20,y:o*(i+.5)},{x:v+20,y:o*(i+(i>r?0:1))},{x:f-20,y:o*(i+(i>r?0:1))},{x:f-20,y:o*(r+.5)},{x:f,y:o*(r+.5)}],v+20<=f-20&&p.splice(2,3,{x:v+20,y:o*(r+.5)});const y=p[p.length-1];m=[{x:y.x,y:y.y},{x:y.x-10,y:y.y-5},{x:y.x-10,y:y.y+5},{x:y.x,y:y.y}]}else if(a===R.StartToFinish){u=e,g=s;const v=h?h.attribute.x:d*Math.ceil(Math.abs(u.getTime()-l.getTime())/864e5),f=c?c.attribute.x+c.attribute.width:d*(Math.ceil(Math.abs(g.getTime()-l.getTime())/864e5)+1);p=[{x:v,y:o*(i+.5)},{x:v-20,y:o*(i+.5)},{x:v-20,y:o*(i+(i>r?0:1))},{x:f+20,y:o*(i+(i>r?0:1))},{x:f+20,y:o*(r+.5)},{x:f,y:o*(r+.5)}],v-20>=f+20&&p.splice(2,3,{x:v-20,y:o*(r+.5)});const y=p[p.length-1];m=[{x:y.x,y:y.y},{x:y.x+10,y:y.y-5},{x:y.x+10,y:y.y+5},{x:y.x,y:y.y}]}else if(a===R.StartToStart){u=e,g=n;const v=h?h.attribute.x:d*Math.ceil(Math.abs(u.getTime()-l.getTime())/864e5),f=c?c.attribute.x:d*Math.ceil(Math.abs(g.getTime()-l.getTime())/864e5);p=[{x:v,y:o*(i+.5)},{x:Math.min(v,f)-20,y:o*(i+.5)},{x:Math.min(v,f)-20,y:o*(r+.5)},{x:f,y:o*(r+.5)}];const y=p[p.length-1];m=[{x:y.x,y:y.y},{x:y.x-10,y:y.y-5},{x:y.x-10,y:y.y+5},{x:y.x,y:y.y}]}else if(a===R.FinishToFinish){u=t,g=s;const v=h?h.attribute.x+h.attribute.width:d*(Math.ceil(Math.abs(u.getTime()-l.getTime())/864e5)+1),f=c?c.attribute.x+c.attribute.width:d*(Math.ceil(Math.abs(g.getTime()-l.getTime())/864e5)+1);p=[{x:v,y:o*(i+.5)},{x:Math.max(v,f)+20,y:o*(i+.5)},{x:Math.max(v,f)+20,y:o*(r+.5)},{x:f,y:o*(r+.5)}];const y=p[p.length-1];m=[{x:y.x,y:y.y},{x:y.x+10,y:y.y-5},{x:y.x+10,y:y.y+5},{x:y.x,y:y.y}]}return{linePoints:p,arrowPoints:m}}Tt.load(fi);class Li{constructor(e){let t,i;this._gantt=e,this.tableGroupWidth=e.tableNoFrameWidth,this.tableGroupHeight=Math.min(e.tableNoFrameHeight,e.drawHeight),z.mode==="node"||(Fe.setEnv("browser"),t=e.canvas.width,i=e.canvas.height),this.stage=xt({canvas:e.canvas,width:t,height:i,disableDirtyBounds:!1,background:e.parsedOptions.underlayBackgroundColor,enableLayout:!0,autoRender:!1,context:{appName:"vtable"},pluginList:["poptipForText"]}),this.stage.gantt=this._gantt,this.stage.table=this._gantt,this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph()}initSceneGraph(){this.tableGroup=new O({x:this._gantt.tableX,y:this._gantt.tableY,width:this.tableGroupWidth,height:this.tableGroupHeight,clip:!0,pickable:!1}),this.stage.defaultLayer.add(this.tableGroup),this.tableGroup.name="table",this.timelineHeader=new pi(this),this.grid=new Rt(this),this.dependencyLink=new ki(this),this.taskBar=new vi(this),this.markLine=new bi(this),this.frameBorder=new yi(this),this.scrollbarComponent=new Et(this._gantt),this.stage.defaultLayer.addChild(this.scrollbarComponent.hScrollBar),this.stage.defaultLayer.addChild(this.scrollbarComponent.vScrollBar)}afterCreateSceneGraph(){this.scrollbarComponent.updateScrollBar(),ai(this._gantt.eventManager)}refreshAll(){this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.tableGroup.setAttribute("height",this.tableGroupHeight),this.timelineHeader.refresh(),this.grid.refresh(),this.taskBar.refresh(),this.markLine.refresh(),this.frameBorder.resize(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}refreshTaskBars(){this.dependencyLink.refresh(),this.taskBar.refresh(),this.updateNextFrame()}refreshTaskBarsAndGrid(){this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.tableGroup.setAttribute("height",this.tableGroupHeight),this.grid.refresh(),this.taskBar.refresh(),this.dependencyLink.refresh(),this.markLine.refresh(),this.frameBorder.resize(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}updateTableSize(){this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.tableGroup.setAttributes({x:this._gantt.tableX,y:this._gantt.tableY,width:this._gantt.tableNoFrameWidth,height:this.tableGroupHeight}),this.grid.resize(),this.taskBar.resize(),this.frameBorder.resize()}renderSceneGraph(){this.stage.render()}updateNextFrame(){this.stage.renderNextFrame()}get width(){var e,t;return(t=(e=this.tableGroup.attribute)===null||e===void 0?void 0:e.width)!==null&&t!==void 0?t:0}get height(){var e,t;return(t=(e=this.tableGroup.attribute)===null||e===void 0?void 0:e.height)!==null&&t!==void 0?t:0}get x(){var e,t;return(t=(e=this.tableGroup.attribute)===null||e===void 0?void 0:e.x)!==null&&t!==void 0?t:0}get y(){var e,t;return(t=(e=this.tableGroup.attribute)===null||e===void 0?void 0:e.y)!==null&&t!==void 0?t:0}setX(e,t=!1){this.timelineHeader.setX(e),this.grid.setX(e),this.taskBar.setX(e),this.dependencyLink.setX(e),this.markLine.setX(e),this.updateNextFrame()}setY(e,t=!1){this.grid.setY(e),this.taskBar.setY(e),this.dependencyLink.setY(e),this.updateNextFrame()}setPixelRatio(e){this.stage.disableDirtyBounds(),this.stage.window.setDpr(e),this.stage.render(),this.stage.enableDirtyBounds()}resize(){this.updateTableSize(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}release(){this.stage.release()}getTaskBarNodeByY(e){G(e,this._gantt)}showTaskCreationButton(e,t,i,n){this.taskCreationButton||(this.taskCreationButton=new _i(this._gantt.scenegraph)),this.taskCreationButton.show(e,t,this._gantt.parsedOptions.colWidthPerDay,this._gantt.parsedOptions.rowHeight),this.updateNextFrame()}hideTaskCreationButton(){this.taskCreationButton&&(this.taskCreationButton.hide(),this.updateNextFrame())}}const Bi=a=>{switch(Object.prototype.toString.call(a)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},xi=(a,e)=>Bi(a)===e,Ti=a=>xi(a,"object");function gt(a,e,t){let i,n,s,r,l,o,d=0,h=!1,c=!1,u=!0;const g=!e&&e!==0&&typeof requestAnimationFrame=="function";if(typeof a!="function")throw new TypeError("Expected a function");function p(y){const k=i,D=n;return n=void 0,i=void 0,d=y,r=a.apply(D,k),r}function m(y,k){return g?requestAnimationFrame(y):setTimeout(y,k)}function v(y){const k=y-o;return o===void 0||k>=e||k<0||h&&y-d>=s}function f(){const y=Date.now();if(v(y))return function(k){return l=void 0,u&&i?p(k):(n=void 0,i=void 0,r)}(y);l=m(f,function(k){const D=k-d,_=e&&-(k-o);return h?Math.min(_,s-D):_}(y))}return e=+e||0,Ti(t)&&(c=!!t.leading,h="maxWait"in t,h&&(s=Math.max(+t.maxWait||0,e)),u="trailing"in t?!!t.trailing:u),function(...y){const k=Date.now(),D=v(k);if(i=y,n=this,o=k,D){if(l===void 0)return function(_){return d=_,l=m(f,e),c?p(_):r}(o);if(h)return l=m(f,e),p(o)}return l===void 0&&(l=m(f,e)),r}}let Ci=1;class wi{constructor(e,t,i){var n;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{const s=this.getSize();let r=!1;s.width===this.lastSize.width&&s.height===this.lastSize.height&&(r=!0),this.lastSize=s,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:r}))},this.onResize=()=>{this.callBackDebounce()},this.element=e,this.cb=t,this.lastSize=this.getSize(),i&&(this.resizeTime=Math.max(i,16)),this.callBackDebounce=gt(this.callBack,this.resizeTime),window==null||window.addEventListener("resize",this.onResize),"ResizeObserver"in window){const s=window.ResizeObserver;this.observer=new s(this.mutationResize),(n=this.observer)===null||n===void 0||n.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(e){this.lastSize=e}checkSize(){const e=this.getSize();return e.width!==this.lastSize.width||e.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}}class Oi{constructor(){this.listeners={},this.reseizeListeners={}}on(e,t,i,...n){if(z.mode==="node")return-1;const s=Ci++;if(e!=null&&e.addEventListener)if(t!=="resize"||e===window)e==null||e.addEventListener(t,i,...n);else{const l=new wi(e,i,this.resizeTime);this.reseizeListeners[s]=l}const r={target:e,type:t,listener:i,options:n};return this.listeners[s]=r,s}once(e,t,i,...n){if(z.mode==="node")return-1;const s=this.on(e,t,(...r)=>{this.off(s),i(...r)},...n);return s}off(e){var t;if(z.mode==="node"||e==null)return;const i=(t=this.listeners)===null||t===void 0?void 0:t[e];i&&(delete this.listeners[e],i.target.removeEventListener&&i.target.removeEventListener(i.type,i.listener,...i.options))}fire(e,t,...i){if(z.mode!=="node")for(const n in this.listeners){const s=this.listeners[n];s.target===e&&s.type===t&&s.listener.call(s.target,...i)}}hasListener(e,t){if(z.mode==="node")return!1;let i=!1;for(const n in this.listeners){const s=this.listeners[n];s.target===e&&s.type===t&&(i=!0)}return i}clear(){if(z.mode!=="node"){for(const e in this.listeners){const t=this.listeners[e];t.target.removeEventListener&&t.target.removeEventListener(t.type,t.listener,...t.options)}for(const e in this.reseizeListeners){const t=this.reseizeListeners[e];t==null||t.disConnect()}this.listeners={}}}release(){z.mode!=="node"&&(this.clear(),this.listeners={})}}let De=1;function ut(){return ni?De=1:(De=Math.ceil(window.devicePixelRatio||1),De>1&&De%2!=0&&(De+=1)),De}ut();class Di{constructor(e){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._gantt=e,this._eventHandler=new Oi,this.bindEvent()}release(){this._eventHandler.release(),this.globalEventListeners.forEach(e=>{e.env==="document"?document.removeEventListener(e.name,e.callback):e.env==="body"?document.body.removeEventListener(e.name,e.callback):e.env==="window"&&window.removeEventListener(e.name,e.callback)}),this.globalEventListeners=[]}bindEvent(){zi(this),Wi(this)}}function zi(a){const e=a._gantt.scenegraph,t=a._gantt,i=t.stateManager;e.tableGroup.addEventListener("pointerdown",n=>{if(n.button!==0)return;let s,r,l;n.detailPath.find(o=>o.name==="task-bar"?(s=o,!0):o.name==="task-creation-button"?!0:o.name==="task-bar-link-point-left"?(r=o,!0):o.name==="task-bar-link-point-right"?(l=o,!0):!!o.attribute.vtable_link&&(o.attribute.vtable_link,!0)),s?n.target.name==="task-bar-hover-shadow-left-icon"?(i.startResizeTaskBar(s,n.nativeEvent.x,n.nativeEvent.y,n.offset.y,"left"),i.updateInteractionState(T.grabing)):n.target.name==="task-bar-hover-shadow-right-icon"?(i.startResizeTaskBar(s,n.nativeEvent.x,n.nativeEvent.y,n.offset.y,"right"),i.updateInteractionState(T.grabing)):t.parsedOptions.taskBarMoveable&&(i.startMoveTaskBar(s,n.nativeEvent.x,n.nativeEvent.y,n.offset.y),i.updateInteractionState(T.grabing)):r?(i.startCreateDependencyLine(r,n.nativeEvent.x,n.nativeEvent.y,n.offset.y,"left"),i.updateInteractionState(T.grabing)):l&&(i.startCreateDependencyLine(l,n.nativeEvent.x,n.nativeEvent.y,n.offset.y,"right"),i.updateInteractionState(T.grabing))}),e.tableGroup.addEventListener("pointermove",n=>{var s,r,l;if(i.interactionState===T.default){const o=n.detailPath.find(d=>d.name==="task-bar");if(o){if(e._gantt.stateManager.hoverTaskBar.target!==o&&(e._gantt.stateManager.hoverTaskBar.target=o,i.showTaskBarHover(),e._gantt.hasListeners(H.MOUSEENTER_TASK_BAR))){const d=G(n.offset.y,e._gantt),h=e._gantt.getRecordByIndex(d);e._gantt.fireListeners(H.MOUSEENTER_TASK_BAR,{event:n.nativeEvent,index:d,record:h})}}else{if(e._gantt.stateManager.hoverTaskBar.target&&(i.hideTaskBarHover(n),e._gantt.hasListeners(H.MOUSELEAVE_TASK_BAR))){const d=G(n.offset.y,e._gantt),h=e._gantt.getRecordByIndex(d);e._gantt.fireListeners(H.MOUSELEAVE_TASK_BAR,{event:n.nativeEvent,index:d,record:h})}if(t.parsedOptions.taskBarCreatable){const d=G(n.offset.y,t),h=t.getTaskInfoByTaskListIndex(d);if(!h.taskDays&&h.taskRecord){const c=si(n.offset.x,t)*t.parsedOptions.timelineColWidth-t.stateManager.scroll.horizontalBarPos,u=d*t.parsedOptions.rowHeight-t.stateManager.scroll.verticalBarPos;return void t.scenegraph.showTaskCreationButton(c,u,d,h.taskRecord)}}}t.scenegraph.hideTaskCreationButton()}else if(i.interactionState===T.grabing){let o,d,h;n.detailPath.find(c=>c.name==="task-bar"?(o=c,!0):c.name==="task-creation-button"?!0:c.name==="task-bar-link-point-left"?(d=c,!0):c.name==="task-bar-link-point-right"?(h=c,!0):!!c.attribute.vtable_link&&(c.attribute.vtable_link,!0)),o=(r=o??((s=d==null?void 0:d.parent)===null||s===void 0?void 0:s.attribute.attachedToTaskBarNode))!==null&&r!==void 0?r:(l=h==null?void 0:h.parent)===null||l===void 0?void 0:l.attribute.attachedToTaskBarNode,e._gantt.stateManager.isCreatingDependencyLine()&&!o?i.hideSecondTaskBarSelectedBorder():e._gantt.stateManager.isCreatingDependencyLine()&&d&&e._gantt.stateManager.selectedTaskBar.target!==o?(i.highlightLinkPointNode(d),i.creatingDenpendencyLink.lastHighLightLinkPoint=d,i.creatingDenpendencyLink.secondTaskBarPosition="left"):e._gantt.stateManager.isCreatingDependencyLine()&&h&&e._gantt.stateManager.selectedTaskBar.target!==o?(i.highlightLinkPointNode(h),i.creatingDenpendencyLink.lastHighLightLinkPoint=h,i.creatingDenpendencyLink.secondTaskBarPosition="right"):e._gantt.stateManager.isCreatingDependencyLine()&&o&&e._gantt.stateManager.selectedTaskBar.target!==o&&(i.unhighlightLinkPointNode(i.creatingDenpendencyLink.lastHighLightLinkPoint),i.creatingDenpendencyLink.secondTaskBarNode&&i.creatingDenpendencyLink.secondTaskBarNode===o||(i.creatingDenpendencyLink.secondTaskBarNode&&i.creatingDenpendencyLink.secondTaskBarNode!==o&&i.hideSecondTaskBarSelectedBorder(),i.creatingDenpendencyLink.secondTaskBarNode=o,i.showSecondTaskBarSelectedBorder()))}}),e.tableGroup.addEventListener("pointerup",n=>{var s;let r,l=!1,o=!1,d=!1,h=!1,c=!1;const u=n.detailPath.find(g=>g.name==="task-bar"?(l=!0,!0):g.name==="task-creation-button"?(o=!0,!1):g.name==="task-bar-link-point-left"?(h=!0,!1):g.name==="task-bar-link-point-right"?(c=!0,!1):!!g.attribute.vtable_link&&(d=!0,r=g.attribute.vtable_link,!1));if(l&&e._gantt.parsedOptions.taskBarSelectable&&a.poniterState==="down"){if(i.hideDependencyLinkSelectedLine(),e._gantt.stateManager.selectedTaskBar.target=u,i.showTaskBarSelectedBorder(),t.hasListeners(H.CLICK_TASK_BAR)){const g=G(n.offset.y,t),p=t.getRecordByIndex(g);t.fireListeners(H.CLICK_TASK_BAR,{event:n.nativeEvent,index:g,record:p})}}else if(o&&a.poniterState==="down"){i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder();const g=G(n.offset.y,t),p=t.getTaskInfoByTaskListIndex(g);if(p.taskRecord){const m=(s=t.parsedOptions.dateFormat)!==null&&s!==void 0?s:"yyyy-mm-dd";p.taskRecord[t.parsedOptions.startDateField]=p.taskRecord[t.parsedOptions.endDateField]=we(new Date(t.parsedOptions._minDateTime+Math.floor((n.offset.x+t.stateManager.scroll.horizontalBarPos)/t.parsedOptions.colWidthPerDay)*Me),m),t.scenegraph.hideTaskCreationButton(),t.updateTaskRecord(p.taskRecord,g),t.hasListeners(H.CREATE_TASK_SCHEDULE)&&t.fireListeners(H.CREATE_TASK_SCHEDULE,{event:n.nativeEvent,index:g,startDate:p.taskRecord[t.parsedOptions.startDateField],endDate:p.taskRecord[t.parsedOptions.endDateField],record:p.taskRecord})}}else if(d&&e._gantt.parsedOptions.dependencyLinkSelectable&&a.poniterState==="down")i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder(),e._gantt.stateManager.selectedDenpendencyLink.link=r,i.showDependencyLinkSelectedLine();else if(h&&a.poniterState==="draging"){if(i.isCreatingDependencyLine()){const g=i.endCreateDependencyLine(n.offset.y);t.hasListeners(H.CREATE_DEPENDENCY_LINK)&&t.fireListeners(H.CREATE_DEPENDENCY_LINK,{event:n.nativeEvent,link:g})}}else if(c&&a.poniterState==="draging"){if(i.isCreatingDependencyLine()){const g=i.endCreateDependencyLine(n.offset.y);t.hasListeners(H.CREATE_DEPENDENCY_LINK)&&t.fireListeners(H.CREATE_DEPENDENCY_LINK,{event:n.nativeEvent,link:g})}}else i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder()}),e.tableGroup.addEventListener("pointerenter",n=>{(t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.horizontalVisible==="focus"||!t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.showHorizontalScrollBar(),(t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.verticalVisible==="focus"||!t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.showVerticalScrollBar()}),e.tableGroup.addEventListener("pointerleave",n=>{(t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.horizontalVisible==="focus"||!t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.hideHorizontalScrollBar(),(t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.verticalVisible==="focus"||!t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.hideVerticalScrollBar()})}function Wi(a){const e=a._gantt,t=(a._gantt.scenegraph,e.stateManager),i=a._eventHandler;i.on(e.getElement(),"wheel",l=>{qt(l,t,a._gantt)}),i.on(e.getContainer(),"resize",l=>{l.width===0&&l.height===0||(J(e.options.pixelRatio)||e.setPixelRatio(ut()),l.windowSizeNotChange||e._resize())}),e.taskListTableInstance&&e.parsedOptions.verticalSplitLineMoveable&&i.on(e.verticalSplitResizeLine,"mousedown",l=>{t.updateInteractionState(T.grabing),t.startResizeTableWidth(l)}),e.parsedOptions.verticalSplitLineHighlight&&(e.verticalSplitResizeLine&&i.on(e.verticalSplitResizeLine,"mouseover",l=>{e.verticalSplitResizeLine.childNodes[1].style.opacity="1"}),e.verticalSplitResizeLine&&i.on(e.verticalSplitResizeLine,"mouseout",l=>{e.verticalSplitResizeLine.childNodes[1].style.opacity="0"}));const n=l=>{e.eventManager.lastDragPointerXYOnWindow={x:l.x,y:l.y},e.eventManager.poniterState="down"};a.globalEventListeners.push({name:"mousedown",env:"document",callback:n}),Fe.addEventListener("mousedown",n);const s=l=>{var o,d,h,c;if(e.eventManager.poniterState==="down"){const u=(o=e.eventManager.lastDragPointerXYOnWindow.x)!==null&&o!==void 0?o:l.x,g=l.x-u,p=(d=e.eventManager.lastDragPointerXYOnWindow.y)!==null&&d!==void 0?d:l.y,m=l.y-p;(Math.abs(g)>=1||Math.abs(m)>=1)&&(e.eventManager.poniterState="draging")}if(t.interactionState===T.grabing&&e.eventManager.poniterState==="draging"){const u=(c=(h=e.eventManager.lastDragPointerXYOnWindow)===null||h===void 0?void 0:h.x)!==null&&c!==void 0?c:l.x;Math.abs(u-l.x)>=1&&(t.isResizingTableWidth()?(t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),t.dealResizeTableWidth(l)):t.isMoveingTaskBar()?(t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),t.dealTaskBarMove(l)):t.isResizingTaskBar()?(t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),t.dealTaskBarResize(l)):t.isCreatingDependencyLine()&&t.dealCreateDependencyLine(l),e.eventManager.lastDragPointerXYOnWindow={x:l.x,y:l.y})}};a.globalEventListeners.push({name:"mousemove",env:"document",callback:s}),Fe.addEventListener("mousemove",s);const r=l=>{t.interactionState==="grabing"&&(t.updateInteractionState(T.default),t.isResizingTableWidth()?t.endResizeTableWidth():t.isMoveingTaskBar()?t.endMoveTaskBar(l.x):t.isResizingTaskBar()&&t.endResizeTaskBar(l.x)),e.eventManager.lastDragPointerXYOnWindow=void 0,e.eventManager.poniterState="up"};a.globalEventListeners.push({name:"mouseup",env:"document",callback:r}),Fe.addEventListener("mouseup",r)}function dt(a){const{scroll:e}=a.stateManager,{verticalBarPos:t}=e;a.taskListTableInstance.stateManager.setScrollTop(t,void 0,!1)}function Ai(a){var e;a.taskListTableInstance&&((e=a.taskListTableInstance)===null||e===void 0||e.on("scroll",t=>{if(t.scrollDirection==="vertical"){const{scroll:i}=a.taskListTableInstance.stateManager,{verticalBarPos:n}=i;a.stateManager.setScrollTop(n,!1)}}))}function Pi(a){var e;(e=a.taskListTableInstance)===null||e===void 0||e.on("change_cell_value",t=>{const{col:i,row:n,rawValue:s,changedValue:r}=t;a._refreshTaskBar(n-a.taskListTableInstance.columnHeaderLevelCount)})}function Mi(a){var e;(e=a.taskListTableInstance)===null||e===void 0||e.on("change_header_position",t=>{a.scenegraph.refreshTaskBars();const i=a.stateManager.scroll.horizontalBarPos,n=a.stateManager.scroll.verticalBarPos;a.scenegraph.setX(-i),a.scenegraph.setY(-n)})}function Fi(a){var e;(e=a.taskListTableInstance)===null||e===void 0||e.on("tree_hierarchy_state_change",t=>{a._syncPropsFromTable(),a.verticalSplitResizeLine.style.height=a.drawHeight+"px",a.scenegraph.refreshTaskBarsAndGrid();const i=a.stateManager.scroll.horizontalBarPos,n=a.stateManager.scroll.verticalBarPos;a.scenegraph.setX(-i),a.scenegraph.setY(-n)})}function Hi(a){var e;(e=a.taskListTableInstance)===null||e===void 0||e.on("after_sort",t=>{a.scenegraph.refreshTaskBars();const i=a.stateManager.scroll.horizontalBarPos,n=a.stateManager.scroll.verticalBarPos;a.scenegraph.setX(-i),a.scenegraph.setY(-n)})}class Ri{constructor(){}setScrollHandle(e){this.scrollHandle=e}startInertia(e,t,i){this.stopped=!1,this.lastTime=Date.now(),this.speedX=e,this.speedY=t,this.friction=i,this.runingId||(this.runingId=requestAnimationFrame(this.inertia.bind(this)))}inertia(){var e;if(this.stopped)return;const t=Date.now(),i=t-this.lastTime;let n=!0;const s=Math.pow(this.friction,i/16),r=s*this.speedX,l=s*this.speedY;let o=0,d=0;Math.abs(r)>.05&&(n=!1,o=(this.speedX+r)/2*i),Math.abs(l)>.05&&(n=!1,d=(this.speedY+l)/2*i),(e=this.scrollHandle)===null||e===void 0||e.call(this,o,d),n?this.runingId=null:(this.lastTime=t,this.speedX=r,this.speedY=l,this.runingId=requestAnimationFrame(this.inertia.bind(this)))}endInertia(){cancelAnimationFrame(this.runingId),this.runingId=null,this.stopped=!0}isInertiaScrolling(){return!!this.runingId}}class Ii{constructor(e){this.interactionState=T.default,this.resetInteractionState=gt(()=>{this.updateInteractionState(T.default)},100),this._gantt=e,this.scroll={horizontalBarPos:0,verticalBarPos:0},this.moveTaskBar={targetStartX:null,deltaX:0,startOffsetY:null,startX:null,startY:null,moving:!1,target:null,moveTaskBarXSpeed:0,moveTaskBarXInertia:new Ri},this.hoverTaskBar={targetStartX:null,startX:null,target:null},this.selectedTaskBar={target:null},this.resizeTaskBar={startOffsetY:null,targetStartX:null,startX:null,startY:null,target:null,resizing:!1,onIconName:""},this.resizeTableWidth={lastX:null,resizing:!1},this.selectedDenpendencyLink={link:null},this.creatingDenpendencyLink={startClickedPoint:null,startX:null,startY:null,startOffsetY:null,targetStartX:null,creating:!1,secondTaskBarNode:null},this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this),Ai(this._gantt),Pi(this._gantt),Mi(this._gantt),Fi(this._gantt),Hi(this._gantt)}setScrollTop(e,t=!0){const i=this._gantt.getAllRowsHeight();e=Math.max(0,Math.min(e,i-this._gantt.scenegraph.height)),e=Math.ceil(e);const n=this.scroll.verticalBarPos;this.scroll.verticalBarPos=e,J(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this._gantt.scenegraph.setY(-e);const s=e/(i-this._gantt.scenegraph.height);this._gantt.scenegraph.scrollbarComponent.updateVerticalScrollBarPos(s),n!==e&&t&&(dt(this._gantt),this._gantt.fireListeners(H.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"vertical",scrollRatioY:s}))}get scrollLeft(){return this.scroll.horizontalBarPos}get scrollTop(){return this.scroll.verticalBarPos}setScrollLeft(e,t=!0){const i=this._gantt._getAllColsWidth();e=Math.max(0,Math.min(e,i-this._gantt.scenegraph.width)),e=Math.ceil(e);const n=this.scroll.horizontalBarPos;this.scroll.horizontalBarPos=e,J(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this._gantt.scenegraph.setX(-e);const s=e/(i-this._gantt.scenegraph.width);this._gantt.scenegraph.scrollbarComponent.updateHorizontalScrollBarPos(s),n!==e&&t&&this._gantt.fireListeners(H.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"horizontal",scrollRatioX:s})}updateInteractionState(e){if(this.interactionState===e)return;const t=this.interactionState;this.interactionState=e,t===T.scrolling&&T.default}updateVerticalScrollBar(e){const t=this._gantt.getAllRowsHeight();this.scroll.verticalBarPos,this.scroll.verticalBarPos=Math.ceil(e*(t-this._gantt.scenegraph.height)),J(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this._gantt.scenegraph.setY(-this.scroll.verticalBarPos,e===1),dt(this._gantt),this._gantt.fireListeners(H.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"vertical",scrollRatioY:e})}updateHorizontalScrollBar(e){const t=this._gantt._getAllColsWidth();this.scroll.horizontalBarPos,this.scroll.horizontalBarPos=Math.ceil(e*(t-this._gantt.scenegraph.width)),J(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this._gantt.scenegraph.setX(-this.scroll.horizontalBarPos,e===1),this._gantt.fireListeners(H.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"horizontal",scrollRatioY:e})}startMoveTaskBar(e,t,i,n){e.name==="task-bar-hover-shadow"&&(e=e.parent),this.moveTaskBar.moving=!0,this.moveTaskBar.target=e,this.moveTaskBar.targetStartX=e.attribute.x,this.moveTaskBar.startX=t,this.moveTaskBar.startY=i,this.moveTaskBar.startOffsetY=n}isMoveingTaskBar(){return this.moveTaskBar.moving}endMoveTaskBar(e){this.moveTaskBar.moveTaskBarXInertia.isInertiaScrolling()&&this.moveTaskBar.moveTaskBarXInertia.endInertia();const t=G(this.moveTaskBar.startOffsetY,this._gantt),i=this.moveTaskBar.deltaX,n=Math.round(i/this._gantt.parsedOptions.colWidthPerDay),s=n*this._gantt.parsedOptions.colWidthPerDay,r=this.moveTaskBar.targetStartX+s,l=this._gantt.stateManager.moveTaskBar.target;if(Ce(t,l,r-l.attribute.x,null,this),Math.abs(n)>=1){const o=G(this.moveTaskBar.startOffsetY,this._gantt),d=this._gantt.getRecordByIndex(o),h=d[this._gantt.parsedOptions.startDateField],c=d[this._gantt.parsedOptions.endDateField];if(this._gantt._updateDateToTaskRecord("move",n,o),this._gantt.hasListeners(H.CHANGE_DATE_RANGE)){const u=this._gantt.getRecordByIndex(o);this._gantt.fireListeners(H.CHANGE_DATE_RANGE,{startDate:u[this._gantt.parsedOptions.startDateField],endDate:u[this._gantt.parsedOptions.endDateField],oldStartDate:h,oldEndDate:c,index:o,record:u})}}this._gantt.scenegraph.updateNextFrame(),this.moveTaskBar.moving=!1,this.moveTaskBar.target=null,this.moveTaskBar.deltaX=0,this.moveTaskBar.moveTaskBarXSpeed=0}dealTaskBarMove(e){const t=this.moveTaskBar.target,i=G(this.moveTaskBar.startOffsetY,this._gantt),n=this._gantt.eventManager.lastDragPointerXYOnWindow.x,s=e.x-n;this.moveTaskBar.deltaX+=s,Ce(i,t,s,null,this),t.attribute.x<=this._gantt.stateManager.scrollLeft&&s<0?(this.moveTaskBar.moveTaskBarXSpeed=-this._gantt.parsedOptions.colWidthPerDay/100,this.moveTaskBar.moveTaskBarXInertia.startInertia(this.moveTaskBar.moveTaskBarXSpeed,0,1),this.moveTaskBar.moveTaskBarXInertia.setScrollHandle((r,l)=>{this.moveTaskBar.deltaX+=r,Ce(i,t,r,null,this),this._gantt.stateManager.setScrollLeft(t.attribute.x),this._gantt.stateManager.scrollLeft===0&&this.moveTaskBar.moveTaskBarXInertia.endInertia()})):t.attribute.x+t.attribute.width>=this._gantt.stateManager.scrollLeft+this._gantt.tableNoFrameWidth&&s>0?(this.moveTaskBar.moveTaskBarXSpeed=this._gantt.parsedOptions.colWidthPerDay/100,this.moveTaskBar.moveTaskBarXInertia.startInertia(this.moveTaskBar.moveTaskBarXSpeed,0,1),this.moveTaskBar.moveTaskBarXInertia.setScrollHandle((r,l)=>{this.moveTaskBar.deltaX+=r,Ce(i,t,r,null,this),this._gantt.stateManager.setScrollLeft(t.attribute.x+t.attribute.width-this._gantt.tableNoFrameWidth),this._gantt.stateManager.scrollLeft===this._gantt._getAllColsWidth()-this._gantt.tableNoFrameWidth&&this.moveTaskBar.moveTaskBarXInertia.endInertia()})):this.moveTaskBar.moveTaskBarXInertia.isInertiaScrolling()?this.moveTaskBar.moveTaskBarXInertia.endInertia():this.moveTaskBar.moveTaskBarXSpeed=0,this._gantt.scenegraph.updateNextFrame()}startResizeTaskBar(e,t,i,n,s){this.resizeTaskBar.onIconName=s,this.resizeTaskBar.resizing=!0,this.resizeTaskBar.target=e,this.resizeTaskBar.targetStartX=e.attribute.x,this.resizeTaskBar.startX=t,this.resizeTaskBar.startY=i,this.resizeTaskBar.startOffsetY=n}isResizingTaskBar(){return this.resizeTaskBar.resizing}endResizeTaskBar(e){const t=this._gantt.stateManager.resizeTaskBar.onIconName,i=e-this.resizeTaskBar.startX;if(Math.abs(i)>=1){let n=Math.round(i/this._gantt.parsedOptions.colWidthPerDay);n=t==="left"?-n:n;const s=this._gantt.stateManager.resizeTaskBar.target,r=this._gantt.stateManager.resizeTaskBar.target.barRect,l=this._gantt.stateManager.resizeTaskBar.target.progressRect,o=G(this.resizeTaskBar.startOffsetY,this._gantt),d=this._gantt.getRecordByIndex(o),h=d[this._gantt.parsedOptions.startDateField],c=d[this._gantt.parsedOptions.endDateField],{taskDays:u,progress:g}=this._gantt.getTaskInfoByTaskListIndex(o);n<0&&u+n<=0&&(n=1-u);const p=(t==="left"?-n:n)*this._gantt.parsedOptions.colWidthPerDay,m=this.resizeTaskBar.targetStartX+p,v=this._gantt.parsedOptions.colWidthPerDay*(u+n);if(t==="left"?(Ce(o,s,m-s.attribute.x,v,this),r==null||r.setAttribute("width",s.attribute.width),l==null||l.setAttribute("width",g/100*s.attribute.width),this._gantt._updateDateToTaskRecord("start-move",-n,o)):t==="right"&&(Ce(o,s,0,v,this),r==null||r.setAttribute("width",s.attribute.width),l==null||l.setAttribute("width",g/100*s.attribute.width),this._gantt._updateDateToTaskRecord("end-move",n,o)),this.showTaskBarHover(),ht(this._gantt,s,o),this.resizeTaskBar.resizing=!1,this.resizeTaskBar.target=null,Math.abs(n)>=1&&this._gantt.hasListeners(H.CHANGE_DATE_RANGE)){const f=this._gantt.getRecordByIndex(o);this._gantt.fireListeners(H.CHANGE_DATE_RANGE,{startDate:f[this._gantt.parsedOptions.startDateField],endDate:f[this._gantt.parsedOptions.endDateField],oldStartDate:h,oldEndDate:c,index:o,record:f})}this._gantt.scenegraph.updateNextFrame()}}dealTaskBarResize(e){const t=this._gantt.eventManager.lastDragPointerXYOnWindow.x,i=e.x-t,n=this._gantt.stateManager.resizeTaskBar.target,s=n.barRect,r=n.progressRect,l=n.textLabel,o=this._gantt.parsedOptions.progressField,d=G(this.resizeTaskBar.startOffsetY,this._gantt),h=this._gantt.getRecordByIndex(d)[o];let c=this._gantt.stateManager.resizeTaskBar.onIconName==="left"?-i:i,u=n.attribute.width+c;c<0&&u<=this._gantt.parsedOptions.colWidthPerDay&&(c=this._gantt.parsedOptions.colWidthPerDay-n.attribute.width,u+=c),Ce(d,n,this._gantt.stateManager.resizeTaskBar.onIconName==="left"?-c:0,u,this),s==null||s.setAttribute("width",n.attribute.width),r==null||r.setAttribute("width",h/100*n.attribute.width),l==null||l.setAttribute("maxLineWidth",u-2*ui),this.showTaskBarHover(),ht(this._gantt,n,d),this._gantt.scenegraph.updateNextFrame()}startCreateDependencyLine(e,t,i,n,s){this.creatingDenpendencyLink.creating=!0,this.creatingDenpendencyLink.startClickedPoint=e,this.creatingDenpendencyLink.startX=t,this.creatingDenpendencyLink.startY=i,this.creatingDenpendencyLink.startOffsetY=n,this.creatingDenpendencyLink.firstTaskBarPosition=s,this.highlightLinkPointNode(e)}isCreatingDependencyLine(){return this.creatingDenpendencyLink.creating}endCreateDependencyLine(e){const t=this._gantt.parsedOptions.taskKeyField,i=G(this.creatingDenpendencyLink.startOffsetY,this._gantt),n=G(e,this._gantt),s={linkedFromTaskKey:this._gantt.getRecordByIndex(i)[t],linkedToTaskKey:this._gantt.getRecordByIndex(n)[t],type:this.creatingDenpendencyLink.firstTaskBarPosition==="left"&&this.creatingDenpendencyLink.secondTaskBarPosition==="left"?R.StartToStart:this.creatingDenpendencyLink.firstTaskBarPosition==="right"&&this.creatingDenpendencyLink.secondTaskBarPosition==="left"?R.FinishToStart:this.creatingDenpendencyLink.firstTaskBarPosition==="right"&&this.creatingDenpendencyLink.secondTaskBarPosition==="right"?R.FinishToFinish:R.StartToFinish};return this._gantt.addLink(s),this.hideTaskBarSelectedBorder(),this._gantt.scenegraph.updateNextFrame(),this.creatingDenpendencyLink.creating=!1,s}dealCreateDependencyLine(e){const t=this.creatingDenpendencyLink.startX,i=this.creatingDenpendencyLink.startY,n=e.x-t,s=e.y-i,r=this.creatingDenpendencyLink.startClickedPoint,l=r.attribute.x+r.attribute.width/2,o=r.attribute.y+r.attribute.height/2;this._gantt.scenegraph.taskBar.updateCreatingDependencyLine(l,o,l+n,o+s),this._gantt.scenegraph.updateNextFrame()}startResizeTableWidth(e){this.resizeTableWidth.resizing=!0,this.resizeTableWidth.lastX=e.pageX}isResizingTableWidth(){return this.resizeTableWidth.resizing}endResizeTableWidth(){this.resizeTableWidth.resizing=!1}dealResizeTableWidth(e){var t,i;if(!this.resizeTableWidth.resizing)return;const n=e.pageX-this.resizeTableWidth.lastX;if(Math.abs(n)>=1){let s=this._gantt.taskTableWidth+n;const r=Math.min(this._gantt.taskListTableInstance.getAllColsWidth()+this._gantt.parsedOptions.outerFrameStyle.borderLineWidth,(t=this._gantt.options.taskListTable.maxTableWidth)!==null&&t!==void 0?t:1e5),l=Math.max(this._gantt.parsedOptions.outerFrameStyle.borderLineWidth,(i=this._gantt.options.taskListTable.minTableWidth)!==null&&i!==void 0?i:0);n>0&&s>r&&(s=r),n<0&&s<l&&(s=l),this._gantt.taskTableWidth=s,this._gantt.element.style.left=this._gantt.taskTableWidth?`${this._gantt.taskTableWidth}px`:"0px",this._gantt.verticalSplitResizeLine.style.left=this._gantt.taskTableWidth?this._gantt.taskTableWidth-7+"px":"0px",this._gantt._resize(),this.resizeTableWidth.lastX=e.pageX}}showTaskBarHover(){const e=this._gantt.stateManager.hoverTaskBar.target,t=e.attribute.x,i=e.attribute.y,n=e.attribute.width,s=e.attribute.height;this._gantt.scenegraph.taskBar.showHoverBar(t,i,n,s,e),this._gantt.scenegraph.updateNextFrame()}hideTaskBarHover(e){this._gantt.stateManager.hoverTaskBar.target=null,this._gantt.scenegraph.taskBar.hideHoverBar(),this._gantt.scenegraph.updateNextFrame()}showTaskBarSelectedBorder(){const e=this._gantt.parsedOptions.dependencyLinkCreatable,t=this._gantt.stateManager.selectedTaskBar.target,i=t.attribute.x,n=t.attribute.y,s=t.attribute.width,r=t.attribute.height;this._gantt.scenegraph.taskBar.createSelectedBorder(i,n,s,r,t,e),this._gantt.scenegraph.updateNextFrame()}hideTaskBarSelectedBorder(){this._gantt.stateManager.selectedTaskBar.target=null,this._gantt.scenegraph.taskBar.removeSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}showSecondTaskBarSelectedBorder(){const e=this._gantt.stateManager.creatingDenpendencyLink.secondTaskBarNode,t=e.attribute.x,i=e.attribute.y,n=e.attribute.width,s=e.attribute.height;this._gantt.scenegraph.taskBar.createSelectedBorder(t,i,n,s,e,!0),this._gantt.scenegraph.updateNextFrame()}hideSecondTaskBarSelectedBorder(){this._gantt.stateManager.creatingDenpendencyLink.secondTaskBarNode=null,this._gantt.scenegraph.taskBar.removeSecondSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}showDependencyLinkSelectedLine(){const e=this._gantt.stateManager.selectedDenpendencyLink.link;this._gantt.scenegraph.dependencyLink.createSelectedLinkLine(e);const{taskKeyField:t,dependencyLinks:i}=this._gantt.parsedOptions,{linkedToTaskKey:n,linkedFromTaskKey:s,type:r}=e,l=te(this._gantt.records,t,n),o=te(this._gantt.records,t,s),d=this._gantt.getTaskShowIndexByRecordIndex(o.index),h=this._gantt.getTaskShowIndexByRecordIndex(l.index),c=this._gantt.scenegraph.taskBar.getTaskBarNodeByIndex(d);this._gantt.scenegraph.taskBar.createSelectedBorder(c.attribute.x,c.attribute.y,c.attribute.width,c.attribute.height,c,!1);const u=this._gantt.scenegraph.taskBar.getTaskBarNodeByIndex(h);this._gantt.scenegraph.taskBar.createSelectedBorder(u.attribute.x,u.attribute.y,u.attribute.width,u.attribute.height,u,!1),this._gantt.scenegraph.updateNextFrame()}hideDependencyLinkSelectedLine(){this._gantt.stateManager.selectedDenpendencyLink.link=null,this._gantt.scenegraph.dependencyLink.removeSelectedLinkLine(),this._gantt.scenegraph.taskBar.removeSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}highlightLinkPointNode(e){if((e==null?void 0:e.children.length)>0){const t=e.children[0];t.setAttribute("fill",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.fillColor),t.setAttribute("stroke",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.strokeColor),t.setAttribute("radius",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.radius),t.setAttribute("lineWidth",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.strokeWidth),this._gantt.scenegraph.updateNextFrame()}}unhighlightLinkPointNode(e){if((e==null?void 0:e.children.length)>0){const t=e.children[0];t.setAttribute("fill",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor),t.setAttribute("stroke",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor),t.setAttribute("radius",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius),t.setAttribute("lineWidth",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth),this._gantt.scenegraph.updateNextFrame()}}}function ht(a,e,t){const i=a.parsedOptions.taskBarCustomLayout;if(i){let n;if(typeof i=="function"){const{startDate:s,endDate:r,taskDays:l,progress:o,taskRecord:d}=a.getTaskInfoByTaskListIndex(t);n=i({width:e.attribute.width,height:e.attribute.height,index:t,startDate:s,endDate:r,taskDays:l,progress:o,taskRecord:d,ganttInstance:a})}else n=i;if(n){const s=n.rootContainer;s.name="task-bar-custom-render";const r=e.children.findIndex(o=>o.name==="task-bar-custom-render"),l=e.children[r];e.removeChild(l),e.insertInto(s,r)}}}function Ce(a,e,t,i,n){const s=n._gantt.getRecordByIndex(a);t&&e.setAttribute("x",e.attribute.x+t),i&&e.setAttribute("width",i);const r=s.vtable_gantt_linkedTo,l=s.vtable_gantt_linkedFrom;for(let o=0;o<(r==null?void 0:r.length);o++){const d=r[o],h=d.vtable_gantt_linkLineNode,c=d.vtable_gantt_linkArrowNode,{linkedToTaskKey:u,linkedFromTaskKey:g,type:p}=d,{taskKeyField:m,minDate:v}=n._gantt.parsedOptions,f=te(n._gantt.records,m,g),{startDate:y,endDate:k}=n._gantt.getTaskInfoByTaskListIndex(a),D=n._gantt.getTaskShowIndexByRecordIndex(f.index),{startDate:_,endDate:L}=n._gantt.getTaskInfoByTaskListIndex(D),{linePoints:S,arrowPoints:x}=lt(p,_,L,D,y,k,a,v,n._gantt.parsedOptions.rowHeight,n._gantt.parsedOptions.colWidthPerDay,null,e);h.setAttribute("points",S),c.setAttribute("points",x)}for(let o=0;o<(l==null?void 0:l.length);o++){const d=l[o],h=d.vtable_gantt_linkLineNode,c=d.vtable_gantt_linkArrowNode,{linkedToTaskKey:u,linkedFromTaskKey:g,type:p}=d,{taskKeyField:m,minDate:v}=n._gantt.parsedOptions,f=te(n._gantt.records,m,u),{startDate:y,endDate:k}=n._gantt.getTaskInfoByTaskListIndex(a),D=n._gantt.getTaskShowIndexByRecordIndex(f.index),{startDate:_,endDate:L}=n._gantt.getTaskInfoByTaskListIndex(D),{linePoints:S,arrowPoints:x}=lt(p,y,k,a,_,L,D,v,n._gantt.parsedOptions.rowHeight,n._gantt.parsedOptions.colWidthPerDay,e,null);h.setAttribute("points",S),c.setAttribute("points",x)}}let Ei=1;class Ni{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(e,t){const i=this.listenersData.listeners[e]||(this.listenersData.listeners[e]=[]);i.push(t);const n=Ei++;return this.listenersData.listenerData[n]={type:e,listener:t,remove:()=>{delete this.listenersData.listenerData[n];const s=i.indexOf(t);i.splice(s,1),this.listenersData.listeners[e].length||delete this.listenersData.listeners[e]}},n}off(e,t){var i;if(t){const n=e;this.removeEventListener(n,t)}else{const n=e;if(!this.listenersData)return;(i=this.listenersData.listenerData[n])===null||i===void 0||i.remove()}}addEventListener(e,t,i){this.on(e,t)}removeEventListener(e,t){if(this.listenersData)for(const i in this.listenersData.listenerData){const n=this.listenersData.listenerData[i];n.type===e&&n.listener===t&&this.off(i)}}hasListeners(e){return!!this.listenersData&&!!this.listenersData.listeners[e]}fireListeners(e,t){if(!this.listenersData)return[];const i=this.listenersData.listeners[e];return i?i.map(n=>n.call(this,t)).filter(n=>J(n)):[]}release(){delete this.listenersData}}class ji{constructor(e){this._gantt=e,this.records=e.records,this.minDate=e.parsedOptions.minDate,this.maxDate=e.parsedOptions.maxDate,this.processRecords()}processRecords(){const e=!this.minDate,t=!this.maxDate;let i=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;if(e||t){for(let s=0;s<this.records.length;s++){const r=this.records[s];if(e){const l=C(r[this._gantt.parsedOptions.startDateField]);i=Math.min(i,l.getTime())}if(t){const l=C(r[this._gantt.parsedOptions.endDateField]);n=Math.max(n,l.getTime())}}e&&(this.minDate=C(i)),t&&(this.maxDate=C(n)),this._gantt.parsedOptions.minDate=this.minDate,this._gantt.parsedOptions.maxDate=this.maxDate,this._gantt.parsedOptions._minDateTime=this._gantt.parsedOptions.minDate.getTime(),this._gantt.parsedOptions._maxDateTime=this._gantt.parsedOptions.maxDate.getTime()}}}function Gi(a,e="vtable-gantt"){var t,i;const n=document.createElement("div");n.setAttribute("tabindex","0"),n.classList.add(e),n.style.outline="none",n.style.margin=`${a.top}px ${a.right}px ${a.bottom}px ${a.left}px`;const s=(n.offsetWidth||((t=n.parentElement)===null||t===void 0?void 0:t.offsetWidth)||1)-1,r=(n.offsetHeight||((i=n.parentElement)===null||i===void 0?void 0:i.offsetHeight)||1)-1;return n.style.width=s&&s-a.left-a.right+"px"||"0px",n.style.height=r&&r-a.top-a.bottom+"px"||"0px",n}class Qe extends Ni{constructor(e,t){var i,n,s,r,l;super(),this.parsedOptions={},this.container=e,this.options=t,this.taskTableWidth=typeof((i=t==null?void 0:t.taskListTable)===null||i===void 0?void 0:i.tableWidth)=="number"?(n=t==null?void 0:t.taskListTable)===null||n===void 0?void 0:n.tableWidth:-1,this.taskTableColumns=(r=(s=t==null?void 0:t.taskListTable)===null||s===void 0?void 0:s.columns)!==null&&r!==void 0?r:[],this.records=(l=t==null?void 0:t.records)!==null&&l!==void 0?l:[],this._sortScales(),st(this),this.data=new ji(this),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this.element=Gi({top:0,right:0,left:0,bottom:0},"vtable-gantt"),this.element.style.left=this.taskTableWidth?`${this.taskTableWidth}px`:"0px",this.canvas=document.createElement("canvas"),this.element.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),e?(e.appendChild(this.element),this._updateSize()):this._updateSize(),this._generateListTable(),this._syncPropsFromTable(),ci(this),this.scenegraph=new Li(this),this.stateManager=new Ii(this),this.eventManager=new Di(this),this.scenegraph.afterCreateSceneGraph(),this._scrollToMarkLine()}renderTaskBarsTable(){this.scenegraph.updateNextFrame()}_updateSize(){var e,t,i,n,s,r,l,o;let d=0,h=0;if(z.mode==="browser"){const g=this.getElement();let p=0,m=0;if(g.parentElement){const k=g.parentElement.style||window.getComputedStyle(g.parentElement);p=g.parentElement.offsetWidth-parseInt(k.paddingLeft||"0px",10)-parseInt(k.paddingRight||"0px",10),m=g.parentElement.offsetHeight-parseInt(k.paddingTop||"0px",10)-parseInt(k.paddingBottom||"0px",20)}const v=(p??1)-1-this.taskTableWidth,f=(m??1)-1;g.style.width=v&&`${v}px`||"0px",g.style.height=f&&`${f}px`||"0px";const{canvas:y}=this;d=(t=(e=y.parentElement)===null||e===void 0?void 0:e.offsetWidth)!==null&&t!==void 0?t:1,h=(n=(i=y.parentElement)===null||i===void 0?void 0:i.offsetHeight)!==null&&n!==void 0?n:1,!((s=this==null?void 0:this.scenegraph)===null||s===void 0)&&s.stage?this.scenegraph.stage.resize(d,h):(y.style.width="",y.style.height="",y.width=d,y.height=h,y.style.width=`${d}px`,y.style.height=`${h}px`)}else z.mode;const c=Math.floor(d-li(this.parsedOptions.scrollStyle)),u=Math.floor(h-oi(this.parsedOptions.scrollStyle));if(this.tableNoFrameWidth=d,this.tableNoFrameHeight=Math.floor(h),this.parsedOptions.outerFrameStyle){const g=(r=this.parsedOptions.outerFrameStyle)===null||r===void 0?void 0:r.borderLineWidth;this.tableX=this.taskTableColumns.length>=1||!((l=this.options)===null||l===void 0)&&l.rowSeriesNumber?(o=this.parsedOptions.verticalSplitLine.lineWidth)!==null&&o!==void 0?o:0:g,this.tableY=g,this.tableNoFrameWidth=Math.min(c-g-this.tableX,this._getAllColsWidth()),this.tableNoFrameHeight=u-2*g}}_generateListTable(){var e,t,i,n,s,r,l,o,d,h,c;if(this.taskTableColumns.length>=1||!((e=this.options)===null||e===void 0)&&e.rowSeriesNumber){const u=this._generateListTableOptions();if(this.taskListTableInstance=new Ct(this.container,u),((i=(t=this.options)===null||t===void 0?void 0:t.taskListTable)===null||i===void 0?void 0:i.tableWidth)!=="auto"&&this.taskTableWidth!==-1||(this.taskTableWidth=this.taskListTableInstance.getAllColsWidth()+this.parsedOptions.outerFrameStyle.borderLineWidth,!((s=(n=this.options)===null||n===void 0?void 0:n.taskListTable)===null||s===void 0)&&s.maxTableWidth&&(this.taskTableWidth=Math.min((l=(r=this.options)===null||r===void 0?void 0:r.taskListTable)===null||l===void 0?void 0:l.maxTableWidth,this.taskTableWidth)),!((d=(o=this.options)===null||o===void 0?void 0:o.taskListTable)===null||d===void 0)&&d.minTableWidth&&(this.taskTableWidth=Math.max((c=(h=this.options)===null||h===void 0?void 0:h.taskListTable)===null||c===void 0?void 0:c.minTableWidth,this.taskTableWidth)),this.element.style.left=this.taskTableWidth?`${this.taskTableWidth}px`:"0px",this.taskListTableInstance.setCanvasSize(this.taskTableWidth,this.tableNoFrameHeight+2*this.parsedOptions.outerFrameStyle.borderLineWidth),this._updateSize()),this.taskListTableInstance.columnHeaderLevelCount>1)if(this.taskListTableInstance.columnHeaderLevelCount===this.parsedOptions.timeLineHeaderRowHeights.length)for(let g=0;g<this.taskListTableInstance.columnHeaderLevelCount;g++)this.taskListTableInstance.setRowHeight(g,this.parsedOptions.timeLineHeaderRowHeights[g]);else{const g=this.getAllHeaderRowsHeight()/this.taskListTableInstance.columnHeaderLevelCount;for(let p=0;p<this.taskListTableInstance.columnHeaderLevelCount;p++)this.taskListTableInstance.setRowHeight(p,g)}}}_generateListTableOptions(){var e,t,i,n,s,r,l,o,d,h,c,u,g,p,m,v,f,y,k,D,_,L,S,x,W,M,I,F,A,P,E,N,j,Y,X,V,U,Z,$,K,ie,ae,ne,se,re,oe,le,de,he,ce,pe,ge,ue,ve,be,ye,me,fe,_e,ke,Se,Le,Be,xe,Te;const B={},ze=["container","records","rowSeriesNumber","overscrollBehavior","pixelRatio"];for(const w in this.options)ze.indexOf(w)>=0&&(B[w]=this.options[w]);for(const w in this.options.taskListTable)B[w]=this.options.taskListTable[w],w==="columns"&&(B[w][B[w].length-1].disableColumnResize=!0);if(!((e=this.options.taskListTable)===null||e===void 0)&&e.theme)if(B.theme=(t=this.options.taskListTable)===null||t===void 0?void 0:t.theme,B.theme.bodyStyle&&!$t(B.theme,"bodyStyle")){B.theme=((i=this.options.taskListTable)===null||i===void 0?void 0:i.theme).extends(((n=this.options.taskListTable)===null||n===void 0?void 0:n.theme).getExtendTheme());const w=B.theme.getExtendTheme();B.theme.clearBodyStyleCache(),!((s=B.theme.headerStyle)===null||s===void 0)&&s.bgColor||(w.headerStyle?w.headerStyle.bgColor||(w.headerStyle.bgColor=this.parsedOptions.timelineHeaderBackgroundColor):w.headerStyle={bgColor:this.parsedOptions.timelineHeaderBackgroundColor}),w.bodyStyle?w.bodyStyle.frameStyle={borderLineWidth:[(l=(r=this.parsedOptions.horizontalSplitLine)===null||r===void 0?void 0:r.lineWidth)!==null&&l!==void 0?l:0,0,0,0],borderColor:(o=this.parsedOptions.horizontalSplitLine)===null||o===void 0?void 0:o.lineColor}:w.bodyStyle={frameStyle:{borderLineWidth:[(h=(d=this.parsedOptions.horizontalSplitLine)===null||d===void 0?void 0:d.lineWidth)!==null&&h!==void 0?h:0,0,0,0],borderColor:(c=this.parsedOptions.horizontalSplitLine)===null||c===void 0?void 0:c.lineColor}},w.cellInnerBorder=!1,w.frameStyle=Object.assign({},this.parsedOptions.outerFrameStyle,{shadowBlur:0,cornerRadius:[(g=(u=this.parsedOptions.outerFrameStyle)===null||u===void 0?void 0:u.cornerRadius)!==null&&g!==void 0?g:0,0,0,(m=(p=this.parsedOptions.outerFrameStyle)===null||p===void 0?void 0:p.cornerRadius)!==null&&m!==void 0?m:0],borderLineWidth:[(f=(v=this.parsedOptions.outerFrameStyle)===null||v===void 0?void 0:v.borderLineWidth)!==null&&f!==void 0?f:0,0,(k=(y=this.parsedOptions.outerFrameStyle)===null||y===void 0?void 0:y.borderLineWidth)!==null&&k!==void 0?k:0,(_=(D=this.parsedOptions.outerFrameStyle)===null||D===void 0?void 0:D.borderLineWidth)!==null&&_!==void 0?_:0]}),w.scrollStyle=Object.assign({},(S=(L=this.options.taskListTable)===null||L===void 0?void 0:L.theme)===null||S===void 0?void 0:S.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),w.columnResize=Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},w==null?void 0:w.columnResize),w.underlayBackgroundColor||(w.underlayBackgroundColor=this.parsedOptions.underlayBackgroundColor)}else B.theme.headerStyle?B.theme.headerStyle.bgColor||(B.theme.headerStyle.bgColor=this.parsedOptions.timelineHeaderBackgroundColor):B.theme.headerStyle={bgColor:this.parsedOptions.timelineHeaderBackgroundColor},B.theme.headerStyle=Object.assign({},Pe.headerStyle,{bgColor:this.parsedOptions.timelineHeaderBackgroundColor},(W=(x=this.options.taskListTable)===null||x===void 0?void 0:x.theme)===null||W===void 0?void 0:W.headerStyle),B.theme.bodyStyle=Object.assign({},Pe.bodyStyle,(I=(M=this.options.taskListTable)===null||M===void 0?void 0:M.theme)===null||I===void 0?void 0:I.bodyStyle,{frameStyle:{borderLineWidth:[(A=(F=this.parsedOptions.horizontalSplitLine)===null||F===void 0?void 0:F.lineWidth)!==null&&A!==void 0?A:0,0,0,0],borderColor:(P=this.parsedOptions.horizontalSplitLine)===null||P===void 0?void 0:P.lineColor}}),B.theme.cellInnerBorder=!1,B.theme.frameStyle=Object.assign({},this.parsedOptions.outerFrameStyle,{cornerRadius:[(N=(E=this.parsedOptions.outerFrameStyle)===null||E===void 0?void 0:E.cornerRadius)!==null&&N!==void 0?N:0,0,0,(Y=(j=this.parsedOptions.outerFrameStyle)===null||j===void 0?void 0:j.cornerRadius)!==null&&Y!==void 0?Y:0],borderLineWidth:[(V=(X=this.parsedOptions.outerFrameStyle)===null||X===void 0?void 0:X.borderLineWidth)!==null&&V!==void 0?V:0,0,(Z=(U=this.parsedOptions.outerFrameStyle)===null||U===void 0?void 0:U.borderLineWidth)!==null&&Z!==void 0?Z:0,(K=($=this.parsedOptions.outerFrameStyle)===null||$===void 0?void 0:$.borderLineWidth)!==null&&K!==void 0?K:0]}),B.theme.scrollStyle=Object.assign({},(ae=(ie=this.options.taskListTable)===null||ie===void 0?void 0:ie.theme)===null||ae===void 0?void 0:ae.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),B.theme.columnResize=Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},(se=(ne=this.options.taskListTable)===null||ne===void 0?void 0:ne.theme)===null||se===void 0?void 0:se.columnResize),B.theme.underlayBackgroundColor||(B.theme.underlayBackgroundColor=this.parsedOptions.underlayBackgroundColor);else B.theme={scrollStyle:Object.assign({},(oe=(re=this.options.taskListTable)===null||re===void 0?void 0:re.theme)===null||oe===void 0?void 0:oe.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),headerStyle:Object.assign({},Pe.headerStyle,{bgColor:this.parsedOptions.timelineHeaderBackgroundColor},(de=(le=this.options.taskListTable)===null||le===void 0?void 0:le.theme)===null||de===void 0?void 0:de.headerStyle),bodyStyle:Object.assign({},Pe.bodyStyle,(ce=(he=this.options.taskListTable)===null||he===void 0?void 0:he.theme)===null||ce===void 0?void 0:ce.bodyStyle,{frameStyle:{borderLineWidth:[(ge=(pe=this.parsedOptions.horizontalSplitLine)===null||pe===void 0?void 0:pe.lineWidth)!==null&&ge!==void 0?ge:0,0,0,0],borderColor:(ue=this.parsedOptions.horizontalSplitLine)===null||ue===void 0?void 0:ue.lineColor}}),cellInnerBorder:!1,frameStyle:Object.assign({},this.parsedOptions.outerFrameStyle,{cornerRadius:[(be=(ve=this.parsedOptions.outerFrameStyle)===null||ve===void 0?void 0:ve.cornerRadius)!==null&&be!==void 0?be:0,0,0,(me=(ye=this.parsedOptions.outerFrameStyle)===null||ye===void 0?void 0:ye.cornerRadius)!==null&&me!==void 0?me:0],borderLineWidth:[(_e=(fe=this.parsedOptions.outerFrameStyle)===null||fe===void 0?void 0:fe.borderLineWidth)!==null&&_e!==void 0?_e:0,0,(Se=(ke=this.parsedOptions.outerFrameStyle)===null||ke===void 0?void 0:ke.borderLineWidth)!==null&&Se!==void 0?Se:0,(Be=(Le=this.parsedOptions.outerFrameStyle)===null||Le===void 0?void 0:Le.borderLineWidth)!==null&&Be!==void 0?Be:0]}),columnResize:Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},(Te=(xe=this.options.taskListTable)===null||xe===void 0?void 0:xe.theme)===null||Te===void 0?void 0:Te.columnResize),underlayBackgroundColor:this.parsedOptions.underlayBackgroundColor};return B.canvasWidth=this.taskTableWidth,B.canvasHeight=this.canvas.height,B.defaultHeaderRowHeight=this.getAllHeaderRowsHeight(),B.defaultRowHeight=this.parsedOptions.rowHeight,B.clearDOM=!1,B}getElement(){return this.element}getContainer(){return this.element.parentElement}_sortScales(){const{timelineHeader:e}=this.options;if(e){const t=e.scales,i=["year","quarter","month","week","day"],n=t.slice().sort((r,l)=>{const o=i.indexOf(r.unit),d=i.indexOf(l.unit);return o===-1?1:d===-1?-1:o-d}),s=t.slice().sort((r,l)=>{const o=i.indexOf(r.unit),d=i.indexOf(l.unit);return o===-1?1:d===-1?-1:d-o});this.parsedOptions.sortedTimelineScales=n,this.parsedOptions.reverseSortedTimelineScales=s}}_generateTimeLineDateMap(){const e=C(this.parsedOptions.minDate),t=C(this.parsedOptions.maxDate);let i=1e6;for(const l of this.parsedOptions.reverseSortedTimelineScales){const o=C(e);l.timelineDates=di(o,t,l)}const n=this.parsedOptions.reverseSortedTimelineScales[0],{unit:s,step:r}=n;s==="day"?i=r:s==="month"?i=30:s==="week"?i=7:s==="quarter"?i=90:s==="year"&&(i=365),this.parsedOptions.colWidthPerDay=this.parsedOptions.timelineColWidth/i}getAllRowsHeight(){return this.getAllHeaderRowsHeight()+this.itemCount*this.parsedOptions.rowHeight}getAllHeaderRowsHeight(){return this.parsedOptions.timeLineHeaderRowHeights.reduce((e,t,i)=>e+t,0)}_getAllColsWidth(){return this.parsedOptions.colWidthPerDay*(Math.ceil(Math.abs(C(this.parsedOptions.maxDate).getTime()-C(this.parsedOptions.minDate).getTime())/864e5)+1)}getAllTaskBarsHeight(){return this.itemCount*this.parsedOptions.rowHeight}getTaskShowIndexByRecordIndex(e){return this.taskListTableInstance.getBodyRowIndexByRecordIndex(e)}getRecordByIndex(e){return this.taskListTableInstance?this.taskListTableInstance.getRecordByRowCol(0,e+this.taskListTableInstance.columnHeaderLevelCount):this.records[e]}_refreshTaskBar(e){this.scenegraph.taskBar.updateTaskBarNode(e),this.scenegraph.updateNextFrame()}_updateRecordToListTable(e,t){const i=this.taskListTableInstance.getRecordIndexByCell(0,t+this.taskListTableInstance.columnHeaderLevelCount);this.taskListTableInstance.updateRecords([e],[i])}getTaskInfoByTaskListIndex(e){const t=this.getRecordByIndex(e),i=this.parsedOptions.startDateField,n=this.parsedOptions.endDateField,s=this.parsedOptions.progressField,r=C(t==null?void 0:t[i]).getTime(),l=C(t==null?void 0:t[n]).getTime();if(l<this.parsedOptions._minDateTime||r>this.parsedOptions._maxDateTime||!(t!=null&&t[i])||!(t!=null&&t[n]))return{taskDays:0,progress:0,startDate:null,endDate:null,taskRecord:t};const o=C(Math.min(Math.max(this.parsedOptions._minDateTime,r),this.parsedOptions._maxDateTime)),d=C(Math.max(Math.min(this.parsedOptions._maxDateTime,l),this.parsedOptions._minDateTime)),h=hi(t[s]);return{taskRecord:t,taskDays:Math.ceil(Math.abs(d.getTime()-o.getTime())/864e5)+1,startDate:o,endDate:d,progress:h}}_updateDateToTaskRecord(e,t,i){var n;const s=this.getRecordByIndex(i),r=this.parsedOptions.startDateField,l=this.parsedOptions.endDateField,o=(n=this.parsedOptions.dateFormat)!==null&&n!==void 0?n:Gt(s[r]),d=C(s[r]),h=C(s[l]);if(e==="move"){const c=we(C(t*Me+d.getTime()),o),u=we(C(t*Me+h.getTime()),o);s[r]=c,s[l]=u}else if(e==="start-move"){const c=we(C(t*Me+d.getTime()),o);s[r]=c}else if(e==="end-move"){const c=we(C(t*Me+h.getTime()),o);s[l]=c}this._updateRecordToListTable(s,i)}updateTaskRecord(e,t){this._updateRecordToListTable(e,t),this._refreshTaskBar(t)}setPixelRatio(e){var t;(t=this.taskListTableInstance)===null||t===void 0||t.setPixelRatio(e),this.parsedOptions.pixelRatio=e,this.scenegraph.setPixelRatio(e)}_resize(){var e;this._updateSize(),(e=this.taskListTableInstance)===null||e===void 0||e.setCanvasSize(this.taskTableWidth,this.tableNoFrameHeight+2*this.parsedOptions.outerFrameStyle.borderLineWidth),this._syncPropsFromTable(),this.scenegraph.resize(),rt(this)}_syncPropsFromTable(){this.itemCount=this.taskListTableInstance?this.taskListTableInstance.rowCount-this.taskListTableInstance.columnHeaderLevelCount:this.records.length,this.headerHeight=this.getAllHeaderRowsHeight(),this.drawHeight=Math.min(this.headerHeight+this.parsedOptions.rowHeight*this.itemCount,this.tableNoFrameHeight),this.gridHeight=this.drawHeight-this.headerHeight}getContext(){return this.context}release(){var e,t;(e=super.release)===null||e===void 0||e.call(this),this.eventManager.release(),(t=this.taskListTableInstance)===null||t===void 0||t.release();const{parentElement:i}=this.element;i&&(i.removeChild(this.element),this.verticalSplitResizeLine&&i.removeChild(this.verticalSplitResizeLine),this.horizontalSplitLine&&i.removeChild(this.horizontalSplitLine)),this.scenegraph=null}setRecords(e){this.records=e,this.taskListTableInstance.setRecords(e),this._syncPropsFromTable(),this.verticalSplitResizeLine.style.height=this.drawHeight+"px",this.scenegraph.refreshTaskBarsAndGrid();const t=this.stateManager.scroll.horizontalBarPos,i=this.stateManager.scroll.verticalBarPos;this.scenegraph.setX(-t),this.scenegraph.setY(-i)}updateScales(e){if(this.options.timelineHeader.scales=e,this._sortScales(),st(this),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this.scenegraph.refreshAll(),rt(this),this.taskListTableInstance)if(this.taskListTableInstance.columnHeaderLevelCount===this.parsedOptions.timeLineHeaderRowHeights.length)for(let t=0;t<this.taskListTableInstance.columnHeaderLevelCount;t++)this.taskListTableInstance.setRowHeight(t,this.parsedOptions.timeLineHeaderRowHeights[t]);else{const t=this.getAllHeaderRowsHeight()/this.taskListTableInstance.columnHeaderLevelCount;for(let i=0;i<this.taskListTableInstance.columnHeaderLevelCount;i++)this.taskListTableInstance.setRowHeight(i,t)}}_scrollToMarkLine(){if(this.parsedOptions.scrollToMarkLineDate){const e=this.parsedOptions.minDate,t=(this.parsedOptions.scrollToMarkLineDate.getTime()-e.getTime())/864e5*this.parsedOptions.colWidthPerDay-this.tableNoFrameWidth/2;this.stateManager.setScrollLeft(t)}}addLink(e){this.parsedOptions.dependencyLinks.push(e),this.scenegraph.dependencyLink.initLinkLine(this.parsedOptions.dependencyLinks.length-1),this.scenegraph.updateNextFrame()}deleteLink(e){const t=this.parsedOptions.dependencyLinks.findIndex(i=>i.type===e.type&&i.linkedFromTaskKey===e.linkedFromTaskKey&&i.linkedToTaskKey===e.linkedToTaskKey);if(t!==-1){const i=this.parsedOptions.dependencyLinks[t];this.parsedOptions.dependencyLinks.splice(t,1),this.scenegraph.dependencyLink.deleteLink(i),this.scenegraph.updateNextFrame()}}}class vt{constructor(e){this.editorType="Input",this.editorConfig=e}createElement(){var e;const t=document.createElement("input");t.setAttribute("type","text"),!((e=this.editorConfig)===null||e===void 0)&&e.readonly&&t.setAttribute("readonly",`${this.editorConfig.readonly}`),t.style.position="absolute",t.style.padding="4px",t.style.width="100%",t.style.boxSizing="border-box",t.style.backgroundColor="#FFFFFF",this.element=t,this.container.appendChild(t),t.addEventListener("keydown",i=>{i.key==="a"&&(i.ctrlKey||i.metaKey)&&i.stopPropagation()})}setValue(e){this.element.value=e!==void 0?e:""}getValue(){return this.element.value}onStart({value:e,referencePosition:t,container:i,endEdit:n}){this.container=i,this.successCallback=n,this.element||(this.createElement(),e!=null&&this.setValue(e),t!=null&&t.rect&&this.adjustPosition(t.rect)),this.element.focus()}adjustPosition(e){this.element.style.top=e.top+"px",this.element.style.left=e.left+"px",this.element.style.width=e.width+"px",this.element.style.height=e.height+"px"}endEditing(){}onEnd(){var e;!((e=this.container)===null||e===void 0)&&e.contains(this.element)&&this.container.removeChild(this.element),this.element=void 0}isEditorElement(e){return e===this.element}}class Xi extends vt{constructor(e){super(e),this.editorType="DateInput",this.editorConfig=e}createElement(){const e=document.createElement("input");e.setAttribute("type","date"),e.style.padding="4px",e.style.width="100%",e.style.boxSizing="border-box",e.style.position="absolute",e.style.backgroundColor="#FFFFFF",this.element=e,this.container.appendChild(e),e.addEventListener("keydown",t=>{t.key==="a"&&(t.ctrlKey||t.metaKey)&&t.stopPropagation()})}}const Yi=[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-15",progress:31,priority:"P0",children:[{id:2,title:"Project Feature Review",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-07-24",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-25",end:"2024-07-26",progress:100,priority:"P1"},{id:3,title:"Project Create",developer:"liufangfang.jane@bytedance.com",start:"2024-07-27",end:"2024-07-26",progress:100,priority:"P1"},{id:3,title:"Develop feature 1",developer:"liufangfang.jane@bytedance.com",start:"2024-08-01",end:"2024-08-15",progress:0,priority:"P1"}]},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-01",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-08-01",end:"2024-08-01",progress:90,priority:"P0"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-30",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024.07.26",end:"2024.07.08",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"07.24.2024",end:"08.04.2024",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-16",end:"2024-07-18",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-08-09",end:"2024-09-11",progress:100,priority:"P1"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0",children:[{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-06",end:"2024-07-08",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-06",end:"2024-07-08",progress:60,priority:"P0"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-23",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-30",end:"2024-08-14",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:60,priority:"P0"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0",children:[{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-08-04",end:"2024-08-04",progress:90,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"07/24/2024",end:"08/04/2024",progress:60,priority:"P0"}]},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-27",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"07.24.2024",end:"08.04.2024",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-08-09",end:"2024-09-11",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0",children:[{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024.07.06",end:"2024.07.08",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]}],Vi=[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-15",end:"2024-07-16",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-16",end:"2024-07-17",progress:60,priority:"P0"},{id:3,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-18",end:"2024-07-19",progress:90,priority:"P0"},{id:4,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024/07/17",end:"2024/07/18",progress:100,priority:"P1"},{id:5,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"07/19/2024",end:"07/20/2024",progress:60,priority:"P0"},{id:6,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1"},{id:7,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:8,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024.07.06",end:"2024.07.08",progress:60,priority:"P0"},{id:9,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024/07/09",end:"2024/07/11",progress:100,priority:"P1"},{id:10,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"07.24.2024",end:"08.04.2024",progress:31,priority:"P0"},{id:11,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:12,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-06",end:"2024-07-08",progress:60,priority:"P0"},{id:13,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-09",end:"2024-07-11",progress:100,priority:"P1"}],Ki=[{id:1,title:"Project Task 1",developer:"bear.xiong",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bear.jpg",start:"2024-07-24",end:"2024-07-26",progress:31,priority:"P0"},{id:2,title:"Project Task 2",developer:"wolf.lang",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/wolf.jpg",start:"07/25/2024",end:"07/28/2024",progress:60,priority:"P0"},{id:3,title:"Project Task 3",developer:"rabbit.tu",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/rabbit.jpg",start:"2024-07-28",end:"2024-08-01",progress:100,priority:"P1"},{id:1,title:"Project Task 4",developer:"cat.mao",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/cat.jpg",start:"2024-07-31",end:"2024-08-03",progress:31,priority:"P0"},{id:2,title:"Project Task 5",developer:"bird.niao",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bird.jpeg",start:"2024-08-02",end:"2024-08-04",progress:60,priority:"P0"},{id:3,title:"Project Task 6",developer:"flower.hua",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/flower.jpg",start:"2024-08-03",end:"2024-08-10",progress:100,priority:"P1"}],Qi=Ot({name:"plugin_gantt_vtable",__name:"index",setup(a){const e=Dt(),t=new vt,i=new Xi;at("input",t),at("date-input",i);const n=Oe(),s=Oe(),r=Oe(),l=Oe(),o=Oe(),d=Oe(),c={overscrollBehavior:"none",records:Yi,taskListTable:{columns:[{field:"title",title:"title",width:"auto",sort:!0,tree:!0,editor:"input"},{field:"start",title:"start",width:"auto",sort:!0,editor:"date-input"},{field:"end",title:"end",width:"auto",sort:!0,editor:"date-input"},{field:"priority",title:"priority",width:"auto",sort:!0,editor:"input"},{field:"progress",title:"progress",width:"auto",sort:!0,headerStyle:{borderColor:"#e1e4e8"},style:{borderColor:"#e1e4e8",color:"green"},editor:"input"}],tableWidth:250,minTableWidth:100,maxTableWidth:600},frame:{outerFrameStyle:{borderLineWidth:2,borderColor:"#e1e4e8",cornerRadius:8},verticalSplitLine:{lineColor:"#e1e4e8",lineWidth:3},horizontalSplitLine:{lineColor:"#e1e4e8",lineWidth:3},verticalSplitLineMoveable:!0,verticalSplitLineHighlight:{lineColor:"green",lineWidth:3}},grid:{verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"}},headerRowHeight:40,rowHeight:40,taskBar:{startDateField:"start",endDateField:"end",progressField:"progress",moveable:!0,hoverBarStyle:{barOverlayColor:"rgba(99, 144, 0, 0.4)"},labelText:"{title} {progress}%",labelTextStyle:{fontFamily:"Arial",fontSize:16,textAlign:"left",textOverflow:"ellipsis"},barStyle:{width:20,barColor:"#ee8800",completedBarColor:"#91e8e0",cornerRadius:8}},timelineHeader:{colWidth:100,backgroundColor:"#EEF1F5",horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"},verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},scales:[{unit:"week",step:1,startOfWeek:"sunday",format(_){return`Week ${_.dateIndex}`},style:{fontSize:20,fontWeight:"bold",color:"white",strokeColor:"black",textAlign:"right",textBaseline:"bottom",textStick:!0}},{unit:"day",step:1,format(_){return _.dateIndex.toString()},style:{fontSize:20,fontWeight:"bold",color:"white",strokeColor:"black",textAlign:"right",textBaseline:"bottom"}}]},markLine:[{date:"2024-07-28",style:{lineWidth:1,lineColor:"blue",lineDash:[8,4]}},{date:"2024-08-17",style:{lineWidth:2,lineColor:"red",lineDash:[8,4]}}],rowSeriesNumber:{title:"",dragOrder:!0},scrollStyle:{scrollRailColor:"RGBA(246,246,246,0.5)",visible:"scrolling",width:6,scrollSliderCornerRadius:2,scrollSliderColor:"#5cb85c"}},g={records:Vi,taskListTable:{columns:[{field:"title",title:"title",width:"auto",tree:!0},{field:"start",title:"start",width:"auto",editor:"date-input"},{field:"end",title:"end",width:"auto",editor:"date-input"},{field:"priority",title:"priority",width:"auto",editor:"input"},{field:"progress",title:"progress",width:"auto",headerStyle:{borderColor:"#e1e4e8"},style:{borderColor:"#e1e4e8",color:"green"},editor:"input"}],tableWidth:400,minTableWidth:100,maxTableWidth:600},dependency:{links:[{type:R.FinishToStart,linkedFromTaskKey:1,linkedToTaskKey:2},{type:R.StartToFinish,linkedFromTaskKey:2,linkedToTaskKey:3},{type:R.StartToStart,linkedFromTaskKey:3,linkedToTaskKey:4},{type:R.FinishToFinish,linkedFromTaskKey:4,linkedToTaskKey:5}],linkSelectedLineStyle:{shadowBlur:5,shadowColor:"red",lineColor:"red",lineWidth:1}},frame:{verticalSplitLineMoveable:!0,outerFrameStyle:{borderLineWidth:2,cornerRadius:8},verticalSplitLine:{lineWidth:3,lineColor:"#e1e4e8"},verticalSplitLineHighlight:{lineColor:"green",lineWidth:3}},grid:{verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"}},headerRowHeight:60,rowHeight:40,taskBar:{startDateField:"start",endDateField:"end",progressField:"progress",labelText:"{title} {progress}%",labelTextStyle:{fontFamily:"Arial",fontSize:16,textAlign:"left"},barStyle:{width:20,barColor:"#ee8800",completedBarColor:"#91e8e0",cornerRadius:10},selectedBarStyle:{shadowBlur:5,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black",borderColor:"red",borderLineWidth:1}},timelineHeader:{verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"},backgroundColor:"#EEF1F5",colWidth:60,scales:[{unit:"week",step:1,startOfWeek:"sunday",format(_){return`Week ${_.dateIndex}`},style:{fontSize:20,fontWeight:"bold",color:"red"}},{unit:"day",step:1,format(_){return _.dateIndex.toString()},style:{fontSize:20,fontWeight:"bold",color:"red"}}]},minDate:"2024-07-14",maxDate:"2024-10-15",rowSeriesNumber:{title:"",dragOrder:!0},scrollStyle:{visible:"scrolling"},overscrollBehavior:"none"},p=["#aecde6","#c6a49a","#ffb582","#eec1de","#b3d9b3","#cccccc","#e59a9c","#d9d1a5","#c9bede"],m=["#1f77b4","#8c564b","#ff7f0e","#e377c2","#2ca02c","#7f7f7f","#d62728","#bcbd22","#9467bd"],f={records:Ki,taskListTable:{columns:[{field:"title",title:"TASK",width:"200",headerStyle:{textAlign:"center",fontSize:20,fontWeight:"bold"},style:{},customLayout:_=>{const{table:L,row:S,col:x,rect:W}=_,M=L.getCellOriginRecord(x,S),{height:I,width:F}=W??L.getCellRect(x,S),A=new O({y:10,x:20,height:I-20,width:F-40,fill:"#ddd",display:"flex",flexDirection:"column",cornerRadius:30}),P=new ee({text:M.developer,fontSize:16,fontFamily:"sans-serif",fill:m[_.row],fontWeight:"bold",maxLineWidth:F-120,boundsPadding:[10,0,0,0],alignSelf:"center"});A.add(P);const E=new ee({text:`${we(new Date(M.start),"mm/dd")}-${we(new Date(M.end),"mm/dd")}`,fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",fill:"black",boundsPadding:[10,0,0,0],alignSelf:"center"});return A.add(E),{rootContainer:A,expectedWidth:160}}}],tableWidth:"auto"},frame:{outerFrameStyle:{borderLineWidth:2,borderColor:"#E1E4E8",cornerRadius:8}},grid:{horizontalLine:{lineWidth:2,lineColor:"#d5d9ee"}},headerRowHeight:60,rowHeight:80,taskBar:{startDateField:"start",endDateField:"end",progressField:"progress",barStyle:{width:60},customLayout:_=>{const L=m.length,{width:S,height:x,index:W,taskDays:M,progress:I,taskRecord:F}=_,A=new O({width:S,height:x,cornerRadius:30,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{offset:0,color:p[W%L]},{offset:.5,color:m[W%L]},{offset:1,color:p[W%L]}]},display:"flex",flexDirection:"row",flexWrap:"nowrap"}),P=new O({height:x,width:60,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around"});A.add(P);const E=new He({width:50,height:50,image:F.avatar,cornerRadius:25});P.add(E);const N=new O({height:x,width:S-120,display:"flex",flexDirection:"column"});A.add(N);const j=new ee({text:F.developer,fontSize:16,fontFamily:"sans-serif",fill:"white",fontWeight:"bold",maxLineWidth:S-120,boundsPadding:[10,0,0,0]});N.add(j);const Y=new ee({text:`${M}`,fontSize:13,fontFamily:"sans-serif",fill:"white",boundsPadding:[10,0,0,0]});if(N.add(Y),S>=120){const X=new O({cornerRadius:20,fill:"white",height:40,width:40,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",boundsPadding:[10,0,0,0]});A.add(X);const V=new ee({text:`${I}%`,fontSize:12,fontFamily:"sans-serif",fill:"black",alignSelf:"center",fontWeight:"bold",maxLineWidth:(S-60)/2,boundsPadding:[0,0,0,0]});X.add(V)}return{rootContainer:A}},hoverBarStyle:{cornerRadius:30}},timelineHeader:{backgroundColor:"#f0f0fb",colWidth:80,scales:[{unit:"day",step:1,format(_){return _.dateIndex.toString()},customLayout:_=>{const{width:L,height:S,startDate:x,dateIndex:W}=_,M=new O({width:L,height:S,display:"flex",flexDirection:"row",flexWrap:"nowrap"}),I=new O({height:S,width:30,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around"});M.add(I);const F=new He({width:20,height:30,image:'<svg t="1724675965803" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4299" width="200" height="200"><path d="M53.085678 141.319468C23.790257 141.319468 0 165.035326 0 194.34775L0 918.084273C0 947.295126 23.796789 971.112572 53.085678 971.112572L970.914322 971.112572C1000.209743 971.112572 1024 947.396696 1024 918.084273L1024 194.34775C1024 165.136896 1000.203211 141.319468 970.914322 141.319468L776.827586 141.319468 812.137931 176.629813 812.137931 88.275862C812.137931 68.774506 796.328942 52.965517 776.827586 52.965517 757.32623 52.965517 741.517241 68.774506 741.517241 88.275862L741.517241 176.629813 741.517241 211.940158 776.827586 211.940158 970.914322 211.940158C961.186763 211.940158 953.37931 204.125926 953.37931 194.34775L953.37931 918.084273C953.37931 908.344373 961.25643 900.491882 970.914322 900.491882L53.085678 900.491882C62.813237 900.491882 70.62069 908.306097 70.62069 918.084273L70.62069 194.34775C70.62069 204.087649 62.74357 211.940158 53.085678 211.940158L247.172414 211.940158C266.67377 211.940158 282.482759 196.131169 282.482759 176.629813 282.482759 157.128439 266.67377 141.319468 247.172414 141.319468L53.085678 141.319468ZM211.862069 176.629813C211.862069 196.131169 227.671058 211.940158 247.172414 211.940158 266.67377 211.940158 282.482759 196.131169 282.482759 176.629813L282.482759 88.275862C282.482759 68.774506 266.67377 52.965517 247.172414 52.965517 227.671058 52.965517 211.862069 68.774506 211.862069 88.275862L211.862069 176.629813ZM1024 353.181537 1024 317.871192 988.689655 317.871192 35.310345 317.871192 0 317.871192 0 353.181537 0 441.457399C0 460.958755 15.808989 476.767744 35.310345 476.767744 54.811701 476.767744 70.62069 460.958755 70.62069 441.457399L70.62069 353.181537 35.310345 388.491882 988.689655 388.491882 953.37931 353.181537 953.37931 441.457399C953.37931 460.958755 969.188299 476.767744 988.689655 476.767744 1008.191011 476.767744 1024 460.958755 1024 441.457399L1024 353.181537ZM776.937913 582.62069C796.439287 582.62069 812.248258 566.811701 812.248258 547.310345 812.248258 527.808989 796.439287 512 776.937913 512L247.172414 512C227.671058 512 211.862069 527.808989 211.862069 547.310345 211.862069 566.811701 227.671058 582.62069 247.172414 582.62069L776.937913 582.62069ZM247.172414 688.551724C227.671058 688.551724 211.862069 704.360713 211.862069 723.862069 211.862069 743.363425 227.671058 759.172414 247.172414 759.172414L600.386189 759.172414C619.887563 759.172414 635.696534 743.363425 635.696534 723.862069 635.696534 704.360713 619.887563 688.551724 600.386189 688.551724L247.172414 688.551724ZM776.827586 211.940158 741.517241 176.629813 741.517241 247.328574C741.517241 266.829948 757.32623 282.638919 776.827586 282.638919 796.328942 282.638919 812.137931 266.829948 812.137931 247.328574L812.137931 176.629813 812.137931 141.319468 776.827586 141.319468 247.172414 141.319468C227.671058 141.319468 211.862069 157.128439 211.862069 176.629813 211.862069 196.131169 227.671058 211.940158 247.172414 211.940158L776.827586 211.940158ZM282.482759 176.629813C282.482759 157.128439 266.67377 141.319468 247.172414 141.319468 227.671058 141.319468 211.862069 157.128439 211.862069 176.629813L211.862069 247.328574C211.862069 266.829948 227.671058 282.638919 247.172414 282.638919 266.67377 282.638919 282.482759 266.829948 282.482759 247.328574L282.482759 176.629813Z" fill="#389BFF" p-id="4300"></path></svg>'});I.add(F);const A=new O({height:S,width:L-30,display:"flex",flexDirection:"column"});M.add(A);const P=new ee({text:String(W).padStart(2,"0"),fontSize:20,fontWeight:"bold",fontFamily:"sans-serif",fill:"#777",textAlign:"right",maxLineWidth:L-30,boundsPadding:[15,0,0,0]});A.add(P);const E=new ee({text:Kt(x,"short").toLocaleUpperCase(),fontSize:12,fontFamily:"sans-serif",fill:"#777",boundsPadding:[0,0,0,0]});return A.add(E),{rootContainer:M}}}]},minDate:"2024-07-20",maxDate:"2024-08-15",markLine:[{date:"2024-07-29",style:{lineWidth:1,lineColor:"blue",lineDash:[8,4]}},{date:"2024-08-17",style:{lineWidth:2,lineColor:"red",lineDash:[8,4]}}],scrollStyle:{scrollRailColor:"RGBA(246,246,246,0.5)",visible:"focus",width:6,scrollSliderCornerRadius:2,scrollSliderColor:"#5cb85c"}};function y(){l.value=new Qe(n.value,k(c)),o.value=new Qe(s.value,k(g)),d.value=new Qe(r.value,k(f))}function k(_){return e.darkMode?(_.taskListTable.theme=wt,_.timelineHeader.backgroundColor="#212121",_.underlayBackgroundColor="#000"):(_.taskListTable.theme=Pe,_.timelineHeader.backgroundColor="#f0f0fb",_.underlayBackgroundColor="#fff"),_}const D=zt(()=>e.darkMode,_=>{var L,S,x;(L=l.value)==null||L.release(),(S=o.value)==null||S.release(),(x=d.value)==null||x.release(),y()});return Wt(()=>{y()}),At(()=>{D()}),(_,L)=>{const S=yt,x=Ft,W=Ht;return Mt(),Pt(W,{vertical:"",size:16},{default:We(()=>[Ae(x,{bordered:!1,title:"VTableGantt",class:"h-full card-wrapper"},{default:We(()=>[Ae(S,{label:"More Demos: ",link:"https://www.visactor.com/vtable/example"})]),_:1}),Ae(x,{bordered:!1,class:"h-full card-wrapper"},{default:We(()=>[Je("div",{ref_key:"basicGanttDomRef",ref:n,class:"relative h-400px"},null,512)]),_:1}),Ae(x,{bordered:!1,class:"h-full card-wrapper"},{default:We(()=>[Je("div",{ref_key:"linkGanttDomRef",ref:s,class:"relative h-400px"},null,512)]),_:1}),Ae(x,{bordered:!1,class:"h-full card-wrapper"},{default:We(()=>[Je("div",{ref_key:"customGanttDomRef",ref:r,class:"relative h-400px"},null,512)]),_:1})]),_:1})}}});export{Qi as default};
