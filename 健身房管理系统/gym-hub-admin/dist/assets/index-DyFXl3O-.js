import{_ as ie,N as de}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BvwCvuJW.js";import{d as I,at as j,m as A,au as H,n as J,q as Q,a as W,r as _,av as ce,c as X,o as V,w as t,f as e,aK as me,z as Y,az as Z,aA as ee,v as ae,ax as le,aN as _e,x as te,B as M,g as z,t as F,h as o,$ as x,aL as ve,L as ne,E as fe,ar as ge,b as be,aC as $,O as G,aD as he}from"./index-BAq2SbaD.js";import{b as ye,c as xe,d as L,e as ke}from"./user-CToCrV-S.js";import{u as we,a as Ue}from"./table-DmjEK7tG.js";import{_ as Ne}from"./Upload-DmXdhDTT.js";import{_ as qe,a as Se,b as De,c as Re}from"./round-refresh-DNCv4Ss6.js";import{_ as Ce}from"./DataTable-D6rjIJFQ.js";import{_ as Te}from"./Image-Bgw24gBA.js";import"./RadioGroup-BGb2VClf.js";import"./Pagination-PYMt0YJG.js";const Be=I({name:"UserOperateModal",__name:"user-operate-modal",props:j({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup(f,{emit:D}){const k="http://localhost:9000/upload";A();const g=f,R=D,d=H(f,"visible"),{formRef:i,validate:U,restoreValidation:C}=J(),{defaultRequiredRule:v,patternRules:N}=Q(),w=W(()=>({add:"新增",edit:"编辑"})[g.operateType]),l=_(s());function s(){return{id:null,password:null,nickName:null,phone:null,age:null,address:null,sex:null,enable:null,avatarUrl:null}}const q={id:v,name:v,phone:[v,N.phone],sex:v,enable:v};function b(){l.value=s(),g.operateType==="edit"&&g.rowData&&(Object.assign(l.value,g.rowData),l.value.avatarUrl&&(y.value=[{id:"1",name:"我是react.png",status:"finished",url:l.value.avatarUrl}]))}function h(){d.value=!1}async function T(){var p;if(await U(),l.value.id){const{error:a,data:n}=await ye(l.value.id,l.value);if(a)return}else{const{error:a,data:n}=await xe(l.value);if(a)return}(p=window.$message)==null||p.success(x("common.updateSuccess")),h(),R("submitted")}ce(d,()=>{d.value?(b(),C()):y.value=[]});const y=_([]);function B(p){var a;console.log("======files======>",p),p&&p.event&&((a=p.event)!=null&&a.target)&&p.event.target.response&&(l.value.avatarUrl=JSON.parse(p.event.target.response).data),l.value.avatarUrl&&(y.value=[{id:"1",name:"我是react.png",status:"finished",url:l.value.avatarUrl}])}const S=_([{label:"男",value:1},{label:"女",value:2}]),O=_([{label:"启用",value:!0},{label:"禁用",value:!1}]);return(p,a)=>{const n=ae,u=ee,c=Ne,P=le,m=_e,oe=Z,se=Y,ue=me,E=M,re=te,pe=ve;return V(),X(pe,{show:d.value,"onUpdate:show":a[8]||(a[8]=r=>d.value=r),title:w.value,preset:"card",class:"w-800px"},{footer:t(()=>[e(re,{justify:"end",size:16},{default:t(()=>[e(E,{onClick:h},{default:t(()=>[z(F(o(x)("common.cancel")),1)]),_:1}),e(E,{type:"primary",onClick:T},{default:t(()=>[z(F(o(x)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(ue,{class:"h-480px pr-20px"},{default:t(()=>[e(se,{ref_key:"formRef",ref:i,model:l.value,rules:q,"label-placement":"left","label-width":100},{default:t(()=>[e(oe,{responsive:"screen","item-responsive":""},{default:t(()=>[e(u,{span:"24 m:24",label:"手机号：",path:"phone"},{default:t(()=>[e(n,{value:l.value.phone,"onUpdate:value":a[0]||(a[0]=r=>l.value.phone=r),placeholder:"请输入手机号"},null,8,["value"])]),_:1}),e(u,{span:"24 m:24",label:"姓名：",path:"name"},{default:t(()=>[e(n,{value:l.value.name,"onUpdate:value":a[1]||(a[1]=r=>l.value.name=r),placeholder:"请输入昵称"},null,8,["value"])]),_:1}),e(u,{span:"24 m:24",label:"头像：",path:"url"},{default:t(()=>[e(c,{action:k,value:l.value.avatarUrl,"onUpdate:value":a[2]||(a[2]=r=>l.value.avatarUrl=r),"default-file-list":y.value,"list-type":"image-card",max:1,onChange:B},null,8,["value","default-file-list"])]),_:1}),e(u,{span:"24 m:24",label:"性别：",path:"sex"},{default:t(()=>[e(P,{value:l.value.sex,"onUpdate:value":a[3]||(a[3]=r=>l.value.sex=r),options:S.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(u,{span:"24 m:24",label:"状态：",path:"enable"},{default:t(()=>[e(P,{value:l.value.enable,"onUpdate:value":a[4]||(a[4]=r=>l.value.enable=r),options:O.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(u,{span:"24 m:24",label:"密码：",path:"password"},{default:t(()=>[e(n,{value:l.value.password,"onUpdate:value":a[5]||(a[5]=r=>l.value.password=r),placeholder:"请输入密码"},null,8,["value"])]),_:1}),e(u,{span:"24 m:24",label:"年龄：",path:"age"},{default:t(()=>[e(m,{value:l.value.age,"onUpdate:value":a[6]||(a[6]=r=>l.value.age=r),placeholder:"请输入年龄"},null,8,["value"])]),_:1}),e(u,{span:"24 m:24",label:"地址：",path:"address"},{default:t(()=>[e(n,{value:l.value.address,"onUpdate:value":a[7]||(a[7]=r=>l.value.address=r),placeholder:"请输入地址"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),Oe=I({name:"UserSearch",__name:"user-search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search"],["update:model"]),setup(f,{emit:D}){A();const k=D,{formRef:g,validate:R,restoreValidation:d}=J(),i=H(f,"model"),U=W(()=>{const{patternRules:l}=Q();return{userEmail:l.email,userPhone:l.phone}});async function C(){await d(),k("reset")}async function v(){await R(),k("search")}const N=_([{label:"男",value:1},{label:"女",value:2}]),w=_([{label:"启用",value:!0},{label:"禁用",value:!1}]);return(l,s)=>{const q=ae,b=ee,h=le,T=De,y=M,B=Re,S=te,O=Z,p=Y,a=Se,n=qe,u=ne;return V(),X(u,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(n,{"default-expanded-names":["user-search"]},{default:t(()=>[e(a,{title:"搜索",name:"user-search"},{default:t(()=>[e(p,{ref_key:"formRef",ref:g,model:i.value,rules:U.value,"label-placement":"left","label-width":80},{default:t(()=>[e(O,{responsive:"screen","item-responsive":""},{default:t(()=>[e(b,{span:"24 s:12 m:6",label:"姓名：",path:"qp_name_like",class:"pr-24px"},{default:t(()=>[e(q,{value:i.value.qp_name_like,"onUpdate:value":s[0]||(s[0]=c=>i.value.qp_name_like=c),placeholder:"请输入"},null,8,["value"])]),_:1}),e(b,{span:"24 s:12 m:6",label:"手机号：",path:"qp_phone_like",class:"pr-24px"},{default:t(()=>[e(q,{value:i.value.qp_phone_like,"onUpdate:value":s[1]||(s[1]=c=>i.value.qp_phone_like=c),placeholder:"请输入"},null,8,["value"])]),_:1}),e(b,{span:"24 s:12 m:6",label:"性别：",path:"qp_sex_eq",class:"pr-24px"},{default:t(()=>[e(h,{value:i.value.qp_sex_eq,"onUpdate:value":s[2]||(s[2]=c=>i.value.qp_sex_eq=c),options:N.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(b,{span:"24 s:12 m:6",label:"状态：",path:"qp_enable_eq",class:"pr-24px"},{default:t(()=>[e(h,{value:i.value.qp_enable_eq,"onUpdate:value":s[3]||(s[3]=c=>i.value.qp_enable_eq=c),options:w.value,placeholder:"请选择"},null,8,["value","options"])]),_:1}),e(b,{span:"24 m:6",class:"pr-24px"},{default:t(()=>[e(S,{class:"w-full",justify:"start"},{default:t(()=>[e(y,{onClick:C},{icon:t(()=>[e(T,{class:"text-icon"})]),default:t(()=>[z(" "+F(o(x)("common.reset")),1)]),_:1}),e(y,{type:"primary",ghost:"",onClick:v},{icon:t(()=>[e(B,{class:"text-icon"})]),default:t(()=>[z(" "+F(o(x)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}}),Pe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function K(f){return typeof f=="function"||Object.prototype.toString.call(f)==="[object Object]"&&!he(f)}const Le=I({name:"user",__name:"index",setup(f){const D=fe(),{bool:k,setTrue:g}=ge();A(),_(null);const{columns:R,columnChecks:d,data:i,loading:U,pagination:C,getData:v,getDataByPage:N,searchParams:w,resetSearchParams:l}=we({apiFn:ke,apiParams:{currentPage:1,pageSize:10,qp_password_like:null,qp_name_like:null,qp_phone_like:null,qp_age_like:null,qp_address_like:null,qp_sex_eq:null,qp_enable_eq:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:"序号",align:"center"},{key:"name",title:"姓名",align:"center"},{key:"phone",title:"手机号",align:"center"},{key:"avatarUrl",title:"头像",align:"center",render:a=>a.avatarUrl===null?null:e(Te,{src:a.avatarUrl,width:"100"},null)},{key:"age",title:"年龄",align:"center"},{key:"address",title:"地址",align:"center"},{key:"sex",title:"性别",align:"center",render:a=>a.sex===null?null:e(G,{type:a.sex===1?"info":"warning"},{default:()=>[a.sex===1?"男":"女"]})},{key:"enable",title:"是否启用",align:"center",render:a=>a.enable===null?null:e(G,{type:a.enable?"success":"error"},{default:()=>[a.enable?"启用":"禁用"]})},{key:"modifyUser",title:"修改人",align:"center"},{key:"modifyTime",title:"修改时间",width:154,align:"center",render:a=>a.modifyTime?a.modifyTime.replace("T"," "):""},{key:"operate",title:x("common.operate"),align:"center",width:230,render:a=>{let n;return e("div",{class:"flex-center justify-center gap-8px"},[e(M,{type:"primary",ghost:!0,size:"small",onClick:()=>O(a)},K(n=x("common.edit"))?n:{default:()=>[n]}),e(de,{onPositiveClick:()=>B(a.id)},{default:()=>x("common.confirmDelete"),trigger:()=>{let u;return e(M,{type:"error",ghost:!0,size:"small"},K(u=x("common.delete"))?u:{default:()=>[u]})}})])}}]}),{checkedRowKeys:s,onBatchDeleted:q,onDeleted:b}=Ue(i,v),h=_("add");function T(){h.value="add",g()}async function y(){const{error:a,data:n}=await L(s.value);console.log(s.value),q()}async function B(a){const{error:n,data:u}=await L(a);console.log(a),b()}const S=_(null);function O(a){h.value="edit",S.value={...a},g()}const p=_([]);return _([{label:"男",value:1},{label:"女",value:2}]),(a,n)=>{const u=ie,c=Ce,P=ne;return V(),be("div",Pe,[e(Oe,{model:o(w),"onUpdate:model":n[0]||(n[0]=m=>$(w)?w.value=m:null),onReset:o(l),onSearch:o(N)},null,8,["model","onReset","onSearch"]),e(P,{title:"数据列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[e(u,{columns:o(d),"onUpdate:columns":n[1]||(n[1]=m=>$(d)?d.value=m:null),"disabled-delete":o(s).length===0,loading:o(U),onAdd:T,onDelete:y,onRefresh:o(v)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:t(()=>[e(c,{"checked-row-keys":o(s),"onUpdate:checkedRowKeys":n[2]||(n[2]=m=>$(s)?s.value=m:null),columns:o(R),data:o(i),size:"small","flex-height":!o(D).isMobile,"scroll-x":1088,loading:o(U),"row-key":m=>m.id,remote:"",pagination:o(C),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Be,{visible:o(k),"onUpdate:visible":n[3]||(n[3]=m=>$(k)?k.value=m:null),"operate-type":h.value,"row-data":S.value,"all-pages":p.value,onSubmitted:o(N)},null,8,["visible","operate-type","row-data","all-pages","onSubmitted"])]),_:1})])}}});export{Le as default};
